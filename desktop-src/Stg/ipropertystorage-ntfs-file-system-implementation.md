---
title: Ипропертистораже — реализация файловой системы NTFS
description: В NTFS версии 5,0 имеется реализация интерфейса Ипропертистораже для файлов на томе NTFS, если файлы не являются составными файлами.
ms.assetid: d0ffd975-5bc2-4de3-b0c1-c9188541f46a
keywords:
- Ипропертистораже Стрктд STG, реализации, файловая система NTFS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca359bebbd05e67a034494023d7fc23089396b32
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105661743"
---
# <a name="ipropertystorage-ntfs-file-system-implementation"></a><span data-ttu-id="d6a62-104">Ипропертистораже — реализация файловой системы NTFS</span><span class="sxs-lookup"><span data-stu-id="d6a62-104">IPropertyStorage-NTFS File System Implementation</span></span>

<span data-ttu-id="d6a62-105">В NTFS версии 5,0 имеется реализация интерфейса [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) для файлов на томе NTFS, если файлы не являются составными файлами.</span><span class="sxs-lookup"><span data-stu-id="d6a62-105">The NTFS version 5.0 provides an implementation of the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface for files on an NTFS volume when the files are not compound files.</span></span>

<span data-ttu-id="d6a62-106">**Получение указателя на реализацию файловой системы NTFS для IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="d6a62-106">**To get a pointer to the NTFS file system implementation of IPropertySetStorage**</span></span>

1.  <span data-ttu-id="d6a62-107">Вызовите метод [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) с помощью реализации [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)в NTFS.</span><span class="sxs-lookup"><span data-stu-id="d6a62-107">Call [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) using the NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage).</span></span>
2.  <span data-ttu-id="d6a62-108">Вызовите [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) с помощью реализации [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)в NTFS.</span><span class="sxs-lookup"><span data-stu-id="d6a62-108">Call [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) using the NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage).</span></span>

## <a name="when-to-use"></a><span data-ttu-id="d6a62-109">Назначение</span><span class="sxs-lookup"><span data-stu-id="d6a62-109">When to Use</span></span>

<span data-ttu-id="d6a62-110">Используйте [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) для управления свойствами в пределах одного набора свойств.</span><span class="sxs-lookup"><span data-stu-id="d6a62-110">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="d6a62-111">Его методы поддерживают чтение, запись и удаление свойств, а также необязательные имена строк, которые могут быть связаны с идентификаторами свойств.</span><span class="sxs-lookup"><span data-stu-id="d6a62-111">Its methods support reading, writing, and deleting properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="d6a62-112">Другой метод позволяет задать время, связанное с хранилищем свойств, а другой разрешает назначение идентификатора CLSID, используемого для связывания другого кода, например кода пользовательского интерфейса, с набором свойств.</span><span class="sxs-lookup"><span data-stu-id="d6a62-112">Another method enables you to set times associated with the property storage, and another permits the assignment of a CLSID, used to associate other code, such as user interface (UI) code, with the property set.</span></span> <span data-ttu-id="d6a62-113">Вызов метода [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) предоставляет указатель на реализацию [**иенумстатпропстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)в NTFS, который позволяет перечислить свойства в наборе.</span><span class="sxs-lookup"><span data-stu-id="d6a62-113">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the NTFS implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which enables you to enumerate the properties in the set.</span></span>

## <a name="remarks"></a><span data-ttu-id="d6a62-114">Комментарии</span><span class="sxs-lookup"><span data-stu-id="d6a62-114">Remarks</span></span>

<span data-ttu-id="d6a62-115">Реализация NTFS предоставляет практически те же возможности, что и реализация составного файла.</span><span class="sxs-lookup"><span data-stu-id="d6a62-115">The NTFS implementation provides essentially the same features as the compound file implementation.</span></span> <span data-ttu-id="d6a62-116">Дополнительные сведения см. в разделе [реализация составного файла ипропертистораже](ipropertystorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="d6a62-116">For more information, see [IPropertyStorage-Compound File Implementation](ipropertystorage-compound-file-implementation.md).</span></span>

<span data-ttu-id="d6a62-117">Поскольку NTFS является надежной файловой системой, набор свойств NTFS никогда не остается в неправильном состоянии.</span><span class="sxs-lookup"><span data-stu-id="d6a62-117">Because NTFS is a robust file system, an NTFS property set will never be left in an incorrect state.</span></span> <span data-ttu-id="d6a62-118">При записи содержимого [**ИПРОПЕРТИСТОРАЖЕ**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) NTFS в базовый файл NTFS либо все, либо ни одно из этих состояний записывается в файл как атомарная операция, даже если во время операции происходит сбой, например аварийное завершение процесса.</span><span class="sxs-lookup"><span data-stu-id="d6a62-118">When the content of an NTFS [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) is flushed to the underlying NTFS file, either all or none of the state is written to the file as an atomic operation, even if there is a failure during the operation such as an abnormal process termination.</span></span> <span data-ttu-id="d6a62-119">Чтобы добиться аналогичного поведения при реализации составного файла, родительский интерфейс [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) должен быть открыт в режиме транзакций.</span><span class="sxs-lookup"><span data-stu-id="d6a62-119">To achieve similar behavior with the compound file implementation, the parent [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface must be opened in transacted mode.</span></span>

<span data-ttu-id="d6a62-120">Этот уровень надежности возможен только при доступе к свойству NTFS, заданному на томе NTFS 5,0.</span><span class="sxs-lookup"><span data-stu-id="d6a62-120">This level of robustness is only possible when accessing an NTFS property set on an NTFS 5.0 volume.</span></span> <span data-ttu-id="d6a62-121">Можно получить доступ к наборам свойств NTFS в более ранних версиях NTFS (например, на компьютере под управлением Windows NT или Windows 2000, который обращается к наборам свойств на компьютере файлового сервера, работающем под управлением Windows NT 4,0), но они не обязательно должны находиться в правильном состоянии в случае непредвиденного сбоя.</span><span class="sxs-lookup"><span data-stu-id="d6a62-121">It is possible to access NTFS property sets on earlier versions of NTFS (for example, a computer running on Windows NT or Windows 2000 that accesses the property sets on a file server computer running on Windows NT 4.0), but they are not guaranteed to be in a correct state in the event of an unexpected failure.</span></span>

<span data-ttu-id="d6a62-122">Несмотря на то, что реализация [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) в NTFS не поддерживает транзакционную поддержку, реализация [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) в NTFS поддерживается.</span><span class="sxs-lookup"><span data-stu-id="d6a62-122">Although the NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) does not support transactioning, the NTFS implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports it.</span></span> <span data-ttu-id="d6a62-123">То есть **\_ транзакционная стгм** может быть указана в параметре *Грфмоде* в методах [**CREATE**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) и [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) **IPropertySetStorage**.</span><span class="sxs-lookup"><span data-stu-id="d6a62-123">That is, **STGM\_TRANSACTED** may be specified in the *grfMode* parameter to the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) and [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) methods of **IPropertySetStorage**.</span></span> <span data-ttu-id="d6a62-124">Как и в реализации составного файла, режим транзакций может быть только для непростых хранилищ свойств (в параметре *грффлагс* указано **пропсетфлаг \_ unsimple** ).</span><span class="sxs-lookup"><span data-stu-id="d6a62-124">As in the compound file implementation, transacted mode is possible only for nonsimple property storages (specifying **PROPSETFLAG\_NONSIMPLE** in the *grfFlags* parameter).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d6a62-125">См. также</span><span class="sxs-lookup"><span data-stu-id="d6a62-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d6a62-126">**ипропертистораже**</span><span class="sxs-lookup"><span data-stu-id="d6a62-126">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="d6a62-127">IPropertySetStorage — реализация файловой системы NTFS</span><span class="sxs-lookup"><span data-stu-id="d6a62-127">IPropertySetStorage-NTFS File System Implementation</span></span>](ipropertysetstorage-ntfs-file-system-implementation.md)
</dt> </dl>

 

 