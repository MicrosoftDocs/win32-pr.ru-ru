---
title: Ограничения графической оболочки сервера
description: Серверные приложения должны быть способны работать без графической оболочки сервера.
ms.assetid: 8F531497-B64D-4E79-AD7A-790EFDC6ADFE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7666ae07a28d798a36d249bf37ab2d7719b9fba0
ms.sourcegitcommit: 46376be61d3fa308f9b1a06d7e2fa122a39755af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2020
ms.locfileid: "104414017"
---
# <a name="server-apps-must-be-able-to-run-without-the-server-graphical-shell"></a><span data-ttu-id="4cb93-103">Серверные приложения должны быть способны работать без графической оболочки сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-103">Server apps must be able to run without the Server Graphical Shell</span></span>

## <a name="platform"></a><span data-ttu-id="4cb93-104">Платформа</span><span class="sxs-lookup"><span data-stu-id="4cb93-104">Platform</span></span>

<span data-ttu-id="4cb93-105">**Серверы** — Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="4cb93-105">**Servers** – Windows Server 2012</span></span> 

## <a name="description"></a><span data-ttu-id="4cb93-106">Описание</span><span class="sxs-lookup"><span data-stu-id="4cb93-106">Description</span></span>

<span data-ttu-id="4cb93-107">Серверная графическая оболочка, компонент, включающий проводник Windows и Internet Explorer, устанавливается по умолчанию на сервере Windows Server 2012 с установленным графическим интерфейсом.</span><span class="sxs-lookup"><span data-stu-id="4cb93-107">Server Graphical Shell, the feature that includes Windows Explorer and Internet Explorer, is installed by default on “Server with a GUI” installations of Windows Server 2012.</span></span> <span data-ttu-id="4cb93-108">Компонент графической оболочки сервера можно удалить, чтобы снизить потенциальную нагрузку на обслуживание и производительность, ограничивая число перезагрузок, которые может повлечь сервер, и тем самым разрешив запуск средств управления на локальном сервере.</span><span class="sxs-lookup"><span data-stu-id="4cb93-108">The Server Graphical Shell feature can be uninstalled in order to reduce the potential servicing and performance footprint, thereby limiting the number of reboots that the server may incur, while still allowing management tools to be run locally on the server.</span></span>

<span data-ttu-id="4cb93-109">После того как администратор отменяет установку графической оболочки сервера, сервер находится в конфигурации минимального интерфейса сервера:</span><span class="sxs-lookup"><span data-stu-id="4cb93-109">After an administrator uninstalls the Server Graphical Shell, the server is in the Minimal Server Interface configuration:</span></span>

![Конфигурация интерфейса графической оболочки сервера](images/minimalserverinterface.png)

<span data-ttu-id="4cb93-111">Администраторы могут выбрать запуск в минимальной конфигурации интерфейса сервера (которая включает набор локальных средств управления) по умолчанию, а не на сервере с конфигурацией графического интерфейса пользователя.</span><span class="sxs-lookup"><span data-stu-id="4cb93-111">Administrators can then opt to run in the Minimal Server Interface configuration (which includes a set of local management tools), as the default, rather than in the Server with a GUI configuration.</span></span> <span data-ttu-id="4cb93-112">Это позволяет осуществлять локальный мониторинг и управление, одновременно уменьшая использование ресурсов и частоту обслуживания.</span><span class="sxs-lookup"><span data-stu-id="4cb93-112">This allows local monitoring and management, while reducing both resource usage and frequency of servicing.</span></span>

<span data-ttu-id="4cb93-113">После этого администраторы могут переустановить графическую оболочку сервера, если они нуждаются в функциональных возможностях.</span><span class="sxs-lookup"><span data-stu-id="4cb93-113">Administrators can reinstall Server Graphical Shell later if they need the functionality within it.</span></span> <span data-ttu-id="4cb93-114">(Администраторы также могут начать с установки Server Core и "создать" до конфигурации с минимальным интерфейсом сервера, используя функции функций по запросу.)</span><span class="sxs-lookup"><span data-stu-id="4cb93-114">(Administrators can also start from a Server Core install, and “build up” to the Minimal Server Interface configuration using the Features On Demand functionality.)</span></span>

<span data-ttu-id="4cb93-115">Серверные приложения должны быть способны работать в минимальной конфигурации серверного интерфейса, чтобы воспользоваться преимуществами сокращенного использования ресурсов и обслуживания.</span><span class="sxs-lookup"><span data-stu-id="4cb93-115">Server apps must be capable of running in the Minimal Server Interface configuration to take advantage of the reduced resource utilization and servicing footprint.</span></span> <span data-ttu-id="4cb93-116">Эта возможность может быть достигнута путем предоставления администратору возможности не устанавливать части приложения, которым требуется графическая оболочка сервера, или путем обнаружения наличия графической оболочки сервера и отключения некоторых аспектов приложения.</span><span class="sxs-lookup"><span data-stu-id="4cb93-116">This capability can be achieved by allowing the administrator to choose not to install parts of the app that needs the Server Graphical Shell, or by detecting the presence of Server Graphical Shell and disabling some aspects of the app.</span></span>

<span data-ttu-id="4cb93-117">Минимальный интерфейс сервера имеет уменьшенный объем ресурсов и обслуживания, поскольку многие API-интерфейсы и двоичные файлы, которые включены в графическую оболочку сервера, недоступны в этой конфигурации.</span><span class="sxs-lookup"><span data-stu-id="4cb93-117">The Minimal Server Interface has a reduced resource and servicing footprint because many APIs and binaries that are included in the Server Graphical Shell are not available in this configuration.</span></span> <span data-ttu-id="4cb93-118">Там, где это уместно, серверные приложения также должны разрешать удаленное администрирование (предпочтительно с помощью удаленного взаимодействия Windows PowerShell) из другой установки Windows Server или клиента Windows.</span><span class="sxs-lookup"><span data-stu-id="4cb93-118">Where appropriate, server apps should also allow remote administration (preferably via Windows PowerShell Remoting) from another Windows Server or Windows Client installation.</span></span> <span data-ttu-id="4cb93-119">Это позволяет лучше централизованно администрировать один или несколько компьютеров в минимальной конфигурации серверного интерфейса или на компьютерах в более низких конфигурациях, таких как Server Core.</span><span class="sxs-lookup"><span data-stu-id="4cb93-119">This enables better centralized administration of one or more machines in the Minimal Server Interface configuration, or of machines in an even lower footprint configuration such as Server Core.</span></span>

## <a name="manifestation"></a><span data-ttu-id="4cb93-120">Проявление</span><span class="sxs-lookup"><span data-stu-id="4cb93-120">Manifestation</span></span>

<span data-ttu-id="4cb93-121">Если приложению требуется какой-либо из API или двоичных файлов, недоступных в минимальной конфигурации серверного интерфейса, он может неправильно отображаться на экране и/или быть непригодным для использования.</span><span class="sxs-lookup"><span data-stu-id="4cb93-121">If an app requires any of the APIs or binaries that are not available in the Minimal Server Interface configuration, it may not display properly on the screen and/or be unusable.</span></span>

## <a name="mitigation"></a><span data-ttu-id="4cb93-122">Меры по снижению риска</span><span class="sxs-lookup"><span data-stu-id="4cb93-122">Mitigation</span></span>

<span data-ttu-id="4cb93-123">Разработчики серверных приложений должны определить те части приложений, которым требуется любой из удаленных API или двоичных файлов, и включить сведения для администратора сервера, определяющие части приложения, которые не будут правильно работать при использовании минимального интерфейса сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-123">Server app developers should identify those parts of their apps that require any of the removed APIs or binaries and include info for the server administrator identifying the parts of the app that won’t run properly when using the Minimal Server Interface.</span></span> <span data-ttu-id="4cb93-124">Если эти части приложения могут быть установлены по желанию или не являются обязательными для функциональности продукта, приложение можно установить и запустить в минимальной конфигурации интерфейса сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-124">If those parts of the app can be optionally installed or are not absolutely required for product functionality, the app can still be installed and run under the Minimal Server Interface configuration.</span></span>

<span data-ttu-id="4cb93-125">Если приложение не может использоваться вообще без серверной графической оболочки, это ограничение следует задокументировать, и администратор сервера должен дать указание установить графическую оболочку сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-125">If the app cannot be used at all without the Server Graphical Shell, this limitation should be documented and the server administrator should be instructed to install the Server Graphical Shell.</span></span> <span data-ttu-id="4cb93-126">(При добавлении в установку Server Core это может потребовать добавления функций с помощью функций по запросу.) Кроме того, приложение должно проверять загрузку, чтобы все необходимые файлы были доступны, так как графическая оболочка сервера может быть удалена в любое время до или после установки приложения.</span><span class="sxs-lookup"><span data-stu-id="4cb93-126">(If adding to a Server Core installation, this might require adding features using Features On Demand.) In addition, the app should check on startup that all required files are available, as the Server Graphical Shell can be uninstalled at any time before or after the installation of the app.</span></span>

## <a name="solution"></a><span data-ttu-id="4cb93-127">Решение</span><span class="sxs-lookup"><span data-stu-id="4cb93-127">Solution</span></span>

<span data-ttu-id="4cb93-128">Зависят от наименьшего возможного набора зависимостей и разделения приложений, чтобы основные функции приложения могли работать без необходимости установки более высокой плотности компонентов пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4cb93-128">Rely on the smallest possible set of dependencies, and modularize apps so that the core app functionality can work without requiring more heavyweight user interface components installed.</span></span> <span data-ttu-id="4cb93-129">Разрабатывайте приложения, не требующие удаленных API или двоичных файлов, и используйте функции, содержащиеся в минимальном интерфейсе сервера или Server Core.</span><span class="sxs-lookup"><span data-stu-id="4cb93-129">Develop apps that do not require any of the removed APIs or binaries, and rely instead on the functionality contained within the Minimal Server Interface or Server Core.</span></span> <span data-ttu-id="4cb93-130">Это снизит требования к обслуживанию, повышая производительность и степень удовлетворенности пользователей.</span><span class="sxs-lookup"><span data-stu-id="4cb93-130">This will reduce maintenance requirements while improving performance and user satisfaction.</span></span>

<span data-ttu-id="4cb93-131">При наличии частей приложения, которые могут добавить значительные функции, если доступна графическая оболочка сервера, разработчики приложений могут:</span><span class="sxs-lookup"><span data-stu-id="4cb93-131">Where there are parts of an app that might add significant functionality when the Server Graphical Shell is available, app developers can:</span></span>

-   <span data-ttu-id="4cb93-132">Разрешить этим дополнительным компонентам использовать серверную графическую оболочку для установки при необходимости, чтобы их можно было опустить при установке в минимальной конфигурации интерфейса сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-132">Allow these additional features making use of Server Graphical Shell to be optionally installed, so they can be omitted from installations on a Minimal Server Interface configuration</span></span>
-   <span data-ttu-id="4cb93-133">Определение наличия графической оболочки сервера и адаптация поведения приложения</span><span class="sxs-lookup"><span data-stu-id="4cb93-133">Detect the presence of Server Graphical Shell and adapt the app behavior</span></span>

<span data-ttu-id="4cb93-134">Разработчики приложений также должны обеспечивать удаленное управление серверными приложениями, если это возможно и уместно.</span><span class="sxs-lookup"><span data-stu-id="4cb93-134">App developers should also ensure that server apps are remotely manageable where possible and appropriate.</span></span>

## <a name="detecting-minimal-server-interface-and-server-core"></a><span data-ttu-id="4cb93-135">Обнаружение минимального интерфейса сервера и Server Core</span><span class="sxs-lookup"><span data-stu-id="4cb93-135">Detecting Minimal Server Interface and Server Core</span></span>

<span data-ttu-id="4cb93-136">Windows Server установит соответствующее значение реестра для каждого установленного уровня сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-136">Windows Server will install a corresponding registry value for each server level installed.</span></span> <span data-ttu-id="4cb93-137">Вы можете запросить существование этих ключей, чтобы определить, установлены и включены Серверная графическая оболочка или функции серверного интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4cb93-137">You can query for the existence of these keys to determine if the Server Graphical Shell or Minimal Server Interface features are installed and enabled.</span></span>

<span data-ttu-id="4cb93-138">HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows NT \\ CurrentVersion \\ Server \\ серверлевелс:</span><span class="sxs-lookup"><span data-stu-id="4cb93-138">HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Server\\ServerLevels:</span></span>



|                  | <span data-ttu-id="4cb93-139">Основные серверные компоненты</span><span class="sxs-lookup"><span data-stu-id="4cb93-139">Server Core</span></span> | <span data-ttu-id="4cb93-140">Минимальный интерфейс сервера</span><span class="sxs-lookup"><span data-stu-id="4cb93-140">Minimal Server Interface</span></span> | <span data-ttu-id="4cb93-141">Графическая оболочка сервера</span><span class="sxs-lookup"><span data-stu-id="4cb93-141">Server Graphical Shell</span></span> |
|------------------|-------------|--------------------------|------------------------|
| <span data-ttu-id="4cb93-142">ServerCore = 1</span><span class="sxs-lookup"><span data-stu-id="4cb93-142">ServerCore=1</span></span>     | <span data-ttu-id="4cb93-143">X</span><span class="sxs-lookup"><span data-stu-id="4cb93-143">X</span></span>           | <span data-ttu-id="4cb93-144">X</span><span class="sxs-lookup"><span data-stu-id="4cb93-144">X</span></span>                        | <span data-ttu-id="4cb93-145">X</span><span class="sxs-lookup"><span data-stu-id="4cb93-145">X</span></span>                      |
| <span data-ttu-id="4cb93-146">Server-Гуимгмт = 1</span><span class="sxs-lookup"><span data-stu-id="4cb93-146">Server-GuiMgmt=1</span></span> |             | <span data-ttu-id="4cb93-147">X</span><span class="sxs-lookup"><span data-stu-id="4cb93-147">X</span></span>                        | <span data-ttu-id="4cb93-148">X</span><span class="sxs-lookup"><span data-stu-id="4cb93-148">X</span></span>                      |
| <span data-ttu-id="4cb93-149">Сервергуишелл = 1</span><span class="sxs-lookup"><span data-stu-id="4cb93-149">ServerGuiShell=1</span></span> |             |                          | <span data-ttu-id="4cb93-150">X</span><span class="sxs-lookup"><span data-stu-id="4cb93-150">X</span></span>                      |



 

<span data-ttu-id="4cb93-151">"X" в приведенной выше таблице означает, что при установке соответствующего компонента будет указан раздел реестра.</span><span class="sxs-lookup"><span data-stu-id="4cb93-151">An “X” in the table above means that registry key will be present when the corresponding feature is installed.</span></span>

<span data-ttu-id="4cb93-152">Обратите внимание, что эти уровни сервера являются аддитивными; Если установлена графическая оболочка сервера, то это минимальный серверный интерфейс и ядро сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-152">Note that these server levels are additive; if the Server Graphical Shell is installed, so is the Minimal Server Interface and Server Core.</span></span> <span data-ttu-id="4cb93-153">В этом случае будут присутствовать оба раздела реестра.</span><span class="sxs-lookup"><span data-stu-id="4cb93-153">In that case, both registry keys will be present.</span></span>

## <a name="tests"></a><span data-ttu-id="4cb93-154">Тесты</span><span class="sxs-lookup"><span data-stu-id="4cb93-154">Tests</span></span>

<span data-ttu-id="4cb93-155">Проверьте код приложения на наличие требований, использующих любой из удаленных API и двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="4cb93-155">Inspect your app code for requirements that use any of the removed APIs and binaries.</span></span> <span data-ttu-id="4cb93-156">После удаления всех экземпляров из двоичных файлов "основное приложение" протестируйте приложение в среде, которая не включает в себя графическую оболочку сервера.</span><span class="sxs-lookup"><span data-stu-id="4cb93-156">After you have removed any instances of these from “core application” binaries, test your app in an environment that does not include the Server Graphical Shell.</span></span> <span data-ttu-id="4cb93-157">Такие средства, как монитор процессов, могут помочь в этом.</span><span class="sxs-lookup"><span data-stu-id="4cb93-157">Tools such as the Process Monitor might help with this.</span></span>

<span data-ttu-id="4cb93-158">Если вы не можете полностью прекратить использование этих API и двоичных файлов, убедитесь, что приложение аварийно завершает работу при запуске на минимальном интерфейсе сервера или Server Core.</span><span class="sxs-lookup"><span data-stu-id="4cb93-158">If you cannot completely discontinue use of these APIs and binaries, ensure that your app fails gracefully when run on Minimal Server Interface or Server Core.</span></span>

## <a name="resources"></a><span data-ttu-id="4cb93-159">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="4cb93-159">Resources</span></span>

-   <span data-ttu-id="4cb93-160">[Существующие документы Server Core на MSDN](/previous-versions/windows/desktop/legacy/ms723891(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="4cb93-160">[Existing Server Core docs on MSDN](/previous-versions/windows/desktop/legacy/ms723891(v=vs.85))</span></span>

 

 