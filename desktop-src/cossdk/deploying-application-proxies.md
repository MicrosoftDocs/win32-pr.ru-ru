---
description: Для удаленного доступа к серверному приложению COM+ с другого (клиентского) компьютера клиентский компьютер должен иметь подмножество атрибутов установленного серверного приложения, включая библиотеки DLL прокси-сервера и заглушки, а также библиотеки типов для удаленного взаимодействия с интерфейсом DCOM/QC.
ms.assetid: 293b424c-4cd4-43a9-9b56-687c753a34f2
title: Развертывание прокси приложения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0f5e6439574602005ca53917945fa9005f8959b5
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103990814"
---
# <a name="deploying-application-proxies"></a><span data-ttu-id="0ccc0-103">Развертывание прокси приложения</span><span class="sxs-lookup"><span data-stu-id="0ccc0-103">Deploying Application Proxies</span></span>

<span data-ttu-id="0ccc0-104">Для удаленного доступа к серверному приложению COM+ с другого (клиентского) компьютера клиентский компьютер должен иметь подмножество атрибутов установленного серверного приложения, включая библиотеки DLL прокси-сервера и заглушки, а также библиотеки типов для удаленного взаимодействия с интерфейсом DCOM/QC.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-104">To access a COM+ server application remotely from another (client) computer, the client computer must have a subset of the attributes of the server application installed, including proxy/stub DLLs and type libraries for DCOM/QC interface remoting.</span></span> <span data-ttu-id="0ccc0-105">Это подмножество называется *прокси приложения*.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-105">This subset is called an *application proxy*.</span></span>

<span data-ttu-id="0ccc0-106">С помощью средства администрирования служб компонентов можно легко экспортировать серверное приложение COM+ в качестве прокси приложения.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-106">Through the Component Services administrative tool, you can easily export a COM+ server application as an application proxy.</span></span> <span data-ttu-id="0ccc0-107">Чтобы приложение COM+ создавало прокси приложения, важно, чтобы все компоненты серверного приложения были установлены и не были импортированы.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-107">For COM+ to generate an application proxy, it is important that all components in the server application were installed and not imported.</span></span> <span data-ttu-id="0ccc0-108">(Дополнительные сведения об этом различии см. в разделе [Импорт компонентов](importing-components.md).) Это гарантирует, что приложение будет включать все необходимые сведения о регистрации.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-108">(For more information on this distinction, see [Importing Components](importing-components.md).) This ensures that the application includes all the necessary registration information.</span></span>

> [!Note]  
> <span data-ttu-id="0ccc0-109">Рекомендуется отделить определения интерфейса от реализаций класса.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-109">It is recommended that you separate the interface definitions from the class implementations.</span></span> <span data-ttu-id="0ccc0-110">В противном случае набор библиотек DLL или библиотек типов, включенных в прокси приложения COM+, будет включать в себя фактический серверный код.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-110">Otherwise, the set of DLLs or type libraries included in the COM+ application proxy will include actual server code.</span></span>

 

<span data-ttu-id="0ccc0-111">Прокси-серверы приложений, созданные COM+, являются установщик Windows установочными пакетами.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-111">Application proxies generated by COM+ are Windows Installer installation packages.</span></span> <span data-ttu-id="0ccc0-112">После установки прокси-серверы приложений отображаются на панели управления "Установка и удаление программ" на клиентском компьютере (Если MSI-файл не изменяется с помощью средства установщик Windows Authoring Tool).</span><span class="sxs-lookup"><span data-stu-id="0ccc0-112">After installation, the application proxies appear in the client computer's Add/Remove Programs control panel (unless the .msi file is modified using a Windows Installer authoring tool).</span></span>

## <a name="remote-access-via-application-proxies"></a><span data-ttu-id="0ccc0-113">Удаленный доступ через прокси приложения</span><span class="sxs-lookup"><span data-stu-id="0ccc0-113">Remote Access via Application Proxies</span></span>

<span data-ttu-id="0ccc0-114">При создании прокси приложения COM+ автоматически предоставляет следующие сведения, необходимые для удаленного доступа к серверному приложению COM+ с помощью прокси приложения:</span><span class="sxs-lookup"><span data-stu-id="0ccc0-114">When generating an application proxy, COM+ automatically provides the following information, required for the application proxy to remotely access a COM+ server application:</span></span>

-   <span data-ttu-id="0ccc0-115">Сведения об удостоверении класса (CLSIDs и ProgID).</span><span class="sxs-lookup"><span data-stu-id="0ccc0-115">Class identity information (CLSIDs and ProgIDs).</span></span> <span data-ttu-id="0ccc0-116">Прокси приложения поддерживает до двух идентификаторов ProgID.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-116">An application proxy supports up to two ProgIDs.</span></span>
-   <span data-ttu-id="0ccc0-117">Удостоверение приложения и связь классов с приложениями (AppID).</span><span class="sxs-lookup"><span data-stu-id="0ccc0-117">Application identity and relation of classes to applications (AppID).</span></span>
-   <span data-ttu-id="0ccc0-118">Сведения о расположении для каждого приложения (имя удаленного сервера).</span><span class="sxs-lookup"><span data-stu-id="0ccc0-118">Location information per application (Remote Server Name).</span></span>
-   <span data-ttu-id="0ccc0-119">Сведения о передаче для всех интерфейсов, предоставляемых приложением (например, библиотеки типов, прокси-серверы и заглушки).</span><span class="sxs-lookup"><span data-stu-id="0ccc0-119">Marshaling information for all the interfaces exposed by the application (for example, type libraries and proxy/stubs).</span></span>
-   <span data-ttu-id="0ccc0-120">Имена и идентификаторы очередей MSMQ (если для приложения включена служба "очереди компонентов").</span><span class="sxs-lookup"><span data-stu-id="0ccc0-120">MSMQ queue names and identifiers (if the queued components service is enabled for the application).</span></span>
-   <span data-ttu-id="0ccc0-121">Атрибуты класса, интерфейса и метода, за исключением сведений о ролях.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-121">Class, interface, and method attributes, excluding role information.</span></span>
-   <span data-ttu-id="0ccc0-122">Атрибуты приложения.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-122">Application attributes.</span></span>

## <a name="installing-application-proxies-on-other-operating-systems"></a><span data-ttu-id="0ccc0-123">Установка прокси приложения в других операционных системах</span><span class="sxs-lookup"><span data-stu-id="0ccc0-123">Installing Application Proxies on Other Operating Systems</span></span>

<span data-ttu-id="0ccc0-124">В отличие от серверных приложений COM+, прокси приложения можно установить в любой операционной системе, поддерживающей DCOM (и установщик Windows).</span><span class="sxs-lookup"><span data-stu-id="0ccc0-124">Unlike COM+ server applications, application proxies can be installed on any operating system that supports DCOM (and Windows Installer).</span></span> <span data-ttu-id="0ccc0-125">На компьютерах, на которых не используется COM+, устанавливается только подмножество сведений, необходимых для удаленного взаимодействия DCOM.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-125">On computers that aren't running COM+, only the subset of information required for DCOM remoting is installed.</span></span> <span data-ttu-id="0ccc0-126">Эти сведения устанавливаются в реестр Windows (с помощью \_ ключей классов hKey \_ root, AppID/CLSID).</span><span class="sxs-lookup"><span data-stu-id="0ccc0-126">This information is installed into the Windows registry (using the HKEY\_CLASSES\_ROOT, APPID/CLSID keys).</span></span>

> [!Note]  
> <span data-ttu-id="0ccc0-127">При установке прокси приложения (MSI-файла) на компьютерах, на которых не выполняется COM+, на этих компьютерах необходимо запускать установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-127">When installing an application proxy (.msi file) on computers that aren't running COM+, it is necessary to have Windows Installer running on those computers.</span></span> <span data-ttu-id="0ccc0-128">Рекомендуется, чтобы разработчики поставляют установщик Windows распространяемый файл (instmsi.exe) вместе с MSI-файлом приложения.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-128">It is recommended that developers ship the Windows Installer redistributable file (instmsi.exe) along with their application's .msi file.</span></span> <span data-ttu-id="0ccc0-129">Это обеспечит установщик Windows доступности системных администраторов при развертывании прокси приложения на клиентах, на которых не выполняется COM+.</span><span class="sxs-lookup"><span data-stu-id="0ccc0-129">This will ensure that system administrators have Windows Installer available when deploying application proxies on clients that are not running COM+.</span></span>

 

<span data-ttu-id="0ccc0-130">На компьютерах с COM+ сведения о прокси приложения устанавливаются в каталог COM+ и отображаются в средстве администрирования "службы компонентов".</span><span class="sxs-lookup"><span data-stu-id="0ccc0-130">On computers running COM+, the application proxy information is installed into the COM+ catalog and is visible in the Component Services administrative tool.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0ccc0-131">См. также</span><span class="sxs-lookup"><span data-stu-id="0ccc0-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0ccc0-132">Создание пакетов установки для приложений COM+</span><span class="sxs-lookup"><span data-stu-id="0ccc0-132">Creating Installation Packages for COM+ Applications</span></span>](creating-installation-packages-for-com--applications.md)
</dt> <dt>

[<span data-ttu-id="0ccc0-133">Каталог COM+</span><span class="sxs-lookup"><span data-stu-id="0ccc0-133">The COM+ Catalog</span></span>](the-com--catalog.md)
</dt> <dt>

[<span data-ttu-id="0ccc0-134">Служебная программа репликации COMREPL</span><span class="sxs-lookup"><span data-stu-id="0ccc0-134">The COMREPL Replication Utility</span></span>](the-comrepl-replication-utility.md)
</dt> </dl>

 

 



