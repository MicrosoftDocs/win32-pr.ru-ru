---
description: Процесс выделения ресурсов распределителя ресурсов
ms.assetid: 695d08f4-ba5c-4a5f-a2ad-481a8ede49ab
title: Процесс выделения ресурсов распределителя ресурсов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a34e91802b001bdb8a1af3a933d458c4e9b86b6e3bcd2eb40646e9b64a2e2e14
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119953824"
---
# <a name="resource-dispenser-resource-allocation-process"></a>Процесс выделения ресурсов распределителя ресурсов

Каждый раз, когда распределитель ресурсов выделяет ресурс из своего держателя, происходит следующее.

1.  Распределитель ресурсов объявляет идентификатор типа ресурса (**рестипид**), описывающий требуемый тип ресурса.

2.  Распределитель ресурсов вызывает метод [**ихолдер:: аллокресаурце**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-allocresource) владельца, передав этот **рестипид**.

3.  Держатель создает список кандидатов на основе доступных ресурсов. Кандидаты — это ресурсы, которые не прикрепляются к транзакции или уже прикрепляются к транзакции вызывающего объекта.

4.  Эти кандидаты по отдельности передаются методу [**идиспенсердривер:: ратересаурце**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-rateresource) , где они оцениваются (по шкале от 0 до 100), насколько хорошо ресурс-кандидат соответствует требуемому **рестипид**.

5.  Держатель выбирает ресурс, который распределитель ресурсов оценивает как максимальный.

6.  Распределитель ресурсов может завершить цикл оценки раньше, назначив ему рейтинг ресурсов 100 (идеально подходит). Оценка 100 обычно будет зарезервирована для ресурсов-кандидатов, которые уже должны быть прикреплены, если распределитель ресурсов не завершает это недорогое действие. Если все потенциальные ресурсы (если таковые имеются) имеют оценку 0 (непригодный для использования), то новый ресурс создается путем вызова [**идиспенсердривер:: креатересаурце**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-createresource).

7.  Если выбранный ранее ресурс еще не прикреплен к транзакции вызывающего объекта, вызывается метод распределителя ресурсов [**идиспенсердривер:: енлистресаурце**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) .

8.  Вызов метода [**аллокресаурце**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-allocresource) возвращается в распределитель ресурсов с прикрепленным ресурсом.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Основные понятия распределителя ресурсов COM+](com--resource-dispenser-concepts.md)
</dt> <dt>

[Прикрепление ресурса в транзакции](enlisting-a-resource-in-a-transaction.md)
</dt> <dt>

[Отслеживание нераспределенных ресурсов](tracking-non-allocated-resources.md)
</dt> </dl>

 

 



