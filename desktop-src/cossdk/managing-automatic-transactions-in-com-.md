---
description: В модели программирования COM+ можно разрабатывать компоненты так, чтобы сделать их лучше&\# 8212, включать бизнес-логику или устанавливать подключение к базе данных&\# 8212; и использовать платформу обработки транзакций Microsoft Windows для автоматизации транзакций.
ms.assetid: 50086e6e-024b-4a09-b8be-8f55b6bfadb2
title: Управление автоматическими транзакциями в COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 371730173acd4943f460afbf2feab7ada83078fa
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539194"
---
# <a name="managing-automatic-transactions-in-com"></a>Управление автоматическими транзакциями в COM+

В модели программирования COM+ можно разрабатывать компоненты, чтобы сделать их лучше, обеспечивая бизнес-логику или установление подключения к базе данных, и использовать платформу обработки транзакций Microsoft Windows для автоматизации транзакций.

## <a name="starting-a-transaction"></a>Запуск транзакции

COM+ автоматически начинает транзакцию при возникновении одного из следующих условий:

-   Когда нетранзакционный клиент вызывает компонент, для которого требуется транзакция или требуется новая транзакция.
-   Когда клиент транзакций вызывает компонент, для которого требуется новая транзакция.

Если COM+ определяет, что объект должен иметь новую транзакцию, он сначала начинает транзакцию, а затем помещает в него объект. Этот процесс состоит из следующих шагов.

1.  COM+ создает объект контекста, устанавливает необходимые атрибуты [JIT-активации](com--just-in-time-activation.md) и [синхронизации](com--synchronization.md) и устанавливает для [флагов consistent и Done](consistent-and-done-flags.md) значение true и false соответственно.
2.  COM+ взаимодействует с координатор распределенных транзакций (DTC) для начала транзакции. DTC координирует физическую транзакцию.
3.  DTC создает идентификатор транзакции и передает его обратно в COM+. Идентификатор транзакции устанавливает границу транзакции. Все объекты, участвующие в транзакции, имеют один и тот же идентификатор.
4.  Когда клиент создает объект, COM+ активирует его в пределах границы транзакции.

## <a name="ending-a-transaction"></a>Завершение транзакции

COM+ завершает автоматическую транзакцию путем ее фиксации или прерывания при выполнении одного из следующих условий:

-   Корневой объект транзакции завершает свою работу, и COM+ освобождает ее. После деактивации корневого объекта транзакция пытается зафиксироваться.
-   Клиент освобождает корневой объект. Без ссылки корневой объект деактивируется, и транзакция пытается зафиксироваться.
-   Транзакция превышает пороговое значение времени ожидания. Транзакция автоматически прерывается, если не фиксируется в течение времени ожидания транзакции, деактивируются все объекты, связанные с транзакцией. По умолчанию время ожидания транзакции составляет 60 секунд.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Флаги consistent и Done](consistent-and-done-flags.md)
</dt> <dt>

[Ускорение транзакций путем уведомления корневого объекта](speeding-transactions-by-notifying-the-root-object.md)
</dt> <dt>

[Завершение автоматической транзакции путем вызова Сеткомплете](terminating-an-automatic-transaction-by-calling-setcomplete.md)
</dt> </dl>

 

 



