---
description: Правильное использование политики ограниченного использования программ может сделать ваш бизнес более гибким, так как он предоставляет профилактическую инфраструктуру для предотвращения проблем, а не реактивность платформы, которая полагается на дорогостоящий вариант восстановления системы после возникновения проблемы. Политика ограниченного использования программ была реализована в выпуске Microsoft Windows XP для защиты систем от неизвестного и потенциально опасного кода. Политика ограничений предоставляет механизм, в котором только доверенный код получает неограниченный доступ к привилегиям пользователей. Неизвестный код, который может содержать вирусы или код, конфликтующий с установленными программами, может выполняться только в ограниченной среде (часто называемой песочницей), где ей запрещено обращаться к любым привилегиям пользователей, учитывающим безопасность.
ms.assetid: 233483a0-ff16-4e21-a312-cc57a92124c3
title: Использование политики ограниченного использования программ в COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3620aba8cce2859d76ba07c2fa9655dd9036bdbb
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104496308"
---
# <a name="using-the-software-restriction-policy-in-com"></a><span data-ttu-id="644aa-106">Использование политики ограниченного использования программ в COM+</span><span class="sxs-lookup"><span data-stu-id="644aa-106">Using the Software Restriction Policy in COM+</span></span>

<span data-ttu-id="644aa-107">Правильное использование политики ограниченного использования программ может сделать ваш бизнес более гибким, так как он предоставляет профилактическую инфраструктуру для предотвращения проблем, а не реактивность платформы, которая полагается на дорогостоящий вариант восстановления системы после возникновения проблемы.</span><span class="sxs-lookup"><span data-stu-id="644aa-107">Properly using the software restriction policy can make your business more agile because it provides a proactive framework for preventing problems, rather than a reactive framework that relies on the costly alternative of restoring a system after a problem has occurred.</span></span> <span data-ttu-id="644aa-108">Политика ограниченного использования программ была реализована в выпуске Microsoft Windows XP для защиты систем от неизвестного и потенциально опасного кода.</span><span class="sxs-lookup"><span data-stu-id="644aa-108">The software restriction policy was introduced with the release of Microsoft Windows XP to help protect systems from unknown and possibly dangerous code.</span></span> <span data-ttu-id="644aa-109">Политика ограничений предоставляет механизм, в котором только доверенный код получает неограниченный доступ к привилегиям пользователя.</span><span class="sxs-lookup"><span data-stu-id="644aa-109">The restriction policy provides a mechanism where only trusted code is given unrestricted access to a user's privileges.</span></span> <span data-ttu-id="644aa-110">Неизвестный код, который может содержать вирусы или код, конфликтующий с установленными программами, может выполняться только в ограниченной среде (часто называемой *песочницей*), где ей запрещено обращаться к любым привилегиям пользователей, учитывающим безопасность.</span><span class="sxs-lookup"><span data-stu-id="644aa-110">Unknown code, which might contain viruses or code that conflicts with currently installed programs, is allowed to run only in a constrained environment (often called a *sandbox*) where it is disallowed from accessing any security-sensitive user privileges.</span></span>

<span data-ttu-id="644aa-111">Политика ограниченного использования программ зависит от назначения уровней доверия коду, который может выполняться в системе.</span><span class="sxs-lookup"><span data-stu-id="644aa-111">The software restriction policy depends on assigning trust levels to the code that can run on a system.</span></span> <span data-ttu-id="644aa-112">В настоящее время существуют два уровня доверия: неограниченные и запрещенные.</span><span class="sxs-lookup"><span data-stu-id="644aa-112">Currently, two trust levels exist: Unrestricted and Disallowed.</span></span> <span data-ttu-id="644aa-113">Коду с неограниченным уровнем доверия предоставляется неограниченный доступ к привилегиям пользователя, поэтому этот уровень доверия следует применять только к полностью доверенному коду.</span><span class="sxs-lookup"><span data-stu-id="644aa-113">Code that has an Unrestricted trust level is given unrestricted access to the user's privileges, so this trust level should be applied only to fully trusted code.</span></span> <span data-ttu-id="644aa-114">Код с запрещенным уровнем доверия запрещает доступ к каким-либо конфиденциальным правам пользователя и может запускаться только в песочнице, которая помогает предотвратить загрузку неразрешенного кода в адресное пространство с помощью неограниченного кода.</span><span class="sxs-lookup"><span data-stu-id="644aa-114">Code with a Disallowed trust level is disallowed from accessing any security-sensitive user privileges and can run only in a sandbox that helps prevent Unrestricted code from loading the Disallowed code into its address space.</span></span>

<span data-ttu-id="644aa-115">Настройка политики ограниченного использования программ для системы осуществляется с помощью средства администрирования локальной политики безопасности, в то время как Настройка политики ограничения для отдельных приложений COM+ выполняется программно или с помощью средства администрирования "службы компонентов".</span><span class="sxs-lookup"><span data-stu-id="644aa-115">Configuring the software restriction policy for a system is done through the Local Security Policy administrative tool, while the restriction policy configuration of individual COM+ applications is done either programmatically or through the Component Services administrative tool.</span></span> <span data-ttu-id="644aa-116">Если уровень доверия политики ограничения не указан для приложения COM+, для определения уровня доверия приложения будут использоваться параметры для всей системы.</span><span class="sxs-lookup"><span data-stu-id="644aa-116">If the restriction policy trust level is not specified for a COM+ application, the systemwide settings will be used to determine the application's trust level.</span></span> <span data-ttu-id="644aa-117">Параметры политики ограничения COM+ должны быть тщательно скоординированы с параметрами общедоступной системы, так как приложение COM+ с неограниченным уровнем доверия может загружать только компоненты с неограниченным уровнем доверия. неразрешенное приложение COM+ может загружать компоненты с любым уровнем доверия, но не может получить доступ ко всем правам пользователя.</span><span class="sxs-lookup"><span data-stu-id="644aa-117">The COM+ restriction policy settings must be carefully coordinated with the systemwide settings because a COM+ application that has an Unrestricted trust level can load only components with an Unrestricted trust level; a Disallowed COM+ application can load components with any trust level but cannot access all of the user's privileges.</span></span>

<span data-ttu-id="644aa-118">Помимо уровней доверия политики ограниченного использования программ для отдельных приложений COM+, два других свойства определяют, как политика ограничения используется для всех приложений COM+.</span><span class="sxs-lookup"><span data-stu-id="644aa-118">In addition to the software restriction policy trust levels of individual COM+ applications, two other properties determine how the restriction policy is used for all COM+ applications.</span></span> <span data-ttu-id="644aa-119">Если [српруннингобжектчеккс](/windows/desktop/com/srprunningobjectchecks) включен, попытки подключения к работающим объектам будут проверяться на наличие соответствующих уровней доверия.</span><span class="sxs-lookup"><span data-stu-id="644aa-119">If [SRPRunningObjectChecks](/windows/desktop/com/srprunningobjectchecks) is enabled, attempts to connect to running objects will be checked for appropriate trust levels.</span></span> <span data-ttu-id="644aa-120">Выполняющийся объект не может иметь менее строгий уровень доверия, чем объект клиента.</span><span class="sxs-lookup"><span data-stu-id="644aa-120">The running object cannot have a less stringent trust level than the client object.</span></span> <span data-ttu-id="644aa-121">Например, выполняющийся объект не может иметь неразрешенный уровень доверия, если у клиентского объекта есть неограниченный уровень доверия.</span><span class="sxs-lookup"><span data-stu-id="644aa-121">For example, the running object cannot have a Disallowed trust level if the client object has an Unrestricted trust level.</span></span>

<span data-ttu-id="644aa-122">Второе свойство определяет, как политика ограниченного использования программ обрабатывает подключения активатора.</span><span class="sxs-lookup"><span data-stu-id="644aa-122">The second property determines how the software restriction policy handles activate-as-activator connections.</span></span> <span data-ttu-id="644aa-123">Если [српактиватеасактиваторчеккс](/windows/desktop/com/srpactivateasactivatorchecks) включен, уровень доверия, настроенный для объекта сервера, сравнивается с уровнем доверия клиентского объекта и более строгим уровнем доверия будет использоваться для запуска серверного объекта.</span><span class="sxs-lookup"><span data-stu-id="644aa-123">If [SRPActivateAsActivatorChecks](/windows/desktop/com/srpactivateasactivatorchecks) is enabled, the trust level that is configured for the server object is compared with the trust level of the client object and the more stringent trust level will be used to run the server object.</span></span> <span data-ttu-id="644aa-124">Если Српактиватеасактиваторчеккс не включен, объект сервера будет работать с уровнем доверия клиентского объекта независимо от уровня доверия, с которым он был настроен.</span><span class="sxs-lookup"><span data-stu-id="644aa-124">If SRPActivateAsActivatorChecks is not enabled, the server object will run with the trust level of the client object regardless of the trust level with which it was configured.</span></span> <span data-ttu-id="644aa-125">По умолчанию включены оба Српруннингобжектчеккс и Српактиватеасактиваторчеккс.</span><span class="sxs-lookup"><span data-stu-id="644aa-125">By default, both SRPRunningObjectChecks and SRPActivateAsActivatorChecks are enabled.</span></span>

## <a name="related-topics"></a><span data-ttu-id="644aa-126">См. также</span><span class="sxs-lookup"><span data-stu-id="644aa-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="644aa-127">Аутентификация клиента</span><span class="sxs-lookup"><span data-stu-id="644aa-127">Client Authentication</span></span>](client-authentication.md)
</dt> <dt>

[<span data-ttu-id="644aa-128">Олицетворение и делегирование клиента</span><span class="sxs-lookup"><span data-stu-id="644aa-128">Client Impersonation and Delegation</span></span>](client-impersonation-and-delegation.md)
</dt> <dt>

[<span data-ttu-id="644aa-129">Настройка политики ограниченного использования программ</span><span class="sxs-lookup"><span data-stu-id="644aa-129">Configuring the Software Restriction Policy</span></span>](configuring-the-software-restriction-policy.md)
</dt> <dt>

[<span data-ttu-id="644aa-130">Безопасность библиотечных приложений</span><span class="sxs-lookup"><span data-stu-id="644aa-130">Library Application Security</span></span>](library-application-security.md)
</dt> <dt>

[<span data-ttu-id="644aa-131">Многоуровневая защита приложений</span><span class="sxs-lookup"><span data-stu-id="644aa-131">Multi-Tier Application Security</span></span>](multi-tier-application-security.md)
</dt> <dt>

[<span data-ttu-id="644aa-132">Безопасность программных компонентов</span><span class="sxs-lookup"><span data-stu-id="644aa-132">Programmatic Component Security</span></span>](programmatic-component-security.md)
</dt> <dt>

[<span data-ttu-id="644aa-133">Администрирование безопасности на основе ролей</span><span class="sxs-lookup"><span data-stu-id="644aa-133">Role-Based Security Administration</span></span>](role-based-security-administration.md)
</dt> </dl>

 

 
