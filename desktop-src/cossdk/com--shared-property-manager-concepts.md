---
description: В COM+ общее переходное состояние для объектов управляется с помощью общего диспетчера свойств (SPM). SPM — это распределитель ресурсов, который можно использовать для обмена состояниями между несколькими объектами в процессе сервера.
ms.assetid: 31b50c2a-68b5-4816-9a56-8cd9475e7beb
title: Общие понятия диспетчер свойств COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9be55c4a83aa363c911564aefabbe1d85f3804fb
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105710779"
---
# <a name="com-shared-property-manager-concepts"></a>Общие понятия диспетчер свойств COM+

В COM+ общее переходное состояние для объектов управляется с помощью общего диспетчера свойств (SPM). SPM — это распределитель ресурсов, который можно использовать для обмена состояниями между несколькими объектами в процессе сервера.

Нельзя использовать глобальные переменные в распределенной среде из-за проблем параллелизма и конфликтов имен. Диспетчер общих свойств устраняет конфликты имен, предоставляя общие группы свойств, которые устанавливают уникальные пространства имен для общих свойств, которые они содержат. SPM также реализует блокировки и семафоры для защиты общих свойств от одновременного доступа, что может привести к потере обновлений и покидать свойства в непредсказуемом состоянии.

> [!Note]  
> Общее переходное состояние — это сведения о состоянии, хранящиеся в памяти, которые не сохранятся из-за сбоев системы. Эти сведения предназначены для совместного использования несколькими объектами в пределах транзакций (но не между процессами).

 

Общие свойства, хранящиеся в SPM, доступны только для объектов, выполняющихся в одном процессе. Это означает, что объекты, которые будут использовать SPM для хранения значений и которые должны иметь доступ к этим значениям, должны быть установлены как часть одного приложения COM+. Системные администраторы могут перемещать классы COM+ из одного пакета в другой после развертывания приложения COM+. Если вы полагаетесь на несколько объектов, совместно использующих свойства с помощью SPM, необходимо четко документировать, что они должны быть установлены в одном приложении COM+.

Также важно, чтобы свойства общего доступа к компонентам имели один и тот же атрибут активации. Если два компонента в одном пакете имеют разные атрибуты активации, они обычно не смогут совместно использовать свойства. Например, если один компонент настроен для выполнения в клиентском процессе, а другой настроен для выполнения в серверном процессе, то их объекты обычно выполняются в разных процессах, даже если они находятся в одном пакете.

Экземпляры объектов [**шаредпропертиграупманажер**](sharedpropertygroupmanager.md), [**шаредпропертиграуп**](sharedpropertygroup.md)и [**шаредпроперти**](sharedproperty.md) всегда следует создавать из компонентов COM+, а не из базового клиента. Если базовый клиент создает общие группы свойств и свойства, общие свойства находятся внутри процесса базового клиента, а не в серверном процессе. Это означает, что объекты COM+ не могут совместно использовать свойства, если только эти объекты не выполняются в клиентском процессе (как правило, это не хорошая идея).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Общие диспетчер свойств COM+](com--shared-property-manager.md)
</dt> <dt>

[Общие группы свойств](shared-property-groups.md)
</dt> </dl>

 

 



