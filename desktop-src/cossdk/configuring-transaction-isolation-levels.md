---
description: COM+ предоставляет разработчикам больший контроль над своими приложениями, позволяя настраивать уровни изоляции транзакций.
ms.assetid: a59e262c-41f2-4c80-a04c-50a39af8b009
title: Настройка уровней изоляции транзакций
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36d789b9eaed6dfdd2f2419c7eae391d628e75b4
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104496044"
---
# <a name="configuring-transaction-isolation-levels"></a><span data-ttu-id="ead51-103">Настройка уровней изоляции транзакций</span><span class="sxs-lookup"><span data-stu-id="ead51-103">Configuring Transaction Isolation Levels</span></span>

<span data-ttu-id="ead51-104">COM+ предоставляет разработчикам больший контроль над своими приложениями, позволяя настраивать уровни изоляции транзакций.</span><span class="sxs-lookup"><span data-stu-id="ead51-104">COM+ gives developers more control over their applications by allowing configurable transaction isolation levels.</span></span> <span data-ttu-id="ead51-105">Версии COM+ до COM+ 1,5 всегда использовали самый высокий уровень изоляции транзакций.</span><span class="sxs-lookup"><span data-stu-id="ead51-105">Versions of COM+ prior to COM+ 1.5 always used the highest level of isolation for transactions.</span></span> <span data-ttu-id="ead51-106">Хотя этот уровень гарантирует, что целостность данных всегда сохраняется, это может привести к проблемам с производительностью, таким как время ожидания, когда много транзакций необходимо выполнить в большой базе данных.</span><span class="sxs-lookup"><span data-stu-id="ead51-106">While this level guarantees that data integrity is always preserved, it can lead to performance issues, such as time-outs, when many transactions need to be performed on a large database.</span></span> <span data-ttu-id="ead51-107">С помощью настраиваемых уровней изоляции опытные разработчики могут увеличить параллелизм, чтобы повысить производительность и масштабируемость.</span><span class="sxs-lookup"><span data-stu-id="ead51-107">With configurable isolation levels, experienced developers can increase concurrency to improve performance and scalability.</span></span>

<span data-ttu-id="ead51-108">COM+ предоставляет следующие уровни изоляции транзакций.</span><span class="sxs-lookup"><span data-stu-id="ead51-108">COM+ provides the following transaction isolation levels.</span></span>



| <span data-ttu-id="ead51-109">Level</span><span class="sxs-lookup"><span data-stu-id="ead51-109">Level</span></span>            | <span data-ttu-id="ead51-110">Описание</span><span class="sxs-lookup"><span data-stu-id="ead51-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ead51-111">Сериализованные</span><span class="sxs-lookup"><span data-stu-id="ead51-111">Serialized</span></span>       | <span data-ttu-id="ead51-112">Данные, считанные текущей транзакцией, не могут быть изменены другой транзакцией до завершения текущей транзакции.</span><span class="sxs-lookup"><span data-stu-id="ead51-112">Data read by a current transaction cannot be changed by another transaction until the current transaction finishes.</span></span> <span data-ttu-id="ead51-113">Новые данные не могут быть вставлены, что повлияет на текущую транзакцию.</span><span class="sxs-lookup"><span data-stu-id="ead51-113">No new data can be inserted that would affect the current transaction.</span></span> <span data-ttu-id="ead51-114">Это самый надежный уровень изоляции, который используется по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="ead51-114">This is the safest isolation level and is the default.</span></span>                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="ead51-115">Уровень изоляции repeatable read</span><span class="sxs-lookup"><span data-stu-id="ead51-115">Repeatable read</span></span>  | <span data-ttu-id="ead51-116">Данные, считанные текущей транзакцией, не могут быть изменены другой транзакцией до завершения текущей транзакции.</span><span class="sxs-lookup"><span data-stu-id="ead51-116">Data read by a current transaction cannot be changed by another transaction until the current transaction finishes.</span></span> <span data-ttu-id="ead51-117">Во время транзакции можно вставлять любые типы новых данных.</span><span class="sxs-lookup"><span data-stu-id="ead51-117">Any type of new data can be inserted during a transaction.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="ead51-118">Уровень изоляции read committed</span><span class="sxs-lookup"><span data-stu-id="ead51-118">Read committed</span></span>   | <span data-ttu-id="ead51-119">Транзакция не может считывать данные, которые изменяются другой транзакцией, которая не зафиксирована.</span><span class="sxs-lookup"><span data-stu-id="ead51-119">A transaction cannot read data that is being modified by another transaction that has not committed.</span></span> <span data-ttu-id="ead51-120">Это уровень изоляции по умолчанию в Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ead51-120">This is the default isolation level in Microsoft SQL Server.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="ead51-121">Уровень изоляции read uncommitted</span><span class="sxs-lookup"><span data-stu-id="ead51-121">Read uncommitted</span></span> | <span data-ttu-id="ead51-122">Транзакция может считывать любые данные, даже если она изменяется другой транзакцией.</span><span class="sxs-lookup"><span data-stu-id="ead51-122">A transaction can read any data, even if it is being modified by another transaction.</span></span> <span data-ttu-id="ead51-123">Это наименее надежный уровень изоляции, но обеспечивает наибольшую степень параллелизма.</span><span class="sxs-lookup"><span data-stu-id="ead51-123">This is the least safe isolation level but allows the highest concurrency.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="ead51-124">Любой</span><span class="sxs-lookup"><span data-stu-id="ead51-124">Any</span></span>              | <span data-ttu-id="ead51-125">Поддерживается любой уровень изоляции.</span><span class="sxs-lookup"><span data-stu-id="ead51-125">Any isolation level is supported.</span></span> <span data-ttu-id="ead51-126">Этот параметр чаще всего используется нисходящими компонентами во избежание конфликтов.</span><span class="sxs-lookup"><span data-stu-id="ead51-126">This setting is most commonly used by downstream components to avoid conflicts.</span></span> <span data-ttu-id="ead51-127">Этот параметр полезен, так как любой нисходящий компонент должен быть настроен на уровне изоляции, который равен или меньше уровня изоляции немедленного вышестоящего компонента.</span><span class="sxs-lookup"><span data-stu-id="ead51-127">This setting is useful because any downstream component must be configured with an isolation level that is equal to or less than the isolation level of its immediate upstream component.</span></span> <span data-ttu-id="ead51-128">Таким образом, нисходящий компонент с уровнем изоляции, настроенным как Any, всегда использует тот же уровень изоляции, который использует его непосредственный восходящий компонент.</span><span class="sxs-lookup"><span data-stu-id="ead51-128">Therefore, a downstream component that has its isolation level configured as Any always uses the same isolation level that its immediate upstream component uses.</span></span> <span data-ttu-id="ead51-129">Если корневой объект в транзакции имеет уровень изоляции, настроенный на Any, его уровень изоляции будет сериализован.</span><span class="sxs-lookup"><span data-stu-id="ead51-129">If the root object in a transaction has its isolation level configured to Any, its isolation level becomes Serialized.</span></span> |



 

> [!Note]  
> <span data-ttu-id="ead51-130">Если нисходящий компонент настроен на более высокий уровень изоляции, чем вышестоящий компонент, и пытается присоединиться к транзакции, возникает ошибка и транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="ead51-130">If a downstream component is configured with a higher isolation level than an upstream component and attempts to enlist in a transaction, an error results and the transaction aborts.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="ead51-131">См. также</span><span class="sxs-lookup"><span data-stu-id="ead51-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ead51-132">Установка уровня изоляции транзакций</span><span class="sxs-lookup"><span data-stu-id="ead51-132">Setting the Transaction Isolation Level</span></span>](setting-the-transaction-isolation-level.md)
</dt> </dl>

 

 



