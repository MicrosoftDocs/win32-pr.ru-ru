---
description: Атрибуты транзакции можно задать вручную с помощью средства администрирования "службы компонентов" или добавить программную поддержку для транзакций при написании компонента.
ms.assetid: b0d701c7-47ef-4034-873f-dd4428efb4c7
title: Установка атрибута Transaction
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3c0690a50f79c77a18b089cec1865dfbb9e7f428
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104142367"
---
# <a name="setting-the-transaction-attribute"></a>Установка атрибута Transaction

Атрибуты транзакции можно задать вручную с помощью средства администрирования "службы компонентов" или добавить программную поддержку для транзакций при написании компонента.

Дополнительные сведения о значениях атрибутов транзакций см. в разделе [Настройка транзакций](configuring-transactions.md).

**Установка значения атрибута с помощью средства администрирования "службы компонентов"**

1.  В дереве консоли щелкните правой кнопкой мыши компонент, который необходимо настроить, и выберите пункт **Свойства**.

2.  В диалоговом окне Свойства компонента перейдите на вкладку **транзакции** .

3.  В разделе **Поддержка транзакций** выберите параметр для нужного значения. Значение по умолчанию для всех компонентов **не поддерживается**.

4.  Нажмите кнопку **ОК**.

Эту процедуру необходимо повторить для каждого компонента.

## <a name="to-set-the-attribute-value-programmatically"></a>Задание значения атрибута программным способом

Программисты, использующие Microsoft Visual Basic, могут установить атрибут TRANSACTION с **мтстрансактионмоде**, свойством модуля класса для проектов DLL ActiveX. Visual Basic сопоставляет выбранные элементы с эквивалентным значением атрибута транзакции COM+ и публикует значение в библиотеке типов компонента.

В следующей таблице каждое значение константы **мтстрансактионмоде** сопоставляется с эквивалентным ЗНАЧЕНИЕМ транзакции COM+.



| Константа Мтстрансактионмоде         | Значение транзакции COM+             |
|-------------------------------------|------------------------------------|
| Нотанмтсобжект (по умолчанию)<br/> | Выключено<br/>                |
| Нетранзакционные<br/>           | Не поддерживается (по умолчанию)<br/> |
| рекуирестрансактион <br/>     | Обязательно<br/>                |
| усестрансактион <br/>         | Поддерживается<br/>               |
| рекуиресневтрансактион <br/>  | RequiresNew<br/>            |



 

Доступ к свойству **мтстрансактионмоде** также можно получить программно с помощью API библиотеки администрирования com+.

 

 




