---
description: Передача объектов в качестве параметров
ms.assetid: 174847c8-4545-4f61-ae13-42bdec1405e7
title: Передача объектов в качестве параметров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a58e012138bc65cec481f714ac216bb8227fb924
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539185"
---
# <a name="passing-objects-as-parameters"></a><span data-ttu-id="7a80c-103">Передача объектов в качестве параметров</span><span class="sxs-lookup"><span data-stu-id="7a80c-103">Passing Objects as Parameters</span></span>

<span data-ttu-id="7a80c-104">Служба COM+ в очереди компонентов не включает очередь для каждого существующего COM-компонента.</span><span class="sxs-lookup"><span data-stu-id="7a80c-104">The COM+ queued components service does not enable queuing for every existing COM component.</span></span> <span data-ttu-id="7a80c-105">Существуют ограничения на типы методов, которые могут быть поставлены в очередь.</span><span class="sxs-lookup"><span data-stu-id="7a80c-105">There are restrictions on the types of methods that can be queued.</span></span> <span data-ttu-id="7a80c-106">Из-за ограничений обмена сообщениями методы должны соответствовать следующим правилам.</span><span class="sxs-lookup"><span data-stu-id="7a80c-106">Because of messaging constraints, methods must adhere to the following rules:</span></span>

-   <span data-ttu-id="7a80c-107">Они должны содержать только входные параметры.</span><span class="sxs-lookup"><span data-stu-id="7a80c-107">They must contain input parameters only.</span></span>
-   <span data-ttu-id="7a80c-108">Они должны возвращать не зависящий от приложения результат.</span><span class="sxs-lookup"><span data-stu-id="7a80c-108">They must return no application-specific result.</span></span>

<span data-ttu-id="7a80c-109">Кроме того, существуют ограничения на типы входных параметров, которые могут быть переданы в компонент, поставленный в очередь.</span><span class="sxs-lookup"><span data-stu-id="7a80c-109">Additionally, there are restrictions on the types of input parameters that can be passed to a queued component.</span></span> <span data-ttu-id="7a80c-110">Во время выполнения служба очередей компонентов упаковывает аргументы на клиенте и передает их компоненту сервера с помощью [очереди сообщений](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="7a80c-110">At run time, the queued components service packages the arguments at the client and passes them to the server component by using [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span></span> <span data-ttu-id="7a80c-111">Простые типы, такие как целые числа и логические значения, можно легко маршалировать — более сложные типы не могут быть упакованы без помощи.</span><span class="sxs-lookup"><span data-stu-id="7a80c-111">Simple types, such as integers and Booleans, can be marshaled easily—more complex types cannot be marshaled without help.</span></span>

<span data-ttu-id="7a80c-112">В случае передачи объекта через вызов метода очередного компонента в качестве параметра клиент передает объект в средство записи.</span><span class="sxs-lookup"><span data-stu-id="7a80c-112">In the case of passing an object through a queued component's method call as a parameter, the client passes the object to the recorder.</span></span> <span data-ttu-id="7a80c-113">Средство записи маршалирует объект в сообщение очереди сообщений и передает его в прослушиватель.</span><span class="sxs-lookup"><span data-stu-id="7a80c-113">The recorder marshals the object into a Message Queuing message and passes it to the listener.</span></span> <span data-ttu-id="7a80c-114">После того как прослушиватель выберет сообщение и передаст его проигрывателю, проигрыватель должен повторно создать экземпляр объекта, чтобы передать его в вызов метода, указанный клиентом.</span><span class="sxs-lookup"><span data-stu-id="7a80c-114">After the listener picks up the message and passes it to the player, the player must reinstantiate the object to dispatch it to the method call specified by the client.</span></span> <span data-ttu-id="7a80c-115">В зависимости от времени существования клиента и сервера в среде, поставленной в очередь, это подразумевает, что эти объекты должны иметь возможность маршалировать по значению.</span><span class="sxs-lookup"><span data-stu-id="7a80c-115">Based on the lifetimes of the client and server in a queued environment, the implication is that these objects must be able to marshal by value.</span></span> <span data-ttu-id="7a80c-116">Поскольку COM+ не предоставляет семантику передачи по значению для стандартных COM-объектов, средству записи и проигрывателя требуется помощь компонента для маршалирования и распаковки объекта.</span><span class="sxs-lookup"><span data-stu-id="7a80c-116">Because COM+ does not provide pass-by-value semantics for standard COM objects, the recorder and player need help from the component to marshal and unmarshal the object.</span></span>

<span data-ttu-id="7a80c-117">Ссылки на объекты, поддерживающие [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) , можно использовать в качестве параметров для вызовов методов в очередях компонентов.</span><span class="sxs-lookup"><span data-stu-id="7a80c-117">Object references that support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) can be used as parameters to method calls on queued components.</span></span> <span data-ttu-id="7a80c-118">Объект не может делать предположения о том, когда будет создан его экземпляр.</span><span class="sxs-lookup"><span data-stu-id="7a80c-118">The object cannot make assumptions about when it will be reinstantiated.</span></span> <span data-ttu-id="7a80c-119">Например, сервер может быть недоступен, или серверный компонент может быть не запущен до тех пор, пока не истечет этот день.</span><span class="sxs-lookup"><span data-stu-id="7a80c-119">For example, the server may be unavailable or the server component may not be started until later in the day.</span></span> <span data-ttu-id="7a80c-120">Объекты, не поддерживающие **IPersistStream** , возвращают ошибку.</span><span class="sxs-lookup"><span data-stu-id="7a80c-120">Objects that do not support **IPersistStream** will return an error.</span></span>

## <a name="visual-basic-persistable-objects"></a><span data-ttu-id="7a80c-121">Visual Basic сохраняемые объекты</span><span class="sxs-lookup"><span data-stu-id="7a80c-121">Visual Basic Persistable Objects</span></span>

<span data-ttu-id="7a80c-122">Microsoft Visual Basic 6 позволяет создавать сохраняемые объекты.</span><span class="sxs-lookup"><span data-stu-id="7a80c-122">Microsoft Visual Basic 6 allows persistable objects to be created.</span></span> <span data-ttu-id="7a80c-123">Эти объекты поддерживают [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) и могут передаваться в качестве параметров в вызовы методов компонента в очереди.</span><span class="sxs-lookup"><span data-stu-id="7a80c-123">These objects support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) and can be passed as parameters to queued component method calls.</span></span> <span data-ttu-id="7a80c-124">Чтобы объект Visual Basic можно было передать в очередь компонента, необходимо инициализировать Сохраняемый объект.</span><span class="sxs-lookup"><span data-stu-id="7a80c-124">Before a Visual Basic object can be passed to a queued component, the persistable object must be initialized.</span></span> <span data-ttu-id="7a80c-125">Это можно сделать одним из следующих двух способов:</span><span class="sxs-lookup"><span data-stu-id="7a80c-125">This can be done in one of the following two ways:</span></span>

-   <span data-ttu-id="7a80c-126">Если приложение, создающее Сохраняемый объект, написано на Visual Basic, среда выполнения Visual Basic автоматически обрабатывает инициализацию объекта.</span><span class="sxs-lookup"><span data-stu-id="7a80c-126">If the application creating the persistable object is written in Visual Basic, the Visual Basic runtime handles the object initialization automatically.</span></span>
-   <span data-ttu-id="7a80c-127">Если приложение, создающее Visual Basic Сохраняемый объект, написано на языке, отличном от Visual Basic, например Microsoft Visual C++, приложение должно явным образом инициализировать компонент, либо запросив интерфейс [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) для сохраняемого объекта, либо вызвав метод [**Иперсистстреаминит:: InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)или [**IPersistStream:: Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) .</span><span class="sxs-lookup"><span data-stu-id="7a80c-127">If the application that creates the Visual Basic persistable object is written in a language other than Visual Basic, such as Microsoft Visual C++, the application must explicitly initialize the component by either querying for the persistable object's [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) interface or calling the [**IPersistStreamInit::InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew), or [**IPersistStream::Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) method.</span></span>

## <a name="ado-recordsets-and-ole-db-rowsets"></a><span data-ttu-id="7a80c-128">Наборы записей ADO и OLE DB наборы строк</span><span class="sxs-lookup"><span data-stu-id="7a80c-128">ADO Recordsets and OLE DB Rowsets</span></span>

<span data-ttu-id="7a80c-129">Передача **набора записей** ADO или OLE DB объектов наборов строк между компонентами позволяет одному компоненту обрабатывать результаты запросов, выполняемых другим компонентом.</span><span class="sxs-lookup"><span data-stu-id="7a80c-129">Passing ADO **Recordset** or OLE DB rowset objects between components allows one component to process the results of queries executed by another component.</span></span> <span data-ttu-id="7a80c-130">Это полезно при развертывании приложения на нескольких компьютерах.</span><span class="sxs-lookup"><span data-stu-id="7a80c-130">This is helpful when deploying an application across multiple computers.</span></span> <span data-ttu-id="7a80c-131">Объекты **наборов записей** и наборов строк могут передаваться как параметры метода в очереди компонентов со следующими ограничениями.</span><span class="sxs-lookup"><span data-stu-id="7a80c-131">**Recordset** and rowset objects can be passed as method parameters to queued components, with the following restrictions:</span></span>

-   <span data-ttu-id="7a80c-132">Объекты **набора записей** на стороне сервера нельзя маршалировать с помощью [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span><span class="sxs-lookup"><span data-stu-id="7a80c-132">Server-side **Recordset** objects cannot be marshaled using [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span></span> <span data-ttu-id="7a80c-133">Только объекты **набора записей** на стороне клиента могут передаваться в качестве параметров в вызов метода компонента в очереди.</span><span class="sxs-lookup"><span data-stu-id="7a80c-133">Only client-side **Recordset** objects can be passed as parameters to a queued component method call.</span></span>
-   <span data-ttu-id="7a80c-134">Если вы работаете непосредственно с OLE DB, набор строк OLE DB должен быть определен как набор строк на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="7a80c-134">If you work directly with OLE DB, the OLE DB rowset must be defined as a client-side rowset.</span></span>

 

 
