---
description: Модель распределенного программирования (Майкрософт) состоит из нескольких технологий, включая MSMQ, IIS, DCOM и COM+. Все эти службы были разработаны для использования распределенными приложениями.
ms.assetid: c72bbd47-0219-40ba-a7d5-2a6b725972d0
title: Предположения и принципы разработки COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7dea86c404896a3d6095d39ebd6031767f6ccdd
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692042"
---
# <a name="com-design-assumptions-and-principles"></a><span data-ttu-id="62952-104">Предположения и принципы разработки COM+</span><span class="sxs-lookup"><span data-stu-id="62952-104">COM+ Design Assumptions and Principles</span></span>

<span data-ttu-id="62952-105">Модель распределенного программирования (Майкрософт) состоит из нескольких технологий, включая MSMQ, IIS, DCOM и COM+.</span><span class="sxs-lookup"><span data-stu-id="62952-105">The Microsoft distributed programming model consists of several technologies, including MSMQ, IIS, DCOM, and COM+.</span></span> <span data-ttu-id="62952-106">Все эти службы были разработаны для использования распределенными приложениями.</span><span class="sxs-lookup"><span data-stu-id="62952-106">All of these services were designed for use by distributed applications.</span></span>

<span data-ttu-id="62952-107">Приложение COM+ было разработано для упрощения создания распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="62952-107">COM+ was developed to make creating distributed applications easier.</span></span> <span data-ttu-id="62952-108">Общая архитектура основана на наборе допущений и принципов.</span><span class="sxs-lookup"><span data-stu-id="62952-108">The overall architecture is based on a set of assumptions and principles.</span></span>

## <a name="assumptions"></a><span data-ttu-id="62952-109">Предположения</span><span class="sxs-lookup"><span data-stu-id="62952-109">Assumptions</span></span>

<span data-ttu-id="62952-110">Предполагается следующее:</span><span class="sxs-lookup"><span data-stu-id="62952-110">The assumptions are as follows:</span></span>

-   <span data-ttu-id="62952-111">**Приложение COM+ будет поддерживать несколько пользователей на нескольких серверах.**</span><span class="sxs-lookup"><span data-stu-id="62952-111">**The COM+ application will support multiple users across multiple servers.**</span></span> <span data-ttu-id="62952-112">Иными словами, вы создаете распределенное приложение, и эти несколько пользователей будут находиться на разных узлах, где выполняется код.</span><span class="sxs-lookup"><span data-stu-id="62952-112">In other words, you are building a distributed application, and these multiple users are going to be on different host computers from where the code runs.</span></span> <span data-ttu-id="62952-113">Пользователи будут получать доступ к коду через Интернет или через частную сеть.</span><span class="sxs-lookup"><span data-stu-id="62952-113">Users are going to access the code via the Internet or via a private network.</span></span> <span data-ttu-id="62952-114">Пользовательский интерфейс будет представлен с помощью браузера или, возможно, пользовательского приложения, например приложения на основе форм, написанного с помощью Microsoft Visual Basic или MFC.</span><span class="sxs-lookup"><span data-stu-id="62952-114">The user interface is going to be presented via browser or perhaps a custom application, such as a form-based application written with Microsoft Visual Basic or MFC.</span></span> <span data-ttu-id="62952-115">Этот пользовательский интерфейс будет расположен на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="62952-115">That user interface is going to be located on the client computer.</span></span>
-   <span data-ttu-id="62952-116">**Приложение COM+ можно сделать масштабируемым и повысить доступность и надежность, развернув приложение на нескольких серверных компьютерах.**</span><span class="sxs-lookup"><span data-stu-id="62952-116">**The COM+ application can be made scalable and can provide greater availability and reliability by deploying the application across multiple server computers.**</span></span> <span data-ttu-id="62952-117">Это позволяет сбалансировать рабочую нагрузку приложения и обеспечить отказоустойчивость с помощью кластеризации Windows.</span><span class="sxs-lookup"><span data-stu-id="62952-117">By doing this, you can balance the workload of the application and provide fault tolerance by using Windows Clustering.</span></span>
-   <span data-ttu-id="62952-118">**В случае неправильной работы состояние сохраняемых данных, хранящихся в базе данных, из приложения COM+ будет поддерживаться при использовании транзакций.**</span><span class="sxs-lookup"><span data-stu-id="62952-118">**If things go wrong, the state of the persisted data, stored in a database, from a COM+ application will be maintained if you are using transactions.**</span></span> <span data-ttu-id="62952-119">Состояние приложения должно содержаться в всякое, которые могут возникать, например ошибки приложений, сбои системы или сбои сети.</span><span class="sxs-lookup"><span data-stu-id="62952-119">The application state must survive accidents that can occur, such as application errors, system crashes, or network failures.</span></span>

## <a name="principles"></a><span data-ttu-id="62952-120">Принципы работы</span><span class="sxs-lookup"><span data-stu-id="62952-120">Principles</span></span>

<span data-ttu-id="62952-121">Помимо этих трех допущений, следующие принципы перваде модель программирования COM+:</span><span class="sxs-lookup"><span data-stu-id="62952-121">In addition to these three assumptions, the following principles pervade the COM+ programming model:</span></span>

-   <span data-ttu-id="62952-122">**Логика приложения будет размещаться на серверных компьютерах, а не на клиентских компьютерах.**</span><span class="sxs-lookup"><span data-stu-id="62952-122">**The application logic will reside on server computers, not on client computers.**</span></span> <span data-ttu-id="62952-123">Это можно сделать тремя основными причинами.</span><span class="sxs-lookup"><span data-stu-id="62952-123">There are three major reasons to do this:</span></span>
    -   <span data-ttu-id="62952-124">Клиентский компьютер может не иметь вычислительной мощности или функций, необходимых для выполнения логики приложения.</span><span class="sxs-lookup"><span data-stu-id="62952-124">The client computer may not have the processing power or features needed to run the application logic.</span></span> <span data-ttu-id="62952-125">Кроме того, хранение логики приложения на сервере упрощает развертывание.</span><span class="sxs-lookup"><span data-stu-id="62952-125">In addition, keeping the application logic on the server simplifies deployment.</span></span>
    -   <span data-ttu-id="62952-126">Серверные компьютеры часто ближе к данным, и эти данные чаще всего находятся в базе данных.</span><span class="sxs-lookup"><span data-stu-id="62952-126">The server computers are often closer to the data, and this data is most often in a database.</span></span> <span data-ttu-id="62952-127">Так как приложение обращается к базам данных, вы должны быть очень чувствительны к стоимости подключений к базе данных.</span><span class="sxs-lookup"><span data-stu-id="62952-127">Because your application is accessing databases, you want to be very sensitive to the cost of database connections.</span></span> <span data-ttu-id="62952-128">Поместив большую часть логики на серверные компьютеры, можно совместно использовать подключения к базе данных и значительно улучшить производительность.</span><span class="sxs-lookup"><span data-stu-id="62952-128">By putting most of the logic on the server computers, you can share database connections and get a significant performance improvement.</span></span> <span data-ttu-id="62952-129">На серверных компьютерах есть и другие ресурсы, к которым можно предоставить общий доступ, а также повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="62952-129">There are other resources on the server computers that can be shared as well, again with a performance benefit.</span></span>
    -   <span data-ttu-id="62952-130">Наличие логики приложения на серверных компьютерах обеспечивает управление контекстом безопасности с помощью приложения.</span><span class="sxs-lookup"><span data-stu-id="62952-130">Having application logic reside on server computers keeps control of the security context with the application.</span></span> <span data-ttu-id="62952-131">Существует больший контроль над безопасностью, если обеспечить безопасность компонентов приложений, работающих на серверах, а не на клиентских компьютерах.</span><span class="sxs-lookup"><span data-stu-id="62952-131">You have more control over security if you maintain that security on application components running on server computers rather than on client computers.</span></span>
-   <span data-ttu-id="62952-132">**Транзакции являются основными.**</span><span class="sxs-lookup"><span data-stu-id="62952-132">**Transactions are the core.**</span></span> <span data-ttu-id="62952-133">По разработке транзакции, таким образом, перейти модель программирования COM+, которая очень важна для понимания.</span><span class="sxs-lookup"><span data-stu-id="62952-133">By design, transactions so permeate the COM+ programming model that it is very important for you to understand them.</span></span> <span data-ttu-id="62952-134">Хотя многие службы COM+ можно использовать без использования транзакций, если вы решили не использовать их, вы не сможете воспользоваться всеми преимуществами доступных служб COM+.</span><span class="sxs-lookup"><span data-stu-id="62952-134">While you can make use of many of the services of COM+ without using transactions, if you choose not to use them, you cannot take full advantage of the COM+ services available to you.</span></span> <span data-ttu-id="62952-135">Ниже перечислены некоторые важные преимущества использования транзакций.</span><span class="sxs-lookup"><span data-stu-id="62952-135">Some important benefits of using transactions include the following:</span></span>
    -   <span data-ttu-id="62952-136">Транзакции — это разумное решение для проблемы управления параллелизмом.</span><span class="sxs-lookup"><span data-stu-id="62952-136">Transactions are a reasonable solution for the problem of concurrency management.</span></span> <span data-ttu-id="62952-137">Кроме того, транзакции помогают защититься от сбоев и иметь хорошую модель восстановления с ошибками.</span><span class="sxs-lookup"><span data-stu-id="62952-137">Also, transactions help protect against crashes and have a good error recovery model.</span></span> <span data-ttu-id="62952-138">Кроме того, транзакции позволяют получить отличный способ управления задачами в нескольких системах.</span><span class="sxs-lookup"><span data-stu-id="62952-138">In addition, transactions turn out to be a great way to manage tasks across multiple systems.</span></span>
    -   <span data-ttu-id="62952-139">Приложение COM+ на основе транзакций можно спроектировать для работы с диспетчером ресурсов и базой данных, что помогает защищать большую часть сведений о состоянии.</span><span class="sxs-lookup"><span data-stu-id="62952-139">You can design a transaction-based COM+ application to work with a resource manager and a database, which helps protect most state information.</span></span> <span data-ttu-id="62952-140">Сохраняя состояние внутри базы данных или какого-либо другого хранилища, управляемого диспетчером ресурсов, не нужно сохранять много состояний внутри фактических объектов, создаваемых приложением.</span><span class="sxs-lookup"><span data-stu-id="62952-140">By keeping state inside a database or some other storage managed by a resource manager, you don't have to keep much state inside the actual objects your application creates.</span></span> <span data-ttu-id="62952-141">Хотя это и отдается от чисто объектно-ориентированной модели, она хорошо подходит для создания распределенных приложений с восстановлением после ошибок.</span><span class="sxs-lookup"><span data-stu-id="62952-141">While this is a departure from a pure object-oriented model, it works well for creating distributed applications with error recovery.</span></span>
-   <span data-ttu-id="62952-142">**Функциональные возможности приложения создаются в виде COM-объектов, а также используются для взаимодействия протоколов, используемых для связи с другими системами или технологиями.**</span><span class="sxs-lookup"><span data-stu-id="62952-142">**Application functionality is built as COM objects, wrapping the protocols used to communicate with other systems or technologies.**</span></span> <span data-ttu-id="62952-143">Поскольку вы, вероятно, создаете компоненты, которые будут объединять несколько технологий или устаревших систем, спланируйте использование различных протоколов связи.</span><span class="sxs-lookup"><span data-stu-id="62952-143">Because you are probably building components that are going to stitch together several technologies or legacy systems, plan on using a variety of communication protocols.</span></span> <span data-ttu-id="62952-144">Используйте протокол HTTP для обмена данными между клиентом и сервером или взаимодействия между приложениями через Интернет.</span><span class="sxs-lookup"><span data-stu-id="62952-144">Use HTTP for client/server communication or application-to-application communication over the Internet.</span></span> <span data-ttu-id="62952-145">Используйте DCOM для обмена данными между приложением или компонентом на сервере.</span><span class="sxs-lookup"><span data-stu-id="62952-145">Use DCOM for application-to-application or component-to-component communication on the server.</span></span>

## <a name="related-topics"></a><span data-ttu-id="62952-146">См. также</span><span class="sxs-lookup"><span data-stu-id="62952-146">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="62952-147">Основные рекомендации по проектированию приложений COM+</span><span class="sxs-lookup"><span data-stu-id="62952-147">Basic Guidelines for Designing COM+ Applications</span></span>](basic-guidelines-for-designing-com--applications.md)
</dt> <dt>

[<span data-ttu-id="62952-148">Проектирование приложения COM+ с помощью UML</span><span class="sxs-lookup"><span data-stu-id="62952-148">Designing the COM+ Application Using UML</span></span>](designing-the-com--application-using-uml.md)
</dt> <dt>

[<span data-ttu-id="62952-149">Общие рекомендации по проектированию для использования COM+</span><span class="sxs-lookup"><span data-stu-id="62952-149">General Design Tips for Using COM+</span></span>](general-design-tips-for-using-com-.md)
</dt> <dt>

[<span data-ttu-id="62952-150">Оптимизация взаимодействия с уровнем бизнес-логики COM+</span><span class="sxs-lookup"><span data-stu-id="62952-150">Optimizing Interactions with the COM+ Business Logic Tier</span></span>](optimizing-interactions-with-the-com--business-logic-tier.md)
</dt> <dt>

[<span data-ttu-id="62952-151">Другие средства Майкрософт для создания распределенных приложений</span><span class="sxs-lookup"><span data-stu-id="62952-151">Other Microsoft Tools for Building Distributed Applications</span></span>](other-microsoft-tools-for-building-distributed-applications.md)
</dt> </dl>

 

 



