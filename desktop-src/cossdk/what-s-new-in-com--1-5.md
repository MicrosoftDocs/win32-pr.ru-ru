---
description: COM+ версии 1,5 добавляет новые функции, предназначенные для повышения общей масштабируемости, доступности и управляемости приложений COM+ как для разработчиков, так и для системных администраторов.
ms.assetid: e7073ba5-6b19-4d94-8cc0-b4e16bb44afd
title: Новые возможности COM+ 1,5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 994237002ea5d19c2cb00364f1064df38ed7271f
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423438"
---
# <a name="whats-new-in-com-15"></a><span data-ttu-id="83860-103">Новые возможности COM+ 1,5</span><span class="sxs-lookup"><span data-stu-id="83860-103">What's New in COM+ 1.5</span></span>

<span data-ttu-id="83860-104">COM+ версии 1,5 добавляет новые функции, предназначенные для повышения общей масштабируемости, доступности и управляемости приложений COM+ как для разработчиков, так и для системных администраторов.</span><span class="sxs-lookup"><span data-stu-id="83860-104">COM+ version 1.5 adds new features that are designed to increase the overall scalability, availability, and manageability of COM+ applications both for developers and for system administrators.</span></span>

<span data-ttu-id="83860-105">COM+ 1,5 доступен начиная с Windows XP и Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="83860-105">COM+ 1.5 is available starting with Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="83860-106">Новые функции COM+ 1,5 недоступны в Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="83860-106">The new COM+ 1.5 features are not available in Windows 2000.</span></span>

## <a name="application-level-access-checks-enabled-by-default"></a><span data-ttu-id="83860-107">Проверки доступа Application-Level включены по умолчанию</span><span class="sxs-lookup"><span data-stu-id="83860-107">Application-Level Access Checks Enabled by Default</span></span>

<span data-ttu-id="83860-108">В рамках повышения безопасности системы проверки доступа по умолчанию включены при создании приложения COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-108">As part of the enhanced security of the system, access checks are enabled by default when creating a COM+ application.</span></span> <span data-ttu-id="83860-109">В предыдущих версиях проверки доступа по умолчанию отключены на уровне приложения и включены по умолчанию на уровне компонента.</span><span class="sxs-lookup"><span data-stu-id="83860-109">In previous versions, access checks were disabled by default at the application level and enabled by default at the component level.</span></span> <span data-ttu-id="83860-110">Начиная с Windows Server 2003, проверки доступа по умолчанию включены на уровне приложения и по умолчанию отключены на уровне компонента.</span><span class="sxs-lookup"><span data-stu-id="83860-110">Starting with Windows Server 2003, access checks are enabled by default at the application level and disabled by default at the component level.</span></span> <span data-ttu-id="83860-111">Дополнительные сведения и процедуры изменения параметров по умолчанию см. в разделе [Создание нового приложения COM+](creating-a-new-com--application.md), [Включение проверки доступа для приложения](enabling-access-checks-for-an-application.md)и [Включение проверки доступа на уровне компонента](enabling-access-checks-at-the-component-level.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-111">See [Creating a New COM+ Application](creating-a-new-com--application.md), [Enabling Access Checks for an Application](enabling-access-checks-for-an-application.md), and [Enabling Access Checks at the Component Level](enabling-access-checks-at-the-component-level.md) for more information and procedures on how to change the default settings.</span></span>

## <a name="application-pooling"></a><span data-ttu-id="83860-112">Объединение приложений в пул</span><span class="sxs-lookup"><span data-stu-id="83860-112">Application Pooling</span></span>

<span data-ttu-id="83860-113">Используя новое свойство Конкуррентаппс объекта [**комадминкаталогобжект**](comadmincatalogobject.md) в коллекции [**приложений**](applications.md) , пулы приложений COM+ добавляют масштабируемость для однопотоковых процессов и интегрируются с новой службой перезапуска приложений COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-113">With the new ConcurrentApps property of the [**COMAdminCatalogObject**](comadmincatalogobject.md) object in the [**Applications**](applications.md) collection, COM+ Application Pooling adds scalability for single-threaded processes and integrates with the new COM+ Application Recycling service.</span></span> <span data-ttu-id="83860-114">Подробные сведения см. в разделе [Группирование приложений COM+](com--application-pooling.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-114">See [COM+ Application Pooling](com--application-pooling.md) for detailed information.</span></span>

## <a name="application-recycling"></a><span data-ttu-id="83860-115">Перезапуск приложений</span><span class="sxs-lookup"><span data-stu-id="83860-115">Application Recycling</span></span>

<span data-ttu-id="83860-116">Перезапуск приложений значительно увеличивает общую стабильность ваших приложений.</span><span class="sxs-lookup"><span data-stu-id="83860-116">Application recycling significantly increases the overall stability of your applications.</span></span> <span data-ttu-id="83860-117">Поскольку производительность большинства приложений может снизиться с течением времени из-за таких факторов, как утечка памяти, зависимость от кода стороннего разработчика и немасштабируемое использование ресурсов, перезапуск приложений COM+ предоставляет простое решение для корректного завершения процесса, связанного с приложением, и его перезапуска.</span><span class="sxs-lookup"><span data-stu-id="83860-117">Because the performance of most applications can degrade over time due to factors such as memory leaks, reliance on third-party code, and nonscalable resource usage, COM+ application recycling provides a simple solution to gracefully shut down a process associated with an application and restart it.</span></span> <span data-ttu-id="83860-118">Подробные сведения см. в разделе [перезапуск приложений COM+](com--application-recycling.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-118">See [COM+ Application Recycling](com--application-recycling.md) for detailed information.</span></span> <span data-ttu-id="83860-119">Пошаговые инструкции по настройке перезапуска процессов см. в разделе «Настройка повторного запуска процессов» справки по администрированию служб компонентов.</span><span class="sxs-lookup"><span data-stu-id="83860-119">Also see "Configuring Process Recycling" in the Component Services Administration Help for a step-by-step procedure for configuring process recycling.</span></span>

## <a name="com-partitions"></a><span data-ttu-id="83860-120">Разделы COM+</span><span class="sxs-lookup"><span data-stu-id="83860-120">COM+ Partitions</span></span>

<span data-ttu-id="83860-121">В этом выпуске COM+ предоставляет поддержку для разделов COM+ — функцию, которая позволяет устанавливать и настраивать на одном компьютере несколько версий приложений COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-121">In this release, COM+ introduces support for COM+ partitions, a feature that allows multiple versions of COM+ applications to be installed and configured on the same machine.</span></span> <span data-ttu-id="83860-122">Эта функция позволяет сэкономить затраты и время на использование нескольких серверов для управления различными версиями приложения.</span><span class="sxs-lookup"><span data-stu-id="83860-122">This feature can save you the cost and time-consuming effort of using multiple servers to manage different versions of an application.</span></span> <span data-ttu-id="83860-123">На одном компьютере каждая секция действует как виртуальный сервер.</span><span class="sxs-lookup"><span data-stu-id="83860-123">On a single machine, each partition acts, in effect, as a virtual server.</span></span> <span data-ttu-id="83860-124">После установки приложения в каждый раздел создаются наборы разделов, которые сопоставляют пользователей с логическими серверами.</span><span class="sxs-lookup"><span data-stu-id="83860-124">After installing the application into each partition, you create partition sets that map users to the logical servers.</span></span> <span data-ttu-id="83860-125">Подробные сведения о настройке разделов COM+ и управлении ими см. в разделе [разделы COM+](com--partitions.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-125">See [COM+ Partitions](com--partitions.md) for detailed information about how to set up and manage COM+ partitions.</span></span> <span data-ttu-id="83860-126">Пошаговые инструкции см. в разделе «Администрирование разделов приложений» справки по администрированию служб компонентов.</span><span class="sxs-lookup"><span data-stu-id="83860-126">Also see "Administering Application Partitions" in the Component Services Administration Help for step-by-step procedures.</span></span>

## <a name="com-services-without-components"></a><span data-ttu-id="83860-127">Службы COM+ без компонентов</span><span class="sxs-lookup"><span data-stu-id="83860-127">COM+ Services Without Components</span></span>

<span data-ttu-id="83860-128">С помощью COM+ 1,5 можно использовать службы, предоставляемые COM+, без необходимости создания компонента для хранения методов, вызывающих эти службы.</span><span class="sxs-lookup"><span data-stu-id="83860-128">With COM+ 1.5, you can use the services provided by COM+ without needing to build a component to contain the methods that call those services.</span></span> <span data-ttu-id="83860-129">Это значительно выгодно для разработчиков, которые обычно не используют компоненты, но хотят использовать такие службы COM+, как транзакции или средство регистрации COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-129">This greatly benefits developers who do not normally use components but want to use COM+ services such as transactions or the COM+ Tracker.</span></span> <span data-ttu-id="83860-130">Используя службы COM+ без компонентов, разработчики могут избежать издержек при создании компонента, который используется для доступа только к необходимым службам COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-130">By using COM+ services without components, developers can avoid the overhead of creating a component that is used to access only the COM+ services they need.</span></span> <span data-ttu-id="83860-131">Подробные сведения см. в разделе [службы COM+ без компонентов](com--services-without-components.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-131">See [COM+ Services Without Components](com--services-without-components.md) for detailed information.</span></span>

## <a name="com-soap-service"></a><span data-ttu-id="83860-132">Служба COM+ SOAP</span><span class="sxs-lookup"><span data-stu-id="83860-132">COM+ SOAP Service</span></span>

<span data-ttu-id="83860-133">С помощью COM+ 1,5 теперь можно предоставлять приложение COM+ в качестве веб-службы XML.</span><span class="sxs-lookup"><span data-stu-id="83860-133">With COM+ 1.5, you can now expose a COM+ application as an XML web service.</span></span> <span data-ttu-id="83860-134">Можно также прозрачно использовать веб-службу XML, развернутую с помощью COM+ или нет, в качестве COM-компонента.</span><span class="sxs-lookup"><span data-stu-id="83860-134">You can also transparently use an XML web service, whether deployed using COM+ or not, as a COM component.</span></span> <span data-ttu-id="83860-135">Это означает, что вы можете легко создавать новые веб-службы XML из существующих приложений COM+ и легко внедрять веб-службы XML в новые приложения COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-135">This means that you can easily create new XML web services out of existing COM+ applications and easily incorporate XML web services into new COM+ applications.</span></span> <span data-ttu-id="83860-136">Подробные сведения см. в разделе [Служба COM+ SOAP](com--soap-service.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-136">See [COM+ SOAP Service](com--soap-service.md) for detailed information.</span></span>

## <a name="configurable-isolation-levels"></a><span data-ttu-id="83860-137">Настраиваемые уровни изоляции</span><span class="sxs-lookup"><span data-stu-id="83860-137">Configurable Isolation Levels</span></span>

<span data-ttu-id="83860-138">Разработчики COM+ могут использовать новое свойство Тксисолатионлевел или средство администрирования служб компонентов для настройки уровня изоляции приложения по мере необходимости, помогая увеличить параллелизм, производительность и масштабируемость.</span><span class="sxs-lookup"><span data-stu-id="83860-138">COM+ developers can use the new TxIsolationLevel property or the Component Services administrative tool to configure an application's isolation level according to need, helping to increase concurrency, performance, and scalability.</span></span> <span data-ttu-id="83860-139">Благодаря этой гибкости вы получаете право на получение всех последних задолженностей из своих приложений.</span><span class="sxs-lookup"><span data-stu-id="83860-139">This flexibility enables those with the right amount of expertise to get every last ounce of throughput out of their applications.</span></span> <span data-ttu-id="83860-140">Подробные сведения см. в разделе [Настройка уровней изоляции транзакций](configuring-transaction-isolation-levels.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-140">See [Configuring Transaction Isolation Levels](configuring-transaction-isolation-levels.md) for detailed information.</span></span>

## <a name="creating-private-components"></a><span data-ttu-id="83860-141">Создание частных компонентов</span><span class="sxs-lookup"><span data-stu-id="83860-141">Creating Private Components</span></span>

<span data-ttu-id="83860-142">В сценариях, где в приложении имеется несколько вспомогательных компонентов, которые должны вызываться только из других компонентов в этом приложении, этот выпуск COM+ позволяет использовать новое свойство Исприватекомпонент, чтобы пометить эти компоненты как частные.</span><span class="sxs-lookup"><span data-stu-id="83860-142">In scenarios where you have several helper components in an application that are meant to be called only from other components within that application, this release of COM+ enables you to use a new property, IsPrivateComponent, to mark these components as private.</span></span> <span data-ttu-id="83860-143">(В предыдущем выпуске COM+ все компоненты должны быть общедоступными для доступа к службам COM+, что означает, что эти компоненты могут быть активированы из других приложений.) Частный компонент может просматриваться и активироваться только другими компонентами в том же приложении, что обеспечивает более полный контроль над тем, какие функции предоставлять.</span><span class="sxs-lookup"><span data-stu-id="83860-143">(In the previous release of COM+, all components had to be public to have access to COM+ services, which means that these components could be activated from other applications.) A private component can be seen and activated only by other components in the same application, giving you more control over what functionality to expose.</span></span> <span data-ttu-id="83860-144">Необходимо только документировать и поддерживать общедоступные компоненты, одновременно используя закрытые компоненты, доступ к которым извне приложения невозможен, но все равно может воспользоваться преимуществами всех служб COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-144">You need only document and maintain the public components, while making use of private components that cannot be accessed from outside the application but that can still take advantage of all COM+ services.</span></span>

## <a name="dtc-security-settings"></a><span data-ttu-id="83860-145">Параметры безопасности DTC</span><span class="sxs-lookup"><span data-stu-id="83860-145">DTC Security Settings</span></span>

<span data-ttu-id="83860-146">Для координатор распределенных транзакций Майкрософт (DTC) были добавлены несколько новых параметров безопасности, что позволяет настраивать уровни безопасности для управления распределенными транзакциями.</span><span class="sxs-lookup"><span data-stu-id="83860-146">Several new security settings have been added for the Microsoft Distributed Transaction Coordinator (DTC), enabling you to customize your security levels for managing distributed transactions.</span></span> <span data-ttu-id="83860-147">См. раздел вопросы безопасности DTC об этих параметрах и способах их реализации.</span><span class="sxs-lookup"><span data-stu-id="83860-147">See DTC Security Considerations about these settings and how to implement them.</span></span>

<span data-ttu-id="83860-148">Чтобы упростить взаимную проверку подлинности, DTC может работать только под учетной записью NetworkService.</span><span class="sxs-lookup"><span data-stu-id="83860-148">To facilitate mutual authentication, the DTC is restricted to running under the NetworkService account.</span></span> <span data-ttu-id="83860-149">Подробные сведения см. в разделе Управление учетными записями и привилегиями.</span><span class="sxs-lookup"><span data-stu-id="83860-149">See Managing Accounts and Privileges for detailed information.</span></span>

<span data-ttu-id="83860-150">Для восстановления баз данных XA рекомендуется предоставить учетной записи NetworkService разрешения и роли, необходимые для выполнения этого восстановления.</span><span class="sxs-lookup"><span data-stu-id="83860-150">For recovery with XA databases, it is recommended that the NetworkService account be provided the permissions and roles needed to perform this recovery.</span></span> <span data-ttu-id="83860-151">Точный метод выполнения этого зависит от каждой базы данных.</span><span class="sxs-lookup"><span data-stu-id="83860-151">The exact method of doing this is specific to each database.</span></span> <span data-ttu-id="83860-152">Дополнительные сведения см. в разделе Отключение собственных распределенных транзакций и отключение TIP и транзакций XA.</span><span class="sxs-lookup"><span data-stu-id="83860-152">See Disabling Native Distributed Transactions and Disabling TIP and XA Transactions for more information.</span></span>

<span data-ttu-id="83860-153">Чтобы обеспечить более безопасную систему при использовании транзакций XA, платформы Windows Server 2003 содержат новую запись реестра для указания DLL-файлов XA.</span><span class="sxs-lookup"><span data-stu-id="83860-153">To help provide a more secure system when using XA transactions, Windows Server 2003 platforms include a new registry entry for specifying XA DLL files.</span></span> <span data-ttu-id="83860-154">При обновлении до Windows Server 2003 можно работать с транзакциями XA, как и раньше, создав запись реестра в разделе **hKey \_ Local \_ Machine \\ Software \\ Microsoft \\ MSDTC \\ XADLL**, где значение Name — это имя библиотеки DLL (в формате *dllname*. dll), а значение — полный путь к DLL-файлу.</span><span class="sxs-lookup"><span data-stu-id="83860-154">When upgrading to Windows Server 2003, you can work with XA transactions as before by creating a registry entry under **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\XADLL**, where the value name is the name of the DLL (in the format *dllname*.dll) and the value is the full path of the DLL file.</span></span> <span data-ttu-id="83860-155">Необходимо создать запись для каждого используемого DLL-файла XA.</span><span class="sxs-lookup"><span data-stu-id="83860-155">You need to create an entry for each XA DLL file in use.</span></span> <span data-ttu-id="83860-156">Если компьютер, на котором выполняется DTC, входит в состав кластера, необходимо выполнить запись реестра для каждого узла в кластере.</span><span class="sxs-lookup"><span data-stu-id="83860-156">If the computer running DTC is part of a cluster, the registry entry needs to be made for each node in the cluster.</span></span> <span data-ttu-id="83860-157">Дополнительные сведения см. в разделе Управление транзакциями XA.</span><span class="sxs-lookup"><span data-stu-id="83860-157">See Managing XA Transactions for more information.</span></span>

## <a name="low-memory-activation-gates"></a><span data-ttu-id="83860-158">Шлюзы активации Low-Memory</span><span class="sxs-lookup"><span data-stu-id="83860-158">Low-Memory Activation Gates</span></span>

<span data-ttu-id="83860-159">В этом выпуске COM+ автоматически проверяет память перед созданием сервера или объекта COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-159">With this release, COM+ automatically checks memory before creating a COM+ server or object.</span></span> <span data-ttu-id="83860-160">Если процентная доля виртуальной памяти, доступная для приложения, падает ниже фиксированного порога, активация завершается ошибкой до создания объекта.</span><span class="sxs-lookup"><span data-stu-id="83860-160">If the percentage of virtual memory available to the application falls below a fixed threshold, the activation fails before the object is created.</span></span> <span data-ttu-id="83860-161">При сбое этих активаций, которые обычно запускаются, служба [шлюза активации COM+ Low-Memory](com--low-memory-activation-gates.md) значительно повышает надежность системы.</span><span class="sxs-lookup"><span data-stu-id="83860-161">By failing these activations that would normally run, the [COM+ Low-Memory Activation Gates](com--low-memory-activation-gates.md) service greatly enhances system reliability.</span></span>

## <a name="moving-and-copying-com-components"></a><span data-ttu-id="83860-162">Перемещение и копирование компонентов COM</span><span class="sxs-lookup"><span data-stu-id="83860-162">Moving and Copying COM Components</span></span>

<span data-ttu-id="83860-163">В этом выпуске COM+ позволяет перемещать и копировать компоненты.</span><span class="sxs-lookup"><span data-stu-id="83860-163">With this release, COM+ allows you to move and copy your components.</span></span> <span data-ttu-id="83860-164">Это означает, что можно настроить одну физическую реализацию компонента много раз в разные моменты времени.</span><span class="sxs-lookup"><span data-stu-id="83860-164">This means you can configure a single physical implementation of a component many different times.</span></span> <span data-ttu-id="83860-165">Вы получаете возможность повторного использования компонентов на двоичном уровне, а не на уровне исходного кода, что приводит к уменьшению объема кода, снижению затрат на разработку и ускорению рынка.</span><span class="sxs-lookup"><span data-stu-id="83860-165">You get component reuse at a binary level rather than at the source code level, which results in less code, lower development costs, and faster time to market.</span></span> <span data-ttu-id="83860-166">Подробные сведения см. в разделе [Перемещение компонентов](moving-components.md) и [Копирование компонентов](copying-components.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-166">See [Moving Components](moving-components.md) and [Copying Components](copying-components.md) for detailed information.</span></span>

## <a name="network-access"></a><span data-ttu-id="83860-167">Сетевой доступ</span><span class="sxs-lookup"><span data-stu-id="83860-167">Network Access</span></span>

<span data-ttu-id="83860-168">В Windows Server 2003 по умолчанию отключен доступ к сети COM+, что означает, что COM+ можно использовать только локально по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="83860-168">COM+ network access is disabled by default on Windows Server 2003, meaning that COM+ can be used only locally by default.</span></span> <span data-ttu-id="83860-169">Используйте следующую процедуру, чтобы включить доступ к сети COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-169">Use the following procedure to enable network COM+ access.</span></span>

<span data-ttu-id="83860-170">**Включение доступа к сети через COM+**</span><span class="sxs-lookup"><span data-stu-id="83860-170">**To enable network COM+ access**</span></span>

1.  <span data-ttu-id="83860-171">В меню **Пуск** выберите пункт **Панель управления**, а затем выберите пункт **Установка и удаление программ**.</span><span class="sxs-lookup"><span data-stu-id="83860-171">On the **Start** menu, point to **Control Panel**, then select **Add or Remove Programs**.</span></span>

2.  <span data-ttu-id="83860-172">Щелкните элемент **Установка и удаление компонентов Windows**.</span><span class="sxs-lookup"><span data-stu-id="83860-172">Click **Add/Remove Windows Components**.</span></span>

3.  <span data-ttu-id="83860-173">Выберите пункт **Сервер приложений** и нажмите кнопку **Подробности**.</span><span class="sxs-lookup"><span data-stu-id="83860-173">Select **Application Server** and click **Details**.</span></span>

4.  <span data-ttu-id="83860-174">Установите флажок **включить доступ к com+ через сеть** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="83860-174">Check the box next to **Enable network COM+ access**, and then click **OK**.</span></span>

5.  <span data-ttu-id="83860-175">Нажмите кнопку **Далее** , чтобы завершить работу мастера компонентов Windows.</span><span class="sxs-lookup"><span data-stu-id="83860-175">Click **Next** to complete the Windows Components wizard.</span></span>

6.  <span data-ttu-id="83860-176">Нажмите кнопку **Готово** , чтобы закрыть мастер.</span><span class="sxs-lookup"><span data-stu-id="83860-176">Click **Finish** to close the wizard.</span></span>

<span data-ttu-id="83860-177">По умолчанию в Windows Server 2003 доступ к сетевым транзакциям DTC отключен.</span><span class="sxs-lookup"><span data-stu-id="83860-177">DTC network transactions access is disabled by default on Windows Server 2003.</span></span> <span data-ttu-id="83860-178">На этих платформах DTC по умолчанию может выполнять только локальные транзакции.</span><span class="sxs-lookup"><span data-stu-id="83860-178">On these platforms, the DTC can perform only local transactions by default.</span></span> <span data-ttu-id="83860-179">Используйте следующую процедуру, чтобы включить доступ к сети DTC.</span><span class="sxs-lookup"><span data-stu-id="83860-179">Use the following procedure to enable network DTC access.</span></span>

> [!NOTE]
> <span data-ttu-id="83860-180">Доступ к сети DTC можно также включить с помощью средства администрирования "службы компонентов" или программно с помощью библиотеки администрирования COM+.</span><span class="sxs-lookup"><span data-stu-id="83860-180">You can also enable network DTC access by using the Component Services administrative tool or programmatically through the COM+ Administration Library.</span></span> <span data-ttu-id="83860-181">Практические сведения см. в разделе «Настройка безопасности DTC» справки по администрированию служб компонентов.</span><span class="sxs-lookup"><span data-stu-id="83860-181">For procedural information, see "Configuring DTC Security" in the Component Services Administration Help.</span></span>

<span data-ttu-id="83860-182">**Включение доступа к сети DTC**</span><span class="sxs-lookup"><span data-stu-id="83860-182">**To enable network DTC access**</span></span>

1.  <span data-ttu-id="83860-183">В меню **Пуск** выберите пункт **Панель управления**, а затем выберите пункт **Установка и удаление программ**.</span><span class="sxs-lookup"><span data-stu-id="83860-183">On the **Start** menu, point to **Control Panel**, then select **Add or Remove Programs**.</span></span>

2.  <span data-ttu-id="83860-184">Щелкните элемент **Установка и удаление компонентов Windows**.</span><span class="sxs-lookup"><span data-stu-id="83860-184">Click **Add/Remove Windows Components**.</span></span>

3.  <span data-ttu-id="83860-185">Выберите пункт **Сервер приложений** и нажмите кнопку **Подробности**.</span><span class="sxs-lookup"><span data-stu-id="83860-185">Select **Application Server** and click **Details**.</span></span>

4.  <span data-ttu-id="83860-186">Установите флажок **включить доступ к сети DTC** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="83860-186">Check the box next to **Enable network DTC access**, and then click **OK**.</span></span>

5.  <span data-ttu-id="83860-187">Нажмите кнопку **Далее** , чтобы завершить работу мастера компонентов Windows.</span><span class="sxs-lookup"><span data-stu-id="83860-187">Click **Next** to complete the Windows Components wizard.</span></span>

6.  <span data-ttu-id="83860-188">Нажмите кнопку **Готово** , чтобы закрыть мастер.</span><span class="sxs-lookup"><span data-stu-id="83860-188">Click **Finish** to close the wizard.</span></span>

## <a name="pausing-and-disabling-applications"></a><span data-ttu-id="83860-189">Приостановка и отключение приложений</span><span class="sxs-lookup"><span data-stu-id="83860-189">Pausing and Disabling Applications</span></span>

<span data-ttu-id="83860-190">Теперь приложения COM+ являются более управляемыми.</span><span class="sxs-lookup"><span data-stu-id="83860-190">COM+ applications are now more manageable.</span></span> <span data-ttu-id="83860-191">Администратор может приостанавливать и возобновлять серверные приложения COM+, а также включать и отключать и использовать библиотеки COM+, серверные приложения или даже отдельные настроенные компоненты.</span><span class="sxs-lookup"><span data-stu-id="83860-191">An administrator can pause and resume COM+ server applications or disable and enable COM+ library or server applications, or even individual configured components.</span></span> <span data-ttu-id="83860-192">Как приостановка, так и отключение позволяют избежать будущих активаций, не влияя на существующие экземпляры компонентов.</span><span class="sxs-lookup"><span data-stu-id="83860-192">Both the pausing and disabling features prevent future activations without affecting existing component instances.</span></span> <span data-ttu-id="83860-193">Дополнительные сведения см. в разделе "Администрирование приложений COM+" справки по администрированию служб компонентов.</span><span class="sxs-lookup"><span data-stu-id="83860-193">See "Administering COM+ Applications" in the Component Services Administration Help for more information.</span></span>

## <a name="process-dumping"></a><span data-ttu-id="83860-194">Дамп процесса</span><span class="sxs-lookup"><span data-stu-id="83860-194">Process Dumping</span></span>

<span data-ttu-id="83860-195">Это непростая диагностика приложений в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="83860-195">It's not easy troubleshooting applications in a production environment.</span></span> <span data-ttu-id="83860-196">Как собрать сведения о проблеме, не нарушая работу запущенных процессов?</span><span class="sxs-lookup"><span data-stu-id="83860-196">How do you gather information on a problem without disturbing the running processes?</span></span> <span data-ttu-id="83860-197">Теперь COM+ предоставляет решение с помощью новой функции дампа процесса.</span><span class="sxs-lookup"><span data-stu-id="83860-197">COM+ now provides a solution through its new process dump feature.</span></span> <span data-ttu-id="83860-198">Эта функция позволяет системному администратору выгружать все состояния процесса без его завершения.</span><span class="sxs-lookup"><span data-stu-id="83860-198">This feature allows the system administrator to dump the entire state of a process without terminating it.</span></span> <span data-ttu-id="83860-199">Дополнительные сведения см. в разделе "Администрирование процесса аварийного дампа для отладки приложений COM+" в справке по администрированию служб компонентов.</span><span class="sxs-lookup"><span data-stu-id="83860-199">See "Administering the Process Dump Tool for Debugging COM+ Applications" in the Component Services Administration Help for more information.</span></span>

## <a name="process-initialization"></a><span data-ttu-id="83860-200">Инициализация процесса</span><span class="sxs-lookup"><span data-stu-id="83860-200">Process Initialization</span></span>

<span data-ttu-id="83860-201">Многие серверные приложения должны выполнить определенную инициализацию и очистку, когда они будут запущены и завершены.</span><span class="sxs-lookup"><span data-stu-id="83860-201">Many server applications need to do specific initialization and cleanup when they are started and shut down.</span></span> <span data-ttu-id="83860-202">При работе в Windows Server 2003 можно создать класс, реализующий интерфейс [**ипроцессинитиализер**](/windows/desktop/api/ComSvcs/nn-comsvcs-iprocessinitializer) .</span><span class="sxs-lookup"><span data-stu-id="83860-202">When running on Windows Server 2003, you can create a class that implements the [**IProcessInitializer**](/windows/desktop/api/ComSvcs/nn-comsvcs-iprocessinitializer) interface.</span></span> <span data-ttu-id="83860-203">При запуске процесс вызывает [**ипроцессинитиализер:: Startup**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-startup) и при завершении работы он вызывает [**Ипроцессинитиализер:: Shutdown**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-shutdown).</span><span class="sxs-lookup"><span data-stu-id="83860-203">When the process starts up, it calls [**IProcessInitializer::Startup**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-startup) and when shutting down, it calls [**IProcessInitializer::Shutdown**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-shutdown).</span></span> <span data-ttu-id="83860-204">Это дает компоненту возможность выполнять необходимые задачи, такие как инициализация подключений, файлов и кэшей.</span><span class="sxs-lookup"><span data-stu-id="83860-204">This gives your component the opportunity to do needed tasks, such as initializing connections, files, and caches.</span></span>

## <a name="running-com-applications-as-nt-services"></a><span data-ttu-id="83860-205">Запуск приложений COM+ в качестве служб NT</span><span class="sxs-lookup"><span data-stu-id="83860-205">Running COM+ Applications as NT Services</span></span>

<span data-ttu-id="83860-206">Разработчики COM+ теперь могут использовать средство администрирования "службы компонентов" для настройки и реализации серверного приложения COM+ в качестве службы NT.</span><span class="sxs-lookup"><span data-stu-id="83860-206">COM+ developers can now use the Component Services administrative tool to configure and implement a COM+ server application as an NT service.</span></span> <span data-ttu-id="83860-207">Это означает, что сервер может быть автоматически запущен или перезапущен, если приложение должно выполняться всегда. что приложение COM+ может запускаться как учетная запись локальной системы, если требуется выполнить привилегированные операции; и что зависимые службы приложения теперь могут запускаться автоматически.</span><span class="sxs-lookup"><span data-stu-id="83860-207">This means that the server can be automatically started or restarted if your application always needs to be running; that your COM+ application can run as the local system account if it needs to perform privileged operations; and that your application's dependent services can now be started automatically.</span></span> <span data-ttu-id="83860-208">Подробные сведения см. [в разделе приложения COM+, выполняющиеся в качестве приложений службы](com--applications-running-as-service-applications.md) .</span><span class="sxs-lookup"><span data-stu-id="83860-208">See [COM+ Applications Running as Service Applications](com--applications-running-as-service-applications.md) for detailed information.</span></span>

## <a name="side-by-side-assemblies"></a><span data-ttu-id="83860-209">Параллельные сборки</span><span class="sxs-lookup"><span data-stu-id="83860-209">Side-by-Side Assemblies</span></span>

<span data-ttu-id="83860-210">Параллельные сборки (SxS) позволяют приложениям указывать, какую версию системной библиотеки DLL или классического компонента COM следует использовать, например MDAC, MFS, MSVCRT или MSXML.</span><span class="sxs-lookup"><span data-stu-id="83860-210">Side-by-side (SxS) assemblies allow applications to specify which version of a system DLL or classic COM component to use, such as MDAC, MFS, MSVCRT, or MSXML.</span></span> <span data-ttu-id="83860-211">Например, если приложение ASP использует MSXML версии 2,0, можно гарантировать, что это приложение по-прежнему использует MSXML версии 2,0 даже после применения пакетов обновления на сервере.</span><span class="sxs-lookup"><span data-stu-id="83860-211">For example, if an ASP application relies on MSXML version 2.0, you can ensure that this application still uses MSXML version 2.0 even after service packs are applied to the server.</span></span> <span data-ttu-id="83860-212">Это значит, что даже если на компьютере установлена новая версия MSXML, версия 2,0 остается и используется приложением.</span><span class="sxs-lookup"><span data-stu-id="83860-212">That is, even when a new version of MSXML is installed on the computer, version 2.0 remains and is used by your application.</span></span>

<span data-ttu-id="83860-213">Чтобы настроить сборки SxS, необходимо знать путь к библиотеке DLL и убедиться, что файл манифеста COM+ существует в каждом виртуальном каталоге, который должен использовать библиотеку DLL.</span><span class="sxs-lookup"><span data-stu-id="83860-213">To configure SxS assemblies, you need to know the path to the DLL and that the COM+ manifest file exists in every virtual directory that needs to use the DLL.</span></span> <span data-ttu-id="83860-214">Манифест COM+ — это XML-файл, содержащий сведения о том, где установлена библиотека DLL.</span><span class="sxs-lookup"><span data-stu-id="83860-214">The COM+ manifest is an XML file that has information about where a DLL is installed.</span></span> <span data-ttu-id="83860-215">Этот манифест используется для создания контекста активации для приложения.</span><span class="sxs-lookup"><span data-stu-id="83860-215">The manifest is used to create an activation context for the application.</span></span> <span data-ttu-id="83860-216">Контекст активации позволяет приложению загрузить определенную версию библиотеки DLL, экземпляр объекта COM или пользовательскую версию окна.</span><span class="sxs-lookup"><span data-stu-id="83860-216">Activation contexts allow an application to load a particular DLL version, COM object instance, or custom window version.</span></span> <span data-ttu-id="83860-217">Для ввода полного пути к корневому каталогу приложения, содержащему допустимый файл манифеста сборки SxS, можно использовать средство администрирования служб компонентов или свойство Аппликатиондиректори.</span><span class="sxs-lookup"><span data-stu-id="83860-217">You can use the Component Services administrative tool or ApplicationDirectory property to enter the full path of the application root directory that contains a valid SxS assembly manifest file.</span></span> <span data-ttu-id="83860-218">Дополнительные сведения см. в разделе [изолированные приложения и параллельные сборки](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="83860-218">For more information, see [Isolated Applications and Side-by-side Assemblies](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

## <a name="windows-error-reporting"></a><span data-ttu-id="83860-219">Отчеты об ошибках Windows</span><span class="sxs-lookup"><span data-stu-id="83860-219">Windows Error Reporting</span></span>

<span data-ttu-id="83860-220">COM+ 1,5 включает поддержку компонента отчеты об ошибках Windows (WER), который доступен начиная с Windows XP.</span><span class="sxs-lookup"><span data-stu-id="83860-220">COM+ 1.5 includes support for the Windows Error Reporting (WER) component, available starting in Windows XP.</span></span> <span data-ttu-id="83860-221">WER позволяет пользователям уведомлять Майкрософт об ошибках приложений, сбоях ядра и не отвечает на запросы приложений.</span><span class="sxs-lookup"><span data-stu-id="83860-221">WER enables users to notify Microsoft of application faults, kernel faults, and unresponsive applications.</span></span> <span data-ttu-id="83860-222">Эти уведомления позволяют группам поддержки клиентов Майкрософт более эффективно решать технические проблемы.</span><span class="sxs-lookup"><span data-stu-id="83860-222">These notifications allow the Microsoft customer support teams to solve technical problems more effectively.</span></span> <span data-ttu-id="83860-223">Кроме того, компонент отчеты об ошибках Windows позволяет разработчикам COM+ получать сведения, которые можно использовать для улучшения своих приложений.</span><span class="sxs-lookup"><span data-stu-id="83860-223">In addition, the Windows Error Reporting component enables COM+ developers to receive information that can be used to improve their applications.</span></span> <span data-ttu-id="83860-224">Дополнительные сведения см. в разделе [Отчеты об ошибках Windows](/windows/desktop/wer/windows-error-reporting).</span><span class="sxs-lookup"><span data-stu-id="83860-224">For more information, see [Windows Error Reporting](/windows/desktop/wer/windows-error-reporting).</span></span>

 

 
