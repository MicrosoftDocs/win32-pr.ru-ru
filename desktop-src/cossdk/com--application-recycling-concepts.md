---
description: Повторное использование приложений может значительно повысить общую стабильность приложений COM+, предлагая быстрое решение известных проблем и помогая защититься от непредвиденных.
ms.assetid: bf98318b-4d87-44cc-85a1-68faf5547e06
title: Основные понятия перезапуска приложений COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab37376ff3bc6d03f454f63822641ed69fad0b47
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423286"
---
# <a name="com-application-recycling-concepts"></a><span data-ttu-id="470a2-103">Основные понятия перезапуска приложений COM+</span><span class="sxs-lookup"><span data-stu-id="470a2-103">COM+ Application Recycling Concepts</span></span>

<span data-ttu-id="470a2-104">Повторное использование приложений может значительно повысить общую стабильность приложений COM+, предлагая быстрое решение известных проблем и помогая защититься от непредвиденных.</span><span class="sxs-lookup"><span data-stu-id="470a2-104">Application recycling can significantly increase the overall stability of your COM+ applications by offering a quick fix for known problems and helping to protect against unexpected ones.</span></span> <span data-ttu-id="470a2-105">Например, производительность приложения может снизиться со временем из-за таких проблем, как утечка памяти, немасштабируемое использование ресурсов и сбой процесса.</span><span class="sxs-lookup"><span data-stu-id="470a2-105">For example, application performance can degrade over time because of problems such as memory leaks, nonscalable resource usage, and process failure.</span></span> <span data-ttu-id="470a2-106">COM+ предоставляет возможность повторного использования приложений в качестве решения для этих проблем.</span><span class="sxs-lookup"><span data-stu-id="470a2-106">COM+ provides application recycling as a solution to these problems.</span></span> <span data-ttu-id="470a2-107">Можно использовать повторное использование приложений для автоматического завершения процесса и его перезапуска, таким путем повторная инициализация невыполненного процесса и повторное выделение памяти, которую он использует.</span><span class="sxs-lookup"><span data-stu-id="470a2-107">You can use application recycling to automatically shut down a process and restart it, thus reinitializing a failing process and reallocating memory it uses.</span></span>

<span data-ttu-id="470a2-108">Перезапуск приложений работает путем создания дубликата процесса Dllhost, связанного с приложением.</span><span class="sxs-lookup"><span data-stu-id="470a2-108">Application recycling works by creating a duplicate of the Dllhost process associated with an application.</span></span> <span data-ttu-id="470a2-109">Этот дублирующий процесс dllhost обслуживает все будущие запросы объектов, что оставляет старую версию dllhost для завершения обслуживания оставшихся запросов объектов.</span><span class="sxs-lookup"><span data-stu-id="470a2-109">This duplicate Dllhost process services all future object requests, which leaves the old Dllhost to finish servicing the remaining object requests.</span></span> <span data-ttu-id="470a2-110">Старый процесс dllhost завершает работу при обнаружении выпуска всех внешних ссылок на объекты в процессе или при достижении значения времени ожидания истечения срока действия.</span><span class="sxs-lookup"><span data-stu-id="470a2-110">The old Dllhost process is shut down when it detects the release of all external references to objects in the process or when the expiration time-out value is reached.</span></span> <span data-ttu-id="470a2-111">В этом случае повторное использование приложений гарантирует, что клиентское приложение не будет испытывать перерыв в работе службы.</span><span class="sxs-lookup"><span data-stu-id="470a2-111">Through this behavior, application recycling ensures that a client application does not experience a service interruption.</span></span>

> [!Note]  
> <span data-ttu-id="470a2-112">Нельзя перезапустить приложение COM+, настроенное для запуска в качестве службы Windows.</span><span class="sxs-lookup"><span data-stu-id="470a2-112">You cannot recycle a COM+ application that has been configured to run as a Windows service.</span></span> <span data-ttu-id="470a2-113">Кроме того, библиотечные приложения имеют свойства перезапуска и группирования для своего хостового процесса.</span><span class="sxs-lookup"><span data-stu-id="470a2-113">Also, library applications have the recycling and pooling properties of their host process.</span></span>

 

<span data-ttu-id="470a2-114">Можно настроить перезапуск приложений в административном виде с помощью средства администрирования "службы компонентов" или программно с помощью административного пакета SDK для COM+.</span><span class="sxs-lookup"><span data-stu-id="470a2-114">You can configure application recycling administratively, by using the Component Services administrative tool, or programmatically, through the COM+ Administrative SDK.</span></span> <span data-ttu-id="470a2-115">Процессы можно перезапускать на основе нескольких критериев, определяемых следующими свойствами объекта [**комадминкаталогобжект**](comadmincatalogobject.md) в коллекции [**приложений**](applications.md) :</span><span class="sxs-lookup"><span data-stu-id="470a2-115">You can recycle processes based on several criteria, determined by the following properties of a [**COMAdminCatalogObject**](comadmincatalogobject.md) object in the [**Applications**](applications.md) collection:</span></span>

-   <span data-ttu-id="470a2-116">**Рециклелифетимелимит.**</span><span class="sxs-lookup"><span data-stu-id="470a2-116">**RecycleLifetimeLimit.**</span></span> <span data-ttu-id="470a2-117">Максимальное число минут, в течение которых процесс может быть выполнен до его повторного запуска.</span><span class="sxs-lookup"><span data-stu-id="470a2-117">The maximum number of minutes a process can run before it's recycled.</span></span> <span data-ttu-id="470a2-118">Допустимый диапазон — от 0 до 30 240 минут (21 день).</span><span class="sxs-lookup"><span data-stu-id="470a2-118">The valid range is 0 through 30,240 minutes (21 days).</span></span> <span data-ttu-id="470a2-119">Значение по умолчанию (в минутах) равно 0, что означает, что процесс не будет перезапущен из-за превышения времени существования.</span><span class="sxs-lookup"><span data-stu-id="470a2-119">The default number of minutes is 0, which indicates that the process will not recycle from reaching a lifetime limit.</span></span>
-   <span data-ttu-id="470a2-120">**Рециклемеморилимит.**</span><span class="sxs-lookup"><span data-stu-id="470a2-120">**RecycleMemoryLimit.**</span></span> <span data-ttu-id="470a2-121">Максимальный объем использования памяти процесса (в килобайтах) перед повторным запуском процесса.</span><span class="sxs-lookup"><span data-stu-id="470a2-121">The maximum amount of process memory usage (in kilobytes) before recycling the process.</span></span> <span data-ttu-id="470a2-122">Если использование памяти процесса превышает указанное число в течение более одной минуты, процесс будет перезапущен.</span><span class="sxs-lookup"><span data-stu-id="470a2-122">If the process memory usage exceeds the specified number for longer than one minute, the process is recycled.</span></span> <span data-ttu-id="470a2-123">Допустимый диапазон — от 0 до 1 048 576 КБ.</span><span class="sxs-lookup"><span data-stu-id="470a2-123">The valid range is 0 through 1,048,576 KB.</span></span> <span data-ttu-id="470a2-124">По умолчанию объем используемой памяти составляет 0 КБ, что означает, что процесс не будет перезапущен из-за достижения предела памяти.</span><span class="sxs-lookup"><span data-stu-id="470a2-124">The default amount of memory usage is 0 KB, which indicates that the process will not recycle from reaching a memory limit.</span></span>
-   <span data-ttu-id="470a2-125">**Рециклекалллимит.**</span><span class="sxs-lookup"><span data-stu-id="470a2-125">**RecycleCallLimit.**</span></span> <span data-ttu-id="470a2-126">Максимальное число вызовов, которые объекты приложения могут принять перед повторным запуском процесса.</span><span class="sxs-lookup"><span data-stu-id="470a2-126">The maximum number of calls that application objects can accept before recycling the process.</span></span> <span data-ttu-id="470a2-127">Допустимый диапазон — от 0 до 1 048 576 вызовов.</span><span class="sxs-lookup"><span data-stu-id="470a2-127">The valid range is 0 through 1,048,576 calls.</span></span> <span data-ttu-id="470a2-128">По умолчанию число вызовов равно 0, что означает, что процесс не будет перезапущен из-за достижения предельного числа вызовов.</span><span class="sxs-lookup"><span data-stu-id="470a2-128">The default number of calls is 0, which indicates that the process will not recycle from reaching a call limit.</span></span>
-   <span data-ttu-id="470a2-129">**Рециклеактиватионлимит.**</span><span class="sxs-lookup"><span data-stu-id="470a2-129">**RecycleActivationLimit.**</span></span> <span data-ttu-id="470a2-130">Максимальное число активаций объекта приложения, которое следует принять перед повторным запуском процесса.</span><span class="sxs-lookup"><span data-stu-id="470a2-130">The maximum number of application object activations to accept before recycling the process.</span></span> <span data-ttu-id="470a2-131">Допустимый диапазон — от 0 до 1 048 576 активаций.</span><span class="sxs-lookup"><span data-stu-id="470a2-131">The valid range is 0 through 1,048,576 activations.</span></span> <span data-ttu-id="470a2-132">По умолчанию число активаций равно 0, что означает, что процесс не будет перезапущен из-за ограничения активации.</span><span class="sxs-lookup"><span data-stu-id="470a2-132">The default number of activations is 0, which indicates that the process will not recycle from reaching an activation limit.</span></span>

<span data-ttu-id="470a2-133">Кроме того, свойство Рецикликспиратионтимеаут объекта [**комадминкаталогобжект**](comadmincatalogobject.md) используется для принудительного завершения процесса очистки.</span><span class="sxs-lookup"><span data-stu-id="470a2-133">Additionally, the RecycleExpirationTimeout property of the [**COMAdminCatalogObject**](comadmincatalogobject.md) object is used to force the shutdown of a recycled process.</span></span> <span data-ttu-id="470a2-134">Указывает количество минут ожидания выпуска всех внешних ссылок на объекты в перезапущенном процессе перед принудительным завершением процесса.</span><span class="sxs-lookup"><span data-stu-id="470a2-134">It indicates the number of minutes to wait for the release of all external references to objects in the recycled process before forcibly shutting down the process.</span></span> <span data-ttu-id="470a2-135">Допустимый диапазон — от 1 до 1440 минут (24 часа), а время ожидания истечения срока действия по умолчанию — 15 минут.</span><span class="sxs-lookup"><span data-stu-id="470a2-135">The valid range is 1 through 1440 minutes (24 hours), and the default expiration time-out is 15 minutes.</span></span> <span data-ttu-id="470a2-136">Это значение используется только в том случае, если уже определено, что процесс будет перезапущен на основе других критериев.</span><span class="sxs-lookup"><span data-stu-id="470a2-136">This value is used only when it is already determined that a process will be recycled based on the other criteria.</span></span>

<span data-ttu-id="470a2-137">Можно выбрать более одного критерия для перезапуска приложения.</span><span class="sxs-lookup"><span data-stu-id="470a2-137">You can select more than one criterion for recycling an application.</span></span> <span data-ttu-id="470a2-138">COM+ перезапускает приложение после того, как первый набор критериев будет удовлетворен.</span><span class="sxs-lookup"><span data-stu-id="470a2-138">COM+ recycles the application after the first of the set of criteria is satisfied.</span></span> <span data-ttu-id="470a2-139">Вы можете задать значение времени ожидания истечения срока действия, чтобы определить, как долго Старый процесс dllhost может потратить на выполнение оставшихся запросов на обслуживание, прежде чем принудительно завершить работу.</span><span class="sxs-lookup"><span data-stu-id="470a2-139">You can set the expiration time-out value to determine how long an old Dllhost process can spend completing remaining service requests before being forcibly shut down.</span></span>

<span data-ttu-id="470a2-140">Коллекция [**аппликатионинстанцес**](applicationinstances.md) предоставляет свойство хасрециклед, которое позволяет определить, было ли приложение перезапущено.</span><span class="sxs-lookup"><span data-stu-id="470a2-140">The [**ApplicationInstances**](applicationinstances.md) collection provides the HasRecycled property, which provides a way to determine whether the application has ever been recycled.</span></span>

## <a name="related-topics"></a><span data-ttu-id="470a2-141">См. также</span><span class="sxs-lookup"><span data-stu-id="470a2-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="470a2-142">Задачи перезапуска приложений COM+</span><span class="sxs-lookup"><span data-stu-id="470a2-142">COM+ Application Recycling Tasks</span></span>](com--application-recycling-tasks.md)
</dt> <dt>

[<span data-ttu-id="470a2-143">**рециклесуррогате**</span><span class="sxs-lookup"><span data-stu-id="470a2-143">**RecycleSurrogate**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-recyclesurrogate)
</dt> </dl>

 

 



