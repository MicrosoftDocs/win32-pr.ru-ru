---
description: Атрибут Transaction является декларативным свойством, которое автоматически управляет транзакциями для разработчика компонентов. Устанавливая этот атрибут, вы устраняете необходимость использовать явные элементы управления транзакциями в компоненте.
ms.assetid: ea0e4d7e-2598-4a42-993c-58815f2fa138
title: Настройка транзакций
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b57f27d47836193dc5d23c44e3344cb2a81d5984
ms.sourcegitcommit: bf526e267d3991892733bdd229c66d5365cf244a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2021
ms.locfileid: "104568558"
---
# <a name="configuring-transactions"></a><span data-ttu-id="45640-104">Настройка транзакций</span><span class="sxs-lookup"><span data-stu-id="45640-104">Configuring Transactions</span></span>

<span data-ttu-id="45640-105">*Атрибут Transaction* является декларативным свойством, которое автоматически управляет транзакциями для разработчика компонентов.</span><span class="sxs-lookup"><span data-stu-id="45640-105">The *transaction attribute* is a declarative property that automatically manages transactions for the component developer.</span></span> <span data-ttu-id="45640-106">Устанавливая этот атрибут, вы устраняете необходимость использовать явные элементы управления транзакциями в компоненте.</span><span class="sxs-lookup"><span data-stu-id="45640-106">By setting this attribute, you eliminate the need to use explicit transaction controls in your component.</span></span>

<span data-ttu-id="45640-107">COM+ использует атрибут транзакции компонента для определения типа защиты транзакций, необходимой для каждого активируемого им объекта.</span><span class="sxs-lookup"><span data-stu-id="45640-107">COM+ uses the component's transaction attribute to determine the type of transaction protection required for each object it activates.</span></span> <span data-ttu-id="45640-108">В зависимости от требований объект может совместно использовать свою транзакцию вызывающего объекта, требовать новую транзакцию или действовать без защиты транзакций.</span><span class="sxs-lookup"><span data-stu-id="45640-108">Depending on its requirement, an object can share its caller's transaction, require a new transaction, or operate without transaction protection.</span></span>

<span data-ttu-id="45640-109">COM+ предоставляет следующие значения атрибутов транзакций:</span><span class="sxs-lookup"><span data-stu-id="45640-109">COM+ provides the following transaction attribute values:</span></span>

<dl> <dt>

<span data-ttu-id="45640-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Доступ</span><span class="sxs-lookup"><span data-stu-id="45640-110"><span id="Disabled"></span><span id="disabled"></span><span id="DISABLED"></span>Disabled</span></span>
</dt> <dd>

<span data-ttu-id="45640-111">Как правило, значение этого атрибута следует задавать только в том случае, если вы уверены, что компонент никогда не получает доступ к диспетчеру ресурсов.</span><span class="sxs-lookup"><span data-stu-id="45640-111">In general, you should set this attribute value only when you are sure that the component never accesses a resource manager.</span></span> <span data-ttu-id="45640-112">При отключении атрибута Transaction COM+ игнорирует требования к транзакции компонента при определении размещения объекта в контексте.</span><span class="sxs-lookup"><span data-stu-id="45640-112">When you disable the transaction attribute, COM+ ignores the transactional requirements of the component in determining context placement of the object.</span></span> <span data-ttu-id="45640-113">В результате объект может совместно использовать контекст вызывающего объекта (и транзакцию).</span><span class="sxs-lookup"><span data-stu-id="45640-113">As a result, the object can share its caller's context (and transaction).</span></span> <span data-ttu-id="45640-114">При переносе COM-компонента в COM+ необходимо отключить атрибут Transaction, чтобы сохранить то же поведение транзакций, что и ненастроенный COM-компонент.</span><span class="sxs-lookup"><span data-stu-id="45640-114">When migrating a COM component to COM+, you must disable the transaction attribute to maintain the same transactional behavior as the unconfigured COM component.</span></span>

> [!Note]  
> <span data-ttu-id="45640-115">*Ненастроенный компонент* — это COM-компонент, который не был установлен в приложении COM+.</span><span class="sxs-lookup"><span data-stu-id="45640-115">An *unconfigured component* is a COM component that has not been installed in a COM+ application.</span></span>

 

</dd> <dt>

<span data-ttu-id="45640-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Не поддерживается</span><span class="sxs-lookup"><span data-stu-id="45640-116"><span id="Not_Supported"></span><span id="not_supported"></span><span id="NOT_SUPPORTED"></span>Not Supported</span></span>
</dt> <dd>

<span data-ttu-id="45640-117">При задании этого значения атрибута COM+ гарантирует, что любой объект, созданный из компонента, никогда не участвует в транзакции, независимо от состояния транзакций вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="45640-117">When you set this attribute value, COM+ ensures that any object created from the component never participates in a transaction, regardless of the transactional status of its caller.</span></span> <span data-ttu-id="45640-118">Объявив это значение, вы гарантируете, что объект не проголосовать за его транзакцию вызывающего объекта, и не сможет начать транзакцию.</span><span class="sxs-lookup"><span data-stu-id="45640-118">By declaring this value, you ensure that an object does not vote in its caller's transaction nor can it begin a transaction of its own.</span></span> <span data-ttu-id="45640-119">Не поддерживается значением по умолчанию для всех компонентов.</span><span class="sxs-lookup"><span data-stu-id="45640-119">Not Supported is the default value for all components.</span></span>

</dd> <dt>

<span data-ttu-id="45640-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Поддерживается</span><span class="sxs-lookup"><span data-stu-id="45640-120"><span id="Supported"></span><span id="supported"></span><span id="SUPPORTED"></span>Supported</span></span>
</dt> <dd>

<span data-ttu-id="45640-121">При задании этого значения атрибута COM+ гарантирует, что любой объект, созданный из компонента, будет участвовать в транзакции, если она существует.</span><span class="sxs-lookup"><span data-stu-id="45640-121">When you set this attribute value, COM+ ensures that any object created from the component participates in a transaction if one exists.</span></span> <span data-ttu-id="45640-122">Это значение объявляется, если требуется, чтобы объект был совместно использоваться в его транзакции вызывающего объекта, не требуя собственной транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-122">You declare this value when you want an object to share in its caller's transaction without requiring a transaction of its own.</span></span>

</dd> <dt>

<span data-ttu-id="45640-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-123"><span id="Required"></span><span id="required"></span><span id="REQUIRED"></span>Required</span></span>
</dt> <dd>

<span data-ttu-id="45640-124">При задании этого значения атрибута COM+ гарантирует, что любой объект, созданный из компонента, будет транзакционным.</span><span class="sxs-lookup"><span data-stu-id="45640-124">When you set this attribute value, COM+ ensures that any object created from the component is transactional.</span></span> <span data-ttu-id="45640-125">Когда COM+ активирует объект с требуемым параметром, он проверяет состояние транзакций вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="45640-125">When COM+ activates an object with the Required setting, it looks at the transactional status of its caller.</span></span> <span data-ttu-id="45640-126">Если вызывающий объект имеет транзакцию, новый объект включается в текущую транзакцию.</span><span class="sxs-lookup"><span data-stu-id="45640-126">If the caller has a transaction, the new object is included in the current transaction.</span></span> <span data-ttu-id="45640-127">В противном случае COM+ начинает транзакцию, делая новый объект корнем транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-127">Otherwise, COM+ begins a transaction, making the new object the root of the transaction.</span></span> <span data-ttu-id="45640-128">Это предпочтительный параметр для компонента, который выполняет действия с ресурсами, так как он помогает обеспечить защиту транзакций для этих действий.</span><span class="sxs-lookup"><span data-stu-id="45640-128">This is the preferred setting for a component that performs resource activities because it helps provide transaction protection for those activities.</span></span>

</dd> <dt>

<span data-ttu-id="45640-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Требуется новое</span><span class="sxs-lookup"><span data-stu-id="45640-129"><span id="Requires_New"></span><span id="requires_new"></span><span id="REQUIRES_NEW"></span>Requires New</span></span>
</dt> <dd>

<span data-ttu-id="45640-130">При задании этого значения атрибута COM+ гарантирует, что все объекты, созданные из компонента, должны участвовать в новой транзакции в качестве корня транзакции, независимо от состояния транзакций вызывающего.</span><span class="sxs-lookup"><span data-stu-id="45640-130">When you set this attribute value, COM+ ensures that any objects created from the component must participate in a new transaction as the root of the transaction, regardless of the transactional status of the caller.</span></span> <span data-ttu-id="45640-131">COM+ автоматически инициирует новую транзакцию, которая отличается от транзакции вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="45640-131">COM+ automatically initiates a new transaction that is distinct from the caller's transaction.</span></span>

> [!Note]  
> <span data-ttu-id="45640-132">COM+ не поддерживает вложенные транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-132">COM+ does not support nested transactions.</span></span> <span data-ttu-id="45640-133">Когда один объект транзакции вызывает другой компонент, помеченный как требуется New, COM+ создает независимую границу транзакций для вновь активированного объекта.</span><span class="sxs-lookup"><span data-stu-id="45640-133">When one transactional object calls another component marked as Requires New, COM+ creates an independent transactional boundary for the newly activated object.</span></span> <span data-ttu-id="45640-134">Вторая транзакция не может влиять на первую транзакцию, если первая транзакция явно не затронет результаты второй транзакции и не изменяет свой голос на основе этих результатов.</span><span class="sxs-lookup"><span data-stu-id="45640-134">The second transaction cannot affect the first transaction unless the first transaction explicitly notes the results of the second transaction and modifies its vote based on those results.</span></span>

 

</dd> </dl>

## <a name="transaction-attribute-dependencies"></a><span data-ttu-id="45640-135">Зависимости атрибутов транзакций</span><span class="sxs-lookup"><span data-stu-id="45640-135">Transaction Attribute Dependencies</span></span>

<span data-ttu-id="45640-136">В следующей таблице показаны характеристики каждого значения атрибута транзакции COM+, включая воздействие значения на характеристики транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-136">The following table shows the characteristics of each COM+ transaction attribute value, including the value's effect on transaction characteristics.</span></span> <span data-ttu-id="45640-137">COM+ принудительно реализует [JIT-активацию](com--just-in-time-activation.md) и [синхронизацию](com--synchronization.md) для всех компонентов транзакций.</span><span class="sxs-lookup"><span data-stu-id="45640-137">COM+ enforces [JIT activation](com--just-in-time-activation.md) and [Synchronization](com--synchronization.md) for all transaction components.</span></span>



| <span data-ttu-id="45640-138">Значение атрибута</span><span class="sxs-lookup"><span data-stu-id="45640-138">Attribute Value</span></span>          | <span data-ttu-id="45640-139">Создать транзакцию</span><span class="sxs-lookup"><span data-stu-id="45640-139">New Transaction</span></span>   | <span data-ttu-id="45640-140">Транзакция клиента</span><span class="sxs-lookup"><span data-stu-id="45640-140">Client's Transaction</span></span>                 | <span data-ttu-id="45640-141">Корень транзакции</span><span class="sxs-lookup"><span data-stu-id="45640-141">Transaction Root</span></span>                        | <span data-ttu-id="45640-142">JIT-активация</span><span class="sxs-lookup"><span data-stu-id="45640-142">JIT Activation</span></span>      | <span data-ttu-id="45640-143">Синхронизация</span><span class="sxs-lookup"><span data-stu-id="45640-143">Synchronization</span></span>     |
|--------------------------|-------------------|--------------------------------------|-----------------------------------------|---------------------|---------------------|
| <span data-ttu-id="45640-144">Выключено</span><span class="sxs-lookup"><span data-stu-id="45640-144">Disabled</span></span><br/>      | <span data-ttu-id="45640-145">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-145">Never</span></span><br/>  | <span data-ttu-id="45640-146">Возможно</span><span class="sxs-lookup"><span data-stu-id="45640-146">Maybe</span></span><br/>                     | <span data-ttu-id="45640-147">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-147">Never</span></span><br/>                        | <span data-ttu-id="45640-148">Необязательно</span><span class="sxs-lookup"><span data-stu-id="45640-148">Optional</span></span><br/> | <span data-ttu-id="45640-149">Необязательно</span><span class="sxs-lookup"><span data-stu-id="45640-149">Optional</span></span><br/> |
| <span data-ttu-id="45640-150">Не поддерживается</span><span class="sxs-lookup"><span data-stu-id="45640-150">Not Supported</span></span><br/> | <span data-ttu-id="45640-151">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-151">Never</span></span><br/>  | <span data-ttu-id="45640-152">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-152">Never</span></span><br/>                     | <span data-ttu-id="45640-153">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-153">Never</span></span><br/>                        | <span data-ttu-id="45640-154">Необязательно</span><span class="sxs-lookup"><span data-stu-id="45640-154">Optional</span></span><br/> | <span data-ttu-id="45640-155">Необязательно</span><span class="sxs-lookup"><span data-stu-id="45640-155">Optional</span></span><br/> |
| <span data-ttu-id="45640-156">Поддерживается</span><span class="sxs-lookup"><span data-stu-id="45640-156">Supported</span></span><br/>     | <span data-ttu-id="45640-157">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-157">Never</span></span><br/>  | <span data-ttu-id="45640-158">Если клиент имеет транзакцию</span><span class="sxs-lookup"><span data-stu-id="45640-158">If client has transaction</span></span><br/> | <span data-ttu-id="45640-159">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-159">Never</span></span><br/>                        | <span data-ttu-id="45640-160">Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-160">Required</span></span><br/> | <span data-ttu-id="45640-161">Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-161">Required</span></span><br/> |
| <span data-ttu-id="45640-162">Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-162">Required</span></span><br/>      | <span data-ttu-id="45640-163">Возможно</span><span class="sxs-lookup"><span data-stu-id="45640-163">Maybe</span></span><br/>  | <span data-ttu-id="45640-164">Если клиент имеет транзакцию</span><span class="sxs-lookup"><span data-stu-id="45640-164">If client has transaction</span></span><br/> | <span data-ttu-id="45640-165">Если у клиента нет транзакции</span><span class="sxs-lookup"><span data-stu-id="45640-165">If client has no transaction</span></span><br/> | <span data-ttu-id="45640-166">Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-166">Required</span></span><br/> | <span data-ttu-id="45640-167">Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-167">Required</span></span><br/> |
| <span data-ttu-id="45640-168">RequiresNew</span><span class="sxs-lookup"><span data-stu-id="45640-168">Requires New</span></span><br/>  | <span data-ttu-id="45640-169">Всегда</span><span class="sxs-lookup"><span data-stu-id="45640-169">Always</span></span><br/> | <span data-ttu-id="45640-170">Никогда</span><span class="sxs-lookup"><span data-stu-id="45640-170">Never</span></span><br/>                     | <span data-ttu-id="45640-171">Всегда</span><span class="sxs-lookup"><span data-stu-id="45640-171">Always</span></span><br/>                       | <span data-ttu-id="45640-172">Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-172">Required</span></span><br/> | <span data-ttu-id="45640-173">Обязательно</span><span class="sxs-lookup"><span data-stu-id="45640-173">Required</span></span><br/> |



 

## <a name="transaction-boundaries"></a><span data-ttu-id="45640-174">Границы транзакций</span><span class="sxs-lookup"><span data-stu-id="45640-174">Transaction Boundaries</span></span>

<span data-ttu-id="45640-175">Транзакция имеет начало, конец и происходит ровно один раз.</span><span class="sxs-lookup"><span data-stu-id="45640-175">A transaction has a beginning, an end, and occurs exactly once.</span></span> <span data-ttu-id="45640-176">Во время выполнения транзакция может вызываться для ресурса, например базы данных или очереди, для выполнения одной или нескольких задач.</span><span class="sxs-lookup"><span data-stu-id="45640-176">During its execution, a transaction may call on a resource, such as a database or queue, to accomplish one or more tasks.</span></span> <span data-ttu-id="45640-177">Каждый ресурс попадает в пределах *границы транзакции*.</span><span class="sxs-lookup"><span data-stu-id="45640-177">Each resource falls within the *transaction boundary*.</span></span> <span data-ttu-id="45640-178">Все ресурсы внутри границы транзакции, которые могут охватывать несколько процессов и компьютеров, совместно используют одну транзакцию.</span><span class="sxs-lookup"><span data-stu-id="45640-178">All resources within a transaction boundary, which can span multiple process and computer boundaries, share a single transaction.</span></span> <span data-ttu-id="45640-179">Очень важно управлять согласованностью в пределах этих процессов и компьютеров.</span><span class="sxs-lookup"><span data-stu-id="45640-179">Managing consistency across these process and computer boundaries is important.</span></span>

<span data-ttu-id="45640-180">COM+ обеспечивает согласованность за счет автоматического управления границами транзакций на основе значения атрибута транзакции, заданного для каждого компонента.</span><span class="sxs-lookup"><span data-stu-id="45640-180">COM+ ensures consistency by managing transaction boundaries automatically, based on the value of the transaction attribute that you set for each component.</span></span> <span data-ttu-id="45640-181">Транзакция COM+ автоматически передается объектам, которые принимают участие в транзакции и обходят объекты, которые были выполнены за пределами транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-181">A COM+ transaction automatically flows to objects instructed to participate in a transaction and bypasses objects instructed to execute outside a transaction.</span></span> <span data-ttu-id="45640-182">COM+ не поддерживает вложенные транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-182">COM+ does not support nested transactions.</span></span> <span data-ttu-id="45640-183">Вместо этого транзакции COM+ являются отдельными и кратковременными.</span><span class="sxs-lookup"><span data-stu-id="45640-183">Instead, COM+ transactions are distinct and short-lived.</span></span>

<span data-ttu-id="45640-184">Первый объект в границе транзакции является специальным для транзакции и называется *корневым объектом* транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-184">The first object in a transaction boundary is special to the transaction and is called the *root object* of the transaction.</span></span> <span data-ttu-id="45640-185">В транзакции может быть только один корневой объект.</span><span class="sxs-lookup"><span data-stu-id="45640-185">There can be only one root object in a transaction.</span></span> <span data-ttu-id="45640-186">Все остальные объекты в иерархии транзакций в корневом объекте называются *внутренними объектами*.</span><span class="sxs-lookup"><span data-stu-id="45640-186">All other objects in the transactional hierarchy under the root object are called *interior objects*.</span></span>

## <a name="mapping-transactions"></a><span data-ttu-id="45640-187">Сопоставление транзакций</span><span class="sxs-lookup"><span data-stu-id="45640-187">Mapping Transactions</span></span>

<span data-ttu-id="45640-188">Один из способов убедиться, что объект включен в правильную границу транзакции, — это соотнесение транзакций до начала написания компонентов.</span><span class="sxs-lookup"><span data-stu-id="45640-188">One way to ensure that an object is included in the correct transaction boundary is to map your transactions before you start writing your components.</span></span> <span data-ttu-id="45640-189">При сопоставлении транзакций можно определить наилучшее значение для каждого записываемого компонента.</span><span class="sxs-lookup"><span data-stu-id="45640-189">By mapping transactions, you can determine the best setting for each component you write.</span></span> <span data-ttu-id="45640-190">Чем больше определено, чем будут использоваться компоненты, тем проще будет выбрать правильное значение атрибута транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-190">The more certain you are about how your components are to be used, the easier it is to select the correct transaction attribute value.</span></span>

<span data-ttu-id="45640-191">Во время выполнения COM+ просматривает атрибут Transaction, чтобы определить, должен ли объект быть корнем новой транзакции, создан в существующей транзакции или создан как нетранзакционный объект.</span><span class="sxs-lookup"><span data-stu-id="45640-191">At run time, COM+ looks at the transaction attribute to determine whether an object should be the root of a new transaction, be created in an existing transaction, or be created as a non-transactional object.</span></span>

<span data-ttu-id="45640-192">На следующем рисунке показано возможное сопоставление транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-192">The following illustration shows a possible transaction mapping.</span></span> <span data-ttu-id="45640-193">На рисунке клиент создает объект 1, для которого требуется транзакция.</span><span class="sxs-lookup"><span data-stu-id="45640-193">In the illustration, the client creates Object  1, which requires a transaction.</span></span> <span data-ttu-id="45640-194">Поскольку транзакция не существует, COM+ создает транзакцию 1 и помещает объект 1 в него в качестве корневого объекта.</span><span class="sxs-lookup"><span data-stu-id="45640-194">Because no transaction exists, COM+ creates Transaction 1 and places Object 1 in it as the root object.</span></span> <span data-ttu-id="45640-195">Объект 1 создает объект 2, который поддерживает транзакции и, следовательно, помещается в транзакцию 1.</span><span class="sxs-lookup"><span data-stu-id="45640-195">Object 1 creates Object 2, which supports transactions and is therefore placed in Transaction 1.</span></span> <span data-ttu-id="45640-196">Объект 2 создает объект 3, который не поддерживает транзакции и, следовательно, помещается вне всех транзакций.</span><span class="sxs-lookup"><span data-stu-id="45640-196">Object 2 creates Object 3, which does not support transactions and therefore is placed outside all transactions.</span></span> <span data-ttu-id="45640-197">Объект 2 также создает объект 4, который требует транзакции и поэтому помещается в транзакцию 1.</span><span class="sxs-lookup"><span data-stu-id="45640-197">Object 2 also creates Object 4, which requires a transaction and is therefore placed in Transaction  1.</span></span> <span data-ttu-id="45640-198">Объект 3 создает объект 5, который поддерживает транзакции.</span><span class="sxs-lookup"><span data-stu-id="45640-198">Object 3 creates Object 5, which supports transactions.</span></span> <span data-ttu-id="45640-199">Однако, поскольку объект 5 создается объектом, который не существует в транзакции, он также помещается за пределы всех транзакций.</span><span class="sxs-lookup"><span data-stu-id="45640-199">However, because Object 5 is created by an object that does not exist within a transaction, it also is placed outside all transactions.</span></span> <span data-ttu-id="45640-200">Объект 4 создает объект 6, для которого требуется новая транзакция, поэтому COM+ создает транзакцию 2 и помещает объект 6 в него в качестве корневого объекта.</span><span class="sxs-lookup"><span data-stu-id="45640-200">Object 4 creates Object 6, which requires a new transaction, so COM+ creates Transaction 2 and places Object 6 in it as the root object.</span></span> <span data-ttu-id="45640-201">Объект 6 создает объект 7, который поддерживает транзакции и поэтому помещается в транзакцию 2.</span><span class="sxs-lookup"><span data-stu-id="45640-201">Object 6 creates Object 7, which supports transactions and is therefore placed in Transaction 2.</span></span>

![Схема, на которой показано взаимодействие клиента с транзакцией 1 и транзакцией 2.](images/fc7e2d03-94c2-40d9-a79b-1e05ca31dd80.png)

<span data-ttu-id="45640-203">На предыдущем рисунке показаны две потенциальные проблемные области.</span><span class="sxs-lookup"><span data-stu-id="45640-203">The preceding illustration shows two potential problem areas.</span></span> <span data-ttu-id="45640-204">Во-первых, большая часть работы разделяется между двумя отдельными транзакциями.</span><span class="sxs-lookup"><span data-stu-id="45640-204">First, the majority of work is split between two distinct transactions.</span></span> <span data-ttu-id="45640-205">Если транзакция 1 завершается сбоем после того, как объект 4 создает объект 6, транзакция 2 не повлияет на результат транзакции 1.</span><span class="sxs-lookup"><span data-stu-id="45640-205">If Transaction 1 fails after Object 4 creates Object 6, Transaction 2 runs unaffected by the outcome of Transaction 1.</span></span> <span data-ttu-id="45640-206">Если этот результат не предполагался, можно попытаться сложить операции обеих транзакций в одну транзакцию, что можно сделать, изменив атрибут транзакции объекта 6 на Required.</span><span class="sxs-lookup"><span data-stu-id="45640-206">If this outcome is unintended, you might prefer to fold the operations of both transactions into a single transaction, which you can accomplish by changing the transaction attribute of Object  6 to Required.</span></span>

<span data-ttu-id="45640-207">На рисунке сопоставления также показано, что объект 3 и объект 5 являются нетранзакционными и выполняются полностью вне области транзакций 1 и 2.</span><span class="sxs-lookup"><span data-stu-id="45640-207">The mapping illustration also shows that Object 3 and Object 5 are non-transactional, running completely outside the scope of Transactions 1 and 2.</span></span> <span data-ttu-id="45640-208">Если объект 5 обновляет постоянные данные, может потребоваться повторное рассмотрение нетранзакционного состояния.</span><span class="sxs-lookup"><span data-stu-id="45640-208">If Object 5 updates persistent data, you might want to reconsider its non-transactional status.</span></span> <span data-ttu-id="45640-209">Объект 5 можно поместить в транзакцию, изменив его атрибут Transaction на Required.</span><span class="sxs-lookup"><span data-stu-id="45640-209">Object 5 can be placed within a transaction by changing its transaction attribute to Required.</span></span>

## <a name="related-topics"></a><span data-ttu-id="45640-210">См. также</span><span class="sxs-lookup"><span data-stu-id="45640-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="45640-211">Установка атрибута Transaction</span><span class="sxs-lookup"><span data-stu-id="45640-211">Setting the Transaction Attribute</span></span>](setting-the-transaction-attribute.md)
</dt> </dl>

 

 




