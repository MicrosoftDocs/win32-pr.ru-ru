---
description: Атрибут синхронизации — это декларативное свойство, которое указывает, какой тип синхронизации должен иметь компоненты при активации.
ms.assetid: 7f044ee5-b99e-4f0c-a680-b1e2672949fc
title: Значения атрибутов синхронизации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4606726d5202a1453e98d5bf609084982f8f824e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423310"
---
# <a name="synchronization-attribute-values"></a><span data-ttu-id="05044-103">Значения атрибутов синхронизации</span><span class="sxs-lookup"><span data-stu-id="05044-103">Synchronization Attribute Values</span></span>

<span data-ttu-id="05044-104">Атрибут синхронизации — это декларативное свойство, которое указывает, какой тип синхронизации должен иметь компоненты при активации.</span><span class="sxs-lookup"><span data-stu-id="05044-104">The synchronization attribute is a declarative property that specifies what type of synchronization you want your components to have when they are activated.</span></span> <span data-ttu-id="05044-105">При включении атрибута синхронизации COM+ обрабатывает сведения о синхронизации от вашего имени; никаких других вызовов делать не нужно.</span><span class="sxs-lookup"><span data-stu-id="05044-105">When you include the synchronization attribute, COM+ handles the details of synchronization on your behalf; you do not have to make any other calls.</span></span>

<span data-ttu-id="05044-106">В зависимости от требований объект может совместно использовать синхронизацию вызывающего объекта, требовать новую синхронизацию или выполнять синхронизацию без синхронизации.</span><span class="sxs-lookup"><span data-stu-id="05044-106">Depending on its requirements, an object can share its caller's synchronization, require a new synchronization, or operate without synchronization.</span></span>

<span data-ttu-id="05044-107">COM+ предоставляет следующие значения атрибутов синхронизации:</span><span class="sxs-lookup"><span data-stu-id="05044-107">COM+ provides the following synchronization attribute values:</span></span>

-   <span data-ttu-id="05044-108">**Отключены.**</span><span class="sxs-lookup"><span data-stu-id="05044-108">**Disabled.**</span></span> <span data-ttu-id="05044-109">При отключении атрибута синхронизации COM+ игнорирует требования синхронизации компонента в определении контекста для объекта.</span><span class="sxs-lookup"><span data-stu-id="05044-109">When you disable the synchronization attribute, COM+ ignores the synchronization requirements of the component in determining context for the object.</span></span> <span data-ttu-id="05044-110">В результате объект может или не может совместно использовать контекст вызывающего объекта (и синхронизацию).</span><span class="sxs-lookup"><span data-stu-id="05044-110">As a result, the object may or may not share its caller's context (and synchronization).</span></span>

    <span data-ttu-id="05044-111">В общем случае следует использовать это значение атрибута, если известно, что компонент никогда не обращается к диспетчеру ресурсов.</span><span class="sxs-lookup"><span data-stu-id="05044-111">In general, you should use this attribute value when you know the component never accesses a resource manager.</span></span> <span data-ttu-id="05044-112">При переносе COM-компонентов в COM+ необходимо отключить атрибут синхронизации, чтобы обеспечить то же поведение, что и ненастроенный COM-компонент.</span><span class="sxs-lookup"><span data-stu-id="05044-112">When migrating COM components to COM+, you must disable the synchronization attribute to maintain the same behavior as the unconfigured COM component.</span></span> <span data-ttu-id="05044-113">Ненастроенный компонент — это COM-компонент, который не был установлен в приложении COM+.</span><span class="sxs-lookup"><span data-stu-id="05044-113">An unconfigured component is a COM component that has not been installed in a COM+ application.</span></span>

-   <span data-ttu-id="05044-114">**Не поддерживается.**</span><span class="sxs-lookup"><span data-stu-id="05044-114">**Not Supported.**</span></span> <span data-ttu-id="05044-115">Объект с этим значением никогда не участвует в синхронизации, независимо от состояния своего вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="05044-115">An object with this value never participates in synchronization, regardless of the status of its caller.</span></span> <span data-ttu-id="05044-116">Этот параметр доступен только для компонентов, которые являются нетранзакционными и не используют службу JIT- [активации COM+](com--just-in-time-activation.md) .</span><span class="sxs-lookup"><span data-stu-id="05044-116">This setting is available only for components that are non-transactional and do not use the [COM+ just-in-time (JIT) activation](com--just-in-time-activation.md) service.</span></span>

-   <span data-ttu-id="05044-117">**Поддерживается.**</span><span class="sxs-lookup"><span data-stu-id="05044-117">**Supported.**</span></span> <span data-ttu-id="05044-118">Объект с этим значением участвует в синхронизации, если он существует.</span><span class="sxs-lookup"><span data-stu-id="05044-118">An object with this value participates in synchronization if it exists.</span></span> <span data-ttu-id="05044-119">Это значение объявляется, если требуется, чтобы объект был совместно использоваться в синхронизации вызывающего объекта, но не требовал синхронизации собственного.</span><span class="sxs-lookup"><span data-stu-id="05044-119">You declare this value when you want an object to share in its caller's synchronization but not require synchronization of its own.</span></span>

    <span data-ttu-id="05044-120">Хорошей причиной установки атрибута синхронизации является то, что этот параметр может быть менее затратным в плане системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="05044-120">A good reason to set your synchronization attribute to Supported is that this setting can be less expensive in terms of system resources.</span></span> <span data-ttu-id="05044-121">Тем не менее, гораздо сложнее написать компонент из-за необходимости его защиты от одновременных вызовов.</span><span class="sxs-lookup"><span data-stu-id="05044-121">However, it is more difficult to write your component because of the need to protect it from concurrent calls.</span></span> <span data-ttu-id="05044-122">Смысл установки атрибута синхронизации в значение support заключается в том, что при определенных обстоятельствах экземпляр объекта может быть создан таким образом, что он не синхронизирован.</span><span class="sxs-lookup"><span data-stu-id="05044-122">The implication of setting the synchronization attribute to Supported is that, under certain circumstances, an instance of your object may be created in such a way that it's not synchronized.</span></span> <span data-ttu-id="05044-123">Если потоковая модель компонента бесплатна или обе версии, необходимо защитить данные экземпляра с помощью некоторого типа механизма блокировки.</span><span class="sxs-lookup"><span data-stu-id="05044-123">If the component's threading model is Free or Both, you will have to protect your instance data with some type of locking mechanism.</span></span> <span data-ttu-id="05044-124">Если потоковая модель является Апартаментной (STA), вам не нужно защищать данные экземпляра.</span><span class="sxs-lookup"><span data-stu-id="05044-124">If the Threading Model is Apartment (STA), you won't need to protect your instance data.</span></span>

-   <span data-ttu-id="05044-125">**Обязательный.**</span><span class="sxs-lookup"><span data-stu-id="05044-125">**Required.**</span></span> <span data-ttu-id="05044-126">При задании этого атрибута COM+ гарантирует, что все объекты, создаваемые из компонента, будут синхронизированы.</span><span class="sxs-lookup"><span data-stu-id="05044-126">When you set this attribute, COM+ ensures that all objects created from the component will be synchronized.</span></span> <span data-ttu-id="05044-127">Фактически, каждый раз, когда COM+ создает экземпляр компонента, это гарантирует, что в каждый момент времени только один поток проходит через этот экземпляр.</span><span class="sxs-lookup"><span data-stu-id="05044-127">In effect, whenever COM+ creates an instance of your component, it makes sure there's only one thread going through this instance at a time.</span></span>

    <span data-ttu-id="05044-128">Когда COM+ активирует объект, он проверяет состояние синхронизации вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="05044-128">As COM+ activates an object, it looks at the synchronization status of its caller.</span></span> <span data-ttu-id="05044-129">Если вызывающий объект является синхронизированным, COM+ помещает границу синхронизации вызывающего объекта в, чтобы включить новый объект.</span><span class="sxs-lookup"><span data-stu-id="05044-129">If the caller is synchronized, COM+ flows the caller's synchronization boundary to include the new object.</span></span> <span data-ttu-id="05044-130">В противном случае COM+ начинает синхронизацию.</span><span class="sxs-lookup"><span data-stu-id="05044-130">Otherwise, COM+ begins the synchronization.</span></span>

-   <span data-ttu-id="05044-131">**Требуется New.**</span><span class="sxs-lookup"><span data-stu-id="05044-131">**Requires New.**</span></span> <span data-ttu-id="05044-132">Объект с этим значением должен участвовать в новой синхронизации, где COM+ управляет контекстами и апартаментами от имени всех компонентов, участвующих в вызове.</span><span class="sxs-lookup"><span data-stu-id="05044-132">An object with this value must participate in a new synchronization, where COM+ manages contexts and apartments on behalf of all components involved in the call.</span></span> <span data-ttu-id="05044-133">COM+ автоматически инициирует новую синхронизацию, которая отличается от синхронизации вызывающего объекта.</span><span class="sxs-lookup"><span data-stu-id="05044-133">COM+ automatically initiates a new synchronization, which is distinct from the caller's synchronization.</span></span>

    <span data-ttu-id="05044-134">Чтобы задать для атрибута синхронизации значение New, следует использовать этот параметр, чтобы более эффективно делать внешние вызовы к экземпляру компонента.</span><span class="sxs-lookup"><span data-stu-id="05044-134">A good reason to set your synchronization attribute to Requires New is that this setting allows you to make outside calls to an instance of your component more efficiently.</span></span> <span data-ttu-id="05044-135">Однако он также выполняет вызовы между объектом и объектом, который создал его с точки зрения системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="05044-135">However, it also makes calls between your object and the object that created it more expensive in terms of system resources.</span></span>

    <span data-ttu-id="05044-136">Например, предположим, что у объекта и его объекта-создателя есть общая граница синхронизации.</span><span class="sxs-lookup"><span data-stu-id="05044-136">For example, assume a case where your object and its creator object share the same synchronization boundary.</span></span> <span data-ttu-id="05044-137">Если клиент A вызывает объект Creator и клиент б вызывает объект, то второй вызов будет ожидать завершения первого вызова.</span><span class="sxs-lookup"><span data-stu-id="05044-137">If client A calls the creator object and client B calls your object, the second call will have to wait until the first call is completed.</span></span> <span data-ttu-id="05044-138">Если задано значение требуется новое, объект создается в отдельной границе синхронизации.</span><span class="sxs-lookup"><span data-stu-id="05044-138">If you set Requires New, your object is created in a separate synchronization boundary.</span></span> <span data-ttu-id="05044-139">В этом случае вызовы из других объектов могут обрабатываться одновременно.</span><span class="sxs-lookup"><span data-stu-id="05044-139">In this case, calls from other objects can be processed at the same time.</span></span> <span data-ttu-id="05044-140">Однако вызовы от объекта-создателя к объекту необходимы для большего количества системных ресурсов, так как они должны пересекать границы синхронизации.</span><span class="sxs-lookup"><span data-stu-id="05044-140">However, calls from the creator object to your object require more system resources because they must cross synchronization boundaries.</span></span>

## <a name="related-topics"></a><span data-ttu-id="05044-141">См. также</span><span class="sxs-lookup"><span data-stu-id="05044-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="05044-142">Настройка атрибута синхронизации</span><span class="sxs-lookup"><span data-stu-id="05044-142">Setting the Synchronization Attribute</span></span>](setting-the-synchronization-attribute.md)
</dt> <dt>

[<span data-ttu-id="05044-143">Зависимости синхронизации</span><span class="sxs-lookup"><span data-stu-id="05044-143">Synchronization Dependencies</span></span>](synchronization-dependencies.md)
</dt> </dl>

 

 



