---
description: Доступ к каталогу COM+
ms.assetid: 1322a3fe-faee-4971-949f-5e0d2dfe469b
title: Доступ к каталогу COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f2de7c87da1744e23b384199dce68628fd77d5d
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105682356"
---
# <a name="accessing-the-com-catalog"></a><span data-ttu-id="7665f-103">Доступ к каталогу COM+</span><span class="sxs-lookup"><span data-stu-id="7665f-103">Accessing the COM+ Catalog</span></span>

<span data-ttu-id="7665f-104">Каталог COM+ — это базовое хранилище данных, содержащее все данные конфигурации COM+.</span><span class="sxs-lookup"><span data-stu-id="7665f-104">The COM+ catalog is the underlying data store that holds all COM+ configuration data.</span></span> <span data-ttu-id="7665f-105">Всякий раз, когда вы выполняете администрирование COM+, вы читаете и записываете данные, хранящиеся в каталоге.</span><span class="sxs-lookup"><span data-stu-id="7665f-105">Whenever you do any kind of COM+ administration, you are reading and writing data stored in the catalog.</span></span> <span data-ttu-id="7665f-106">Единственный способ доступа к каталогу — через средство администрирования служб компонентов или через библиотеку Комадмин.</span><span class="sxs-lookup"><span data-stu-id="7665f-106">The only way that you can access the catalog is through the Component Services administrative tool or through the COMAdmin library.</span></span>

<span data-ttu-id="7665f-107">Каталог COM+ предоставляет уровень абстракции по фактическим сведениям о том, где и как хранятся данные конфигурации COM+.</span><span class="sxs-lookup"><span data-stu-id="7665f-107">The COM+ catalog provides a layer of abstraction over the actual details of where and how COM+ configuration data is stored.</span></span> <span data-ttu-id="7665f-108">Большая часть данных хранится в базе данных регистрации COM+ (или Регдб), которая содержит данные для всех настроенных компонентов, установленных в приложениях COM+.</span><span class="sxs-lookup"><span data-stu-id="7665f-108">Much of the data is stored in the COM+ registration database (or RegDB), which holds data for all configured components installed in COM+ applications.</span></span> <span data-ttu-id="7665f-109">Эта база данных используется во время выполнения приложения для предоставления данных конфигурации COM+ для правильной активации объектов в соответствующем контексте, позволяя предоставлять службы для объектов в соответствии с их конфигурацией.</span><span class="sxs-lookup"><span data-stu-id="7665f-109">This database is used at application run time to provide configuration data to COM+ to properly activate objects in an appropriate context, enabling services to be provided for objects per their configuration.</span></span> <span data-ttu-id="7665f-110">Регдб сам представляет собой транзакционный диспетчер ресурсов, использующий транзакции DTC через [компенсирующий диспетчер ресурсов](com--compensating-resource-manager.md). При внесении сохраненных изменений конфигурации они фиксируются в транзакции.</span><span class="sxs-lookup"><span data-stu-id="7665f-110">The RegDB itself is a transacted resource manager that uses DTC transactions through the [compensating resource manager](com--compensating-resource-manager.md); when you make persisted configuration changes, they are committed transactionally.</span></span> <span data-ttu-id="7665f-111">Единственный способ доступа к Регдб — через каталог COM+ с помощью объектов Комадмин или средства администрирования служб компонентов.</span><span class="sxs-lookup"><span data-stu-id="7665f-111">The only way that you can access the RegDB is through the COM+ catalog, using the COMAdmin objects or the Component Services administrative tool.</span></span>

<span data-ttu-id="7665f-112">На каждом компьютере имеется сервер каталога COM+, работающий в качестве компонента системного приложения.</span><span class="sxs-lookup"><span data-stu-id="7665f-112">On each computer, there is a COM+ catalog server running as a component in the system application.</span></span> <span data-ttu-id="7665f-113">Сервер каталога управляет доступом к данным каталога, хранящимся на своем компьютере; по сути, сервер каталога — это механизм запросов, который позволяет считывать и записывать данные в каталоге на этом компьютере.</span><span class="sxs-lookup"><span data-stu-id="7665f-113">The catalog server controls access to the catalog data stored on its machine; in effect, the catalog server is a query engine that allows you to read and write data in the catalog on that machine.</span></span> <span data-ttu-id="7665f-114">При запуске программного администрирования путем создания экземпляра объекта [**комадминкаталог**](comadmincatalog.md) этот объект открывает сеанс с сервером локального каталога.</span><span class="sxs-lookup"><span data-stu-id="7665f-114">When you initiate programmatic administration by instantiating a [**COMAdminCatalog**](comadmincatalog.md) object, this object opens a session with the local catalog server.</span></span> <span data-ttu-id="7665f-115">Запросы коллекций или элементов сбора в локальном каталоге обрабатываются сервером локального каталога.</span><span class="sxs-lookup"><span data-stu-id="7665f-115">Requests for collections or collection items on the local catalog are handled by the local catalog server.</span></span> <span data-ttu-id="7665f-116">При подключении к удаленному компьютеру вы обмениваетесь данными с сервером каталога на этом компьютере.</span><span class="sxs-lookup"><span data-stu-id="7665f-116">When you connect to a remote machine, you are communicating with the catalog server on that machine.</span></span>

## <a name="security-considerations-in-administration"></a><span data-ttu-id="7665f-117">Вопросы безопасности при администрировании</span><span class="sxs-lookup"><span data-stu-id="7665f-117">Security Considerations in Administration</span></span>

<span data-ttu-id="7665f-118">Чтобы изменить данные в каталоге COM+, необходимо иметь полномочия администратора.</span><span class="sxs-lookup"><span data-stu-id="7665f-118">To change data on the COM+ catalog, you need to have authority as an administrator.</span></span> <span data-ttu-id="7665f-119">Чтобы использовать средство администрирования "службы компонентов" для изменения любых данных конфигурации, необходимо быть членом роли "Администраторы", назначенной системному приложению на компьютере, который вы пытаетесь администрировать.</span><span class="sxs-lookup"><span data-stu-id="7665f-119">To use the Component Services administrative tool to change any configuration data, you need to be a member of the Administrators role assigned to the system application on the machine you are trying to administer.</span></span> <span data-ttu-id="7665f-120">Аналогично, чтобы изменить любые данные с помощью объектов Комадмин, ваш код должен быть выполнен с правами администратора.</span><span class="sxs-lookup"><span data-stu-id="7665f-120">Likewise, to change any data by using the COMAdmin objects, your code needs to be running with Administrator authority.</span></span> <span data-ttu-id="7665f-121">Это значит, что приложение или сценарий, использующие объекты Комадмин, должны работать под учетной записью пользователя, назначенной роли "Администраторы" в системном приложении на компьютере, на котором выполняется попытка администрирования.</span><span class="sxs-lookup"><span data-stu-id="7665f-121">That is, an application or script using the COMAdmin objects must be running under a user account that is assigned to the Administrators role on the system application on the machine that it is trying to administer.</span></span> <span data-ttu-id="7665f-122">Приложение может получать доступ к информации каталога и изменять ее только в той степени, в которой у учетной записи, под которой он выполняется, есть полномочия.</span><span class="sxs-lookup"><span data-stu-id="7665f-122">The application can access and change information on the catalog only to the extent that the account under which it is running has that authority.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7665f-123">См. также</span><span class="sxs-lookup"><span data-stu-id="7665f-123">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7665f-124">Общие сведения об объектах Комадмин</span><span class="sxs-lookup"><span data-stu-id="7665f-124">Overview of the COMAdmin Objects</span></span>](overview-of-the-comadmin-objects.md)
</dt> <dt>

[<span data-ttu-id="7665f-125">Сводное описание классов Комадмин</span><span class="sxs-lookup"><span data-stu-id="7665f-125">Summary Description of the COMAdmin Classes</span></span>](summary-description-of-the-comadmin-classes.md)
</dt> </dl>

 

 



