---
description: При использовании безопасности на основе ролей в приложении COM+, которое содержит компонент, у вас есть доступ к программным функциям безопасности из компонента.
ms.assetid: 6117970c-5dbd-485e-978e-3aa96e42b359
title: Безопасность программных компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 31622608e4d4f54aeb53b403b5d8711ff9c6a9af
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105701227"
---
# <a name="programmatic-component-security"></a>Безопасность программных компонентов

При использовании безопасности на основе ролей в приложении COM+, которое содержит компонент, у вас есть доступ к программным функциям безопасности из компонента. Можно проверить членство в роли, чтобы определить, выполняются ли определенные разделы кода, получить доступ к сведениям о безопасности с помощью объекта контекста вызова безопасности, а также определить, включена ли безопасность для текущего вызова. Все эти задачи можно выполнить с помощью ссылки на объект [**секуритикаллконтекст**](securitycallcontext.md) (для приложений Microsoft Visual Basic) или указателя на интерфейс [**исекуритикаллконтекст**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) (для приложений C и Microsoft Visual C++).

Дополнительные сведения о программной безопасности на основе ролей см. в следующих подразделах этого раздела:

-   [Проверка членства в роли](checking-role-membership.md)
-   [Определение того, включена ли безопасность Role-Based](determining-whether-role-based-security-is-enabled.md)
-   [Доступ к сведениям о контексте вызова безопасности](accessing-security-call-context-information.md)

## <a name="impersonation-and-com-security-features"></a>Функции олицетворения и безопасности COM

Если компонент используется в приложении COM+, которое не использует безопасность на основе ролей, сведения о программной проверке ролей и контексте вызова безопасности недоступны. Однако можно использовать программные функции безопасности, предоставляемые COM. Дополнительные сведения см. [в разделе Безопасность в com](/windows/desktop/com/security-in-com).

Хотя большинство функций безопасности, предоставляемых COM, можно использовать, вы не можете вызывать [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) из компонента, который является частью приложения COM+, так как **CoInitializeSecurity** вызывается суррогатом, в котором выполняется приложение COM+. Однако можно вызывать другие функции безопасности, такие как [**кокуериклиентбланкет**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryclientblanket), которые извлекают сведения о клиенте.

В частности, если необходимо использовать удостоверение клиента для доступа к некоторым ресурсам (например, доступ к файлу, защищенному дескриптором безопасности, или распространение удостоверения клиента через базу данных), можно выполнить олицетворение программным способом. Дополнительные сведения о том, когда и как это сделать, см. в разделе [олицетворение и делегирование клиента](client-impersonation-and-delegation.md).

## <a name="testing-security-functionality"></a>Тестирование функций безопасности

Если в компоненте используется программная безопасность COM+, необходимо интегрировать компонент в приложение COM+, когда будете готовы к тестированию функций безопасности компонента. Если компонент, использующий программную безопасность COM+, запускается без интеграции в приложение COM+, будут созданы исключения. Таким образом, если вы хотите убедиться, что такой компонент также может быть успешно интегрирован в приложение, которое не является частью среды COM+, необходимо убедиться, что эти исключения обрабатываются соответствующим образом.

## <a name="documenting-security-requirements"></a>Документирование требований к безопасности

При написании отдельного компонента для приложений COM+, использующих безопасность на основе ролей, необходимо документировать компонент, чтобы обеспечить безопасность при интеграции компонента в приложение COM+. Например, необходимо указать роли, которые необходимо добавить, и объяснить, какие методы и интерфейсы должны быть назначены каждой роли. Кроме того, если вызывается метод, например Искаллеринроле ("говорят"), следует описать функциональные возможности, к которым имеют доступ только средства доступа. Кроме того, необходимо указать, нужна ли роль для защиты доступа ко всему компоненту.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Аутентификация клиента](client-authentication.md)
</dt> <dt>

[Олицетворение и делегирование клиента](client-impersonation-and-delegation.md)
</dt> <dt>

[Безопасность библиотечных приложений](library-application-security.md)
</dt> <dt>

[Многоуровневая защита приложений](multi-tier-application-security.md)
</dt> <dt>

[Администрирование безопасности на основе ролей](role-based-security-administration.md)
</dt> <dt>

[Использование политики ограниченного использования программ в COM+](using-the-software-restriction-policy-in-com-.md)
</dt> </dl>

 

 
