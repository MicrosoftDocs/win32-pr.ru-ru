---
description: В этом разделе обсуждаются альтернативы использованию транзакционного API NTFS (TxF) в общих сценариях использования.
ms.assetid: 9ee26e7e-990e-4cd3-8180-f0fcaac2b752
title: Альтернативы использованию транзакционной NTFS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cc69974f27abfba0323ea4d3f16a720e5e99e69d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105683184"
---
# <a name="alternatives-to-using-transactional-ntfs"></a><span data-ttu-id="34d25-103">Альтернативы использованию транзакционной NTFS</span><span class="sxs-lookup"><span data-stu-id="34d25-103">Alternatives to using Transactional NTFS</span></span>

-   [<span data-ttu-id="34d25-104">Выделяет</span><span class="sxs-lookup"><span data-stu-id="34d25-104">Abstract</span></span>](#abstract)
-   [<span data-ttu-id="34d25-105">Введение</span><span class="sxs-lookup"><span data-stu-id="34d25-105">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="34d25-106">Альтернативы для TxF по сценарию</span><span class="sxs-lookup"><span data-stu-id="34d25-106">Alternatives to TxF by Scenario</span></span>](#alternatives-to-txf-by-scenario)
-   [<span data-ttu-id="34d25-107">Приложения обновляют один файл с данными, подобными документу</span><span class="sxs-lookup"><span data-stu-id="34d25-107">Applications updating a single file with "document-like" data</span></span>](#applications-updating-a-single-file-with-document-like-data)
-   [<span data-ttu-id="34d25-108">Приложения, выполняющие обновление нескольких файлов и (или) в кусте реестра</span><span class="sxs-lookup"><span data-stu-id="34d25-108">Applications performing updates to multiple files and/or to the registry hive</span></span>](#applications-performing-updates-to-multiple-files-andor-to-the-registry-hive)
-   [<span data-ttu-id="34d25-109">Приложения, управляющие набором структурированных данных</span><span class="sxs-lookup"><span data-stu-id="34d25-109">Applications managing a set of structured data</span></span>](#applications-managing-a-set-of-structured-data)
-   [<span data-ttu-id="34d25-110">Приложения с транзакциями, включающими файлы на локальном томе NTFS и таблицах во внешней базе данных SQL</span><span class="sxs-lookup"><span data-stu-id="34d25-110">Applications with Transactions involving files on a local NTFS volume and Tables in an external SQL database</span></span>](#applications-with-transactions-involving-files-on-a-local-ntfs-volume-and-tables-in-an-external-sql-database)
-   [<span data-ttu-id="34d25-111">Закрывается рекомендуемое действие &</span><span class="sxs-lookup"><span data-stu-id="34d25-111">Closing & Recommended Action</span></span>](/windows)

## <a name="abstract"></a><span data-ttu-id="34d25-112">Аннотация</span><span class="sxs-lookup"><span data-stu-id="34d25-112">Abstract</span></span>

<span data-ttu-id="34d25-113">Корпорация Майкрософт настоятельно рекомендует разработчикам исследовать использование обсуждаемых альтернатив (или в некоторых случаях исследовать другие альтернативы) вместо внедрения платформы API, которая может быть недоступна в будущих версиях Windows.</span><span class="sxs-lookup"><span data-stu-id="34d25-113">Microsoft strongly recommends developers investigate utilizing the discussed alternatives (or in some cases, investigate other alternatives) rather than adopting an API platform which may not be available in future versions of Windows.</span></span>

## <a name="introduction"></a><span data-ttu-id="34d25-114">Введение</span><span class="sxs-lookup"><span data-stu-id="34d25-114">Introduction</span></span>

<span data-ttu-id="34d25-115">Система TxF появилась в Windows Vista как средство для появления атомарных файловых транзакций в Windows.</span><span class="sxs-lookup"><span data-stu-id="34d25-115">TxF was introduced with Windows Vista as a means to introduce atomic file transactions to Windows.</span></span> <span data-ttu-id="34d25-116">Он позволяет разработчикам Windows иметь транзакционную атомарность для файловых операций в транзакциях с одним файлом, в транзакциях, включающих несколько файлов, а также в транзакциях, охватывающих несколько источников, таких как реестр (через TxR) и базы данных (например, SQL).</span><span class="sxs-lookup"><span data-stu-id="34d25-116">It allows for Windows developers to have transactional atomicity for file operations in transactions with a single file, in transactions involving multiple files, and in transactions spanning multiple sources – such as the Registry (through TxR), and databases (such as SQL).</span></span> <span data-ttu-id="34d25-117">Несмотря на то, что TxF является мощным набором интерфейсов API, в этой платформе API было чрезвычайно ограниченный интерес разработчика, так как Windows Vista в основном обусловлен ее сложностью и различными нюансами, которые разработчики должны учитывать в процессе разработки приложений.</span><span class="sxs-lookup"><span data-stu-id="34d25-117">While TxF is a powerful set of APIs, there has been extremely limited developer interest in this API platform since Windows Vista primarily due to its complexity and various nuances which developers need to consider as part of application development.</span></span> <span data-ttu-id="34d25-118">В результате корпорация Майкрософт рассматривает нерекомендуемые API TxF в будущей версии Windows, чтобы сконцентрировать усилия на разработке и обслуживании на других функциях и интерфейсах API, которые имеют больше возможностей для большей части клиентов.</span><span class="sxs-lookup"><span data-stu-id="34d25-118">As a result, Microsoft is considering deprecating TxF APIs in a future version of Windows to focus development and maintenance efforts on other features and APIs which have more value to a larger majority of customers.</span></span> <span data-ttu-id="34d25-119">В следующем разделе приводятся примеры альтернативных методов для достижения аналогичных результатов, так как TxF может быть в нескольких типах сценариев приложений.</span><span class="sxs-lookup"><span data-stu-id="34d25-119">The next section describes sample alternative methods to achieve similar results as TxF would for several types of application scenarios.</span></span>

## <a name="alternatives-to-txf-by-scenario"></a><span data-ttu-id="34d25-120">Альтернативы для TxF по сценарию</span><span class="sxs-lookup"><span data-stu-id="34d25-120">Alternatives to TxF by Scenario</span></span>

<span data-ttu-id="34d25-121">С учетом описанных выше ограничений разработчики должны исследовать альтернативы для TxF, чтобы охватить сценарии приложений, которые не соответствуют TxF.</span><span class="sxs-lookup"><span data-stu-id="34d25-121">With the limitations described above, developers should investigate alternatives to TxF to cover application scenarios which are not met by TxF.</span></span> <span data-ttu-id="34d25-122">Здесь описаны некоторые из предлагаемых альтернативных вариантов использования TxF для разработчиков.</span><span class="sxs-lookup"><span data-stu-id="34d25-122">Discussed here are some suggested alternatives to common uses of TxF for developers to consider.</span></span> <span data-ttu-id="34d25-123">Обратите внимание, что этот список не является ни исчерпывающим, ни полным.</span><span class="sxs-lookup"><span data-stu-id="34d25-123">Note that this list is neither exhaustive nor complete.</span></span>

## <a name="applications-updating-a-single-file-with-document-like-data"></a><span data-ttu-id="34d25-124">Приложения обновляют один файл с данными, подобными документу</span><span class="sxs-lookup"><span data-stu-id="34d25-124">Applications updating a single file with "document-like" data</span></span>

<span data-ttu-id="34d25-125">Многие приложения, работающие с данными, сходными с документами, обычно загружают весь документ в память, работают с ним, а затем записывают его обратно, чтобы сохранить изменения.</span><span class="sxs-lookup"><span data-stu-id="34d25-125">Many applications which deal with "document-like" data tend to load the entire document into memory, operate on it, and then write it back out to save the changes.</span></span> <span data-ttu-id="34d25-126">Требуемая Атомарность здесь заключается в том, что изменения либо полностью применены, либо вообще не применяются, так как непротиворечивое состояние приведет к повреждению файла.</span><span class="sxs-lookup"><span data-stu-id="34d25-126">The needed atomicity here is that the changes either are completely applied or not applied at all, as an inconsistent state would render the file corrupt.</span></span> <span data-ttu-id="34d25-127">Обычным подходом является запись документа в новый файл, а затем замена исходного файла на новый.</span><span class="sxs-lookup"><span data-stu-id="34d25-127">A common approach is to write the document to a new file, then replace the original file with the new one.</span></span> <span data-ttu-id="34d25-128">Один из способов сделать это с помощью API [**реплацефиле**](/windows/desktop/api/WinBase/nf-winbase-replacefilea) .</span><span class="sxs-lookup"><span data-stu-id="34d25-128">One method to do this is with the [**ReplaceFile**](/windows/desktop/api/WinBase/nf-winbase-replacefilea) API.</span></span>

## <a name="applications-performing-updates-to-multiple-files-andor-to-the-registry-hive"></a><span data-ttu-id="34d25-129">Приложения, выполняющие обновление нескольких файлов и (или) в кусте реестра</span><span class="sxs-lookup"><span data-stu-id="34d25-129">Applications performing updates to multiple files and/or to the registry hive</span></span>

<span data-ttu-id="34d25-130">Существует множество приложений, которым необходимо выполнить атомарное обновление набора файлов и реестра.</span><span class="sxs-lookup"><span data-stu-id="34d25-130">There are many applications which need to atomically perform an update to a set of files and to the registry.</span></span> <span data-ttu-id="34d25-131">Чаще всего этот сценарий достигается с помощью приложения установщика, такого как установщик Windows.</span><span class="sxs-lookup"><span data-stu-id="34d25-131">This scenario is most commonly achieved through an installer application, such as Windows Installer.</span></span> <span data-ttu-id="34d25-132">Дополнительные сведения о установщик Windows см. в разделе [установщик Windows](/windows/desktop/Msi/windows-installer-portal).</span><span class="sxs-lookup"><span data-stu-id="34d25-132">For more information on Windows Installer, please refer to [Windows Installer](/windows/desktop/Msi/windows-installer-portal).</span></span>

## <a name="applications-managing-a-set-of-structured-data"></a><span data-ttu-id="34d25-133">Приложения, управляющие набором структурированных данных</span><span class="sxs-lookup"><span data-stu-id="34d25-133">Applications managing a set of structured data</span></span>

<span data-ttu-id="34d25-134">Многие приложения управляют некоторым набором собственных структур данных различных типов как средства хранения данных.</span><span class="sxs-lookup"><span data-stu-id="34d25-134">Many applications manage some set of proprietary data structures of varying types as a means to store data.</span></span> <span data-ttu-id="34d25-135">Значительная сложность этих приложений — это процесс поддержания целостности внутренних указателей и ссылок в случае сбоя во время операции обновления.</span><span class="sxs-lookup"><span data-stu-id="34d25-135">A significant challenge for these applications is the process of maintaining the integrity of internal pointers/references if a failure occurs during an update operation.</span></span> <span data-ttu-id="34d25-136">Создание механизма для этого, по крайней мере, является «жесткой проблемой», поэтому большинство приложений полагаются на истинный сервер базы данных для управления набором данных.</span><span class="sxs-lookup"><span data-stu-id="34d25-136">Creating the mechanism for this is indeed a "hard problem", and therefore most applications will rely on a true database server to manage their dataset.</span></span>

<span data-ttu-id="34d25-137">Ниже приведены два предложения по управлению структурированными данными.</span><span class="sxs-lookup"><span data-stu-id="34d25-137">Two suggestions to help manage structured data are:</span></span>

-   <span data-ttu-id="34d25-138">Корпорация Майкрософт предоставляет в Windows папку "Входящие" подсистемы ESE, которая позволяет приложениям выполнять операции обновления и получения данных транзакций.</span><span class="sxs-lookup"><span data-stu-id="34d25-138">Microsoft provides the Extensible Storage Engine (ESE) inbox in Windows to enable applications to perform transacted data update and retrieval operations.</span></span> <span data-ttu-id="34d25-139">Дополнительные сведения о подсистеме расширенного хранилища (ESE) см. в разделе <https://msdn.microsoft.com/library/gg269259.aspx> .</span><span class="sxs-lookup"><span data-stu-id="34d25-139">For more information on the Extensible Storage Engine (ESE), please see <https://msdn.microsoft.com/library/gg269259.aspx>.</span></span>
-   <span data-ttu-id="34d25-140">Для приложений, которым требуется более мощный, надежный и масштабируемый поставщик баз данных, рекомендуется использовать функцию FILESTREAM, доступную в Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="34d25-140">For applications that require a more powerful, robust, and scalable database provider, it is recommended that customers consider using the Filestream feature available with Microsoft SQL Server.</span></span> <span data-ttu-id="34d25-141">Дополнительные сведения о SQL FILESTREAM см. в разделе <https://technet.microsoft.com/library/bb933993.aspx> .</span><span class="sxs-lookup"><span data-stu-id="34d25-141">For more information on SQL Filestreams, please see <https://technet.microsoft.com/library/bb933993.aspx>.</span></span>

## <a name="applications-with-transactions-involving-files-on-a-local-ntfs-volume-and-tables-in-an-external-sql-database"></a><span data-ttu-id="34d25-142">Приложения с транзакциями, включающими файлы на локальном томе NTFS и таблицах во внешней базе данных SQL</span><span class="sxs-lookup"><span data-stu-id="34d25-142">Applications with Transactions involving files on a local NTFS volume and Tables in an external SQL database</span></span>

<span data-ttu-id="34d25-143">Существуют классы приложений, которые либо имеют большие объемы набора данных, либо должны иметь атомарность транзакций в операции, включающей внешнюю базу данных и локальное хранилище.</span><span class="sxs-lookup"><span data-stu-id="34d25-143">There are classes of applications which either have large dataset needs, or need to have transactional atomicity in an operation involving an external database and local storage.</span></span> <span data-ttu-id="34d25-144">В этом сценарии настоятельно рекомендуется, чтобы разработчики рассматривали использование SQL FILESTREAM для выполнения транзакционных файловых операций.</span><span class="sxs-lookup"><span data-stu-id="34d25-144">For this scenario, it is highly recommended that developers consider using SQL Filestreams to perform transactional file operations.</span></span> <span data-ttu-id="34d25-145">Дополнительные сведения о SQL FILESTREAM см. в разделе <https://technet.microsoft.com/library/bb933993.aspx> .</span><span class="sxs-lookup"><span data-stu-id="34d25-145">For more information on SQL Filestreams, please see <https://technet.microsoft.com/library/bb933993.aspx>.</span></span>

## <a name="closing--recommended-action"></a><span data-ttu-id="34d25-146">Закрывается рекомендуемое действие &</span><span class="sxs-lookup"><span data-stu-id="34d25-146">Closing & Recommended Action</span></span>

<span data-ttu-id="34d25-147">TxF — это сложный и набор интерфейсов API, которые обычно не используются сторонними приложениями.</span><span class="sxs-lookup"><span data-stu-id="34d25-147">TxF is a complex and nuanced set of APIs which are not commonly used by 3rd party applications.</span></span> <span data-ttu-id="34d25-148">Благодаря возможности, что эти API могут быть недоступны в будущих версиях Windows, и что существует более простое альтернативное средство для выполнения многих сценариев, для которых была разработана система TxF, корпорация Майкрософт настоятельно рекомендует разработчикам исследовать эти альтернативные средства вместо создания зависимости от TxF в своих приложениях.</span><span class="sxs-lookup"><span data-stu-id="34d25-148">With the possibility that these APIs may not be available in future versions of Windows, and the fact that there are simpler alternative means to achieve many of the scenarios which TxF was developed for, Microsoft strongly recommends developers to investigate those alternative means instead of creating a dependency on TxF in their applications.</span></span>

 

 
