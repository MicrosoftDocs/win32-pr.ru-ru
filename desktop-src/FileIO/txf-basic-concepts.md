---
description: Описывает согласованность с фиксированной нагрузкой, изоляцию с фиксированным чтением и понятия блокировки транзакций в транзакционной NTFS.
ms.assetid: 18579c4a-a832-4c89-8fb1-cd2542e4375e
title: Основные понятия TxF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a7f2f5d0885795f20a8dfb5e0963468ff04bb8e0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104347822"
---
# <a name="basic-txf-concepts"></a>Основные понятия TxF

## <a name="read-isolation"></a>Изоляция чтения

Транзакционная NTFS (TxF) обеспечивает согласованность чтения и фиксации.

[*Транзакционный модуль записи*](glossary.md) ссылается на транзакционный файловый обработчик, Открытый с любым разрешением, которое не является частью универсального доступа для чтения, но является частью универсального доступа на запись. *Транзакционный модуль записи* позволяет просматривать последнюю версию файла, включающую все изменения одной транзакции. Для одного файла может существовать только один транзакционный модуль записи. Модули записи, не поддерживающие транзакции, всегда блокируются транзакционным модулем записи, даже если файл открыт с разрешениями общего доступа на запись.

[*Транзакционный читатель*](glossary.md) ссылается на транзакционный файловый обработчик, Открытый с любым разрешением, которое является частью универсального доступа для чтения, но не является частью универсального доступа на запись. *Транзакционный считыватель* просматривает зафиксированную версию файла, существовавшую на момент открытия этого маркера файла. Транзакционный модуль чтения изолирован от влияния транзакционных модулей записи. Это обеспечивает единообразное представление файла только в течение жизненного цикла обработчика файла и блокирует нетранзакционные модули записи.

> [!Note]  
> При открытии обработчика для изменения с помощью функции [**креатефилетрансактед**](/windows/desktop/api/WinBase/nf-winbase-createfiletransacteda) все последующие открытия файла в этой транзакции записываются независимо от того, преобразуются ли система в транзакционный модуль записи в целях изоляции и другой транзакционной семантики. Это означает, что при открытии обработчика для доступа только для чтения этот обработчик не получает представление файла до начала транзакции. он получает активное представление транзакций файла.

 

Нетранзакционный файловый обработчик не увидит никаких изменений, внесенных в транзакцию, пока транзакция не будет зафиксирована. Нетранзакционный файловый обработчик получает изолированное представление, похожее на транзакционное средство чтения, но в отличие от транзакционного чтения, оно получает обновление файла, когда транзакционный модуль записи фиксирует транзакцию.

## <a name="isolation-levels"></a>Уровни изоляции

TxF обеспечивает изоляцию READ COMMITTED. Это означает, что обновления файлов не видны за пределами транзакции. Кроме того, если файл открывается более одного раза при чтении файлов в рамках транзакции, то при каждом последующем открытии могут отображаться разные результаты. Файлы, которые были доступны при первом обращении к ним, могут быть недоступны (поскольку они были удалены) или наоборот.

## <a name="transactional-locking"></a>Транзакционная блокировка

Создание транзакционного модуля записи в файле *блокирует* файл. После того как файл заблокирован транзакцией, другие операции файловой системы, которые являются внешними для транзакции блокировки, которые пытаются изменить транзакционно заблокированный файл, завершатся сбоем с **\_ \_ нарушением общего доступа к ошибкам** или **\_ \_ конфликтом транзакций с ошибками**.

В следующей таблице приводится сводка блокировок транзакций.



Файл, Открытый в настоящий момент

Предпринята ошибка при открытии файла

С транзакцией

Без транзакции

Читатель

Модуль чтения/записи

Читатель

Модуль чтения/записи

Транзакционное средство чтения

Да

Да

Да

Нет2

Транзакционный поток чтения/записи

Да

Нет2

Да

Нет2

Модуль чтения, не поддерживающий транзакции

Да

Да

Да

Да

Не транзакционный поток чтения/записи

Нет1

Нет1

Да

Да

1. Завершается ошибкой с **\_ \_ конфликтом транзакций**<br/> 2. сбой с **\_ \_ нарушением совместного использования ошибок**<br/>



 

При открытии именованного потока для изменения, которое использует транзакцию, весь файл должен быть заблокирован.

Помимо транзакционной блокировки применяются обычные правила общего доступа к файлам NTFS.

В параллельном режиме необходимо учитывать два следующих режима совместного использования файлов:

-   Режим блокировки транзакций.
-   Нормальные режимы совместного использования файлов.

Какой-либо режим является более узким, который применяется.

 

 




