---
description: Все сведения о файле, включая его размер, дату и время, разрешения и содержимое данных, хранятся либо в записях главной файловой таблицы (MFT), либо в пространстве, расположенном за пределами MFT, которое описывается записями MFT.
ms.assetid: e0933846-278e-4bc8-8982-c5819c252dad
title: Главная таблица файлов (локальные файловые системы)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 260740c03e7b7e4ebe9c7e8ec90035431f6be649
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664422"
---
# <a name="master-file-table-local-file-systems"></a><span data-ttu-id="ed4df-103">Главная таблица файлов (локальные файловые системы)</span><span class="sxs-lookup"><span data-stu-id="ed4df-103">Master File Table (Local File Systems)</span></span>

<span data-ttu-id="ed4df-104">Файловая система NTFS содержит файл с именем *главной таблицы файлов* или MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-104">The NTFS file system contains a file called the *master file table*, or MFT.</span></span> <span data-ttu-id="ed4df-105">Существует по крайней мере одна запись в MFT для каждого файла на томе файловой системы NTFS, включая саму основную таблицу.</span><span class="sxs-lookup"><span data-stu-id="ed4df-105">There is at least one entry in the MFT for every file on an NTFS file system volume, including the MFT itself.</span></span> <span data-ttu-id="ed4df-106">Все сведения о файле, включая его размер, штамп времени и дату, разрешения и содержимое данных, хранятся либо в записях MFT, либо в пространстве, расположенном за пределами MFT, которое описывается записями MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-106">All information about a file, including its size, time and date stamps, permissions, and data content, is stored either in MFT entries, or in space outside the MFT that is described by MFT entries.</span></span>

<span data-ttu-id="ed4df-107">По мере добавления файлов в том файловой системы NTFS в MFT добавляются дополнительные записи, а размер MFT увеличивается.</span><span class="sxs-lookup"><span data-stu-id="ed4df-107">As files are added to an NTFS file system volume, more entries are added to the MFT and the MFT increases in size.</span></span> <span data-ttu-id="ed4df-108">При удалении файлов с тома файловой системы NTFS их записи MFT помечаются как свободные и могут использоваться повторно.</span><span class="sxs-lookup"><span data-stu-id="ed4df-108">When files are deleted from an NTFS file system volume, their MFT entries are marked as free and may be reused.</span></span> <span data-ttu-id="ed4df-109">Однако место на диске, выделенное для этих записей, не перераспределяется, и размер MFT не уменьшается.</span><span class="sxs-lookup"><span data-stu-id="ed4df-109">However, disk space that has been allocated for these entries is not reallocated, and the size of the MFT does not decrease.</span></span>

<span data-ttu-id="ed4df-110">Файловая система NTFS резервирует пространство для MFT, чтобы размер MFT оставался непрерывным по мере роста.</span><span class="sxs-lookup"><span data-stu-id="ed4df-110">The NTFS file system reserves space for the MFT to keep the MFT as contiguous as possible as it grows.</span></span> <span data-ttu-id="ed4df-111">Пространство, зарезервированное файловой системой NTFS для MFT в каждом томе, называется зоной MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-111">The space reserved by the NTFS file system for the MFT in each volume is called the MFT zone.</span></span> <span data-ttu-id="ed4df-112">Пространство для файлов и каталогов также выделяется из этого пространства, но только после выделения всего пространства тома за пределами зоны MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-112">Space for file and directories are also allocated from this space, but only after all of the volume space outside of the MFT zone has been allocated.</span></span>

<span data-ttu-id="ed4df-113">В зависимости от среднего размера файла и других переменных можно выделить зарезервированную зону MFT или незарезервированное пространство на диске, так как диск заполняется емкостью.</span><span class="sxs-lookup"><span data-stu-id="ed4df-113">Depending on the average file size and other variables, either the reserved MFT zone or the unreserved space on the disk may be allocated first as the disk fills to capacity.</span></span> <span data-ttu-id="ed4df-114">Тома с небольшим количеством относительно больших файлов будут выделять незарезервированное пространство первыми, а тома с большим количеством относительно маленьких файлов сначала распределяются по зоне MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-114">Volumes with a small number of relatively large files will allocate the unreserved space first, while volumes with a large number of relatively small files allocate the MFT zone first.</span></span> <span data-ttu-id="ed4df-115">В любом случае фрагментация MFT начинает выполняться, когда один регион или другая выделяется полностью.</span><span class="sxs-lookup"><span data-stu-id="ed4df-115">In either case, fragmentation of the MFT starts to take place when one region or the other becomes fully allocated.</span></span> <span data-ttu-id="ed4df-116">Если незарезервированное пространство полностью выделено, пространство для файлов и каталогов пользователя будет выделено из зоны MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-116">If the unreserved space is completely allocated, space for user files and directories will be allocated from the MFT zone.</span></span> <span data-ttu-id="ed4df-117">Если зона MFT полностью выделена, пространство для новых записей MFT будет выделено из незарезервированного пространства.</span><span class="sxs-lookup"><span data-stu-id="ed4df-117">If the MFT zone is completely allocated, space for new MFT entries will be allocated from the unreserved space.</span></span>

<span data-ttu-id="ed4df-118">Саму таблицу MFT можно дефрагментировать.</span><span class="sxs-lookup"><span data-stu-id="ed4df-118">The MFT itself can be defragmented.</span></span> <span data-ttu-id="ed4df-119">Чтобы снизить вероятность того, что зона MFT будет полностью выделена до завершения процесса дефрагментации, перед дефрагментацией тома оставьте как можно больше пространства в начале зоны MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-119">To reduce the chance of the MFT zone becoming fully allocated before the defragmentation process is complete, leave as much space at the beginning of the MFT zone as possible before defragmenting the volume.</span></span> <span data-ttu-id="ed4df-120">Если зона MFT будет полностью распределена до завершения дефрагментации, то в ней должно быть нераспределенное пространство вне зоны MFT.</span><span class="sxs-lookup"><span data-stu-id="ed4df-120">If the MFT zone becomes fully allocated before defragmentation has completed, there must be unallocated space outside of the MFT zone.</span></span>

<span data-ttu-id="ed4df-121">Зона MFT по умолчанию вычисляется и зарезервирована системой при подключении тома и основывается на размере тома.</span><span class="sxs-lookup"><span data-stu-id="ed4df-121">The default MFT zone is calculated and reserved by the system when it mounts the volume, and is based on volume size.</span></span> <span data-ttu-id="ed4df-122">Вы можете увеличить зону MFT, используя запись реестра, описанную в [статье 174619 базы знаний Майкрософт](https://support.microsoft.com/kb/174619), но нельзя сделать зону MFT по умолчанию меньше вычисляемой.</span><span class="sxs-lookup"><span data-stu-id="ed4df-122">You can increase the MFT zone by means of the registry entry detailed in [Microsoft Knowledge Base Article 174619](https://support.microsoft.com/kb/174619), but you cannot make the default MFT zone smaller than what is calculated.</span></span> <span data-ttu-id="ed4df-123">Увеличение зоны MFT не снижает объем места на диске, который пользователи могут использовать для файлов данных.</span><span class="sxs-lookup"><span data-stu-id="ed4df-123">Increasing the MFT zone does not decrease the disk space that users can use for data files.</span></span>

<span data-ttu-id="ed4df-124">Чтобы определить текущий размер MFT, проанализируйте диск файловой системы NTFS с помощью дефрагментации диска, а затем нажмите кнопку **Просмотреть отчет** .</span><span class="sxs-lookup"><span data-stu-id="ed4df-124">To determine the current size of the MFT, analyze the NTFS file system drive with Disk Defragmenter, then click the **View Report** button.</span></span> <span data-ttu-id="ed4df-125">Отобразится статистика диска, включая текущий размер MFT и число фрагментов.</span><span class="sxs-lookup"><span data-stu-id="ed4df-125">The drive statistics will be displayed, including the current MFT size, and number of fragments.</span></span> <span data-ttu-id="ed4df-126">Размер MFT можно также получить с помощью кода управления [**фсктл \_ получения \_ \_ тома \_ NTFS**](/windows/win32/api/winioctl/ni-winioctl-fsctl_get_ntfs_volume_data) .</span><span class="sxs-lookup"><span data-stu-id="ed4df-126">You can also obtain the size of the MFT by using the [**FSCTL\_GET\_NTFS\_VOLUME\_DATA**](/windows/win32/api/winioctl/ni-winioctl-fsctl_get_ntfs_volume_data) control code.</span></span>

 

 
