---
title: Устранение неполадок приложений
description: В этом разделе приводятся решения распространенных проблем.
ms.assetid: dfdc5a97-aa0a-4011-8f61-6e405e28b6f8
keywords:
- Windows Touch, устранение неполадок приложений
- Windows Touch, отклонение Palm
- отклонение Palm
- Windows Touch, поддержка прежних версий
- Устранение неполадок Windows Touch
- инерция, устранение неполадок приложений
- манипуляции, устранение неполадок приложений
- жесты, устранение неполадок приложений
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 389d200cedc57b7f128a535355b12a9288c6e9eb
ms.sourcegitcommit: 099ecdda1e83618b844387405da0db0ebda93a65
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2021
ms.locfileid: "111443154"
---
# <a name="troubleshooting-applications"></a>Устранение неполадок приложений

В этом разделе приводятся решения распространенных проблем.

## <a name="general-troubleshooting"></a>Общие действия по устранению неполадок



| Категория | Описание |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | Я использую Windows Server 2008, а функции касания Windows не работают.                                                                                                                                                                                                                                       |
| Причина    | Вы не включили возможности рабочего стола.                                                                                                                                                                                                                                                                        |
| Решение | Откройте средство администрирования диспетчер сервера: нажмите кнопку **Пуск**, выберите пункт **Администрирование**, а затем щелкните **Диспетчер сервера**. Щелкните элемент **компоненты** в левом столбце. Щелкните **Добавить компоненты** в разделе **компоненты** . Выберите **возможности рабочего стола**, нажмите кнопку **Далее**, а затем — **установить**. |



 



| Категория | Описание |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | При быстром перемещении пальца по моему приложению появляется стрелка, а жест или манипуляция не регистрируются правильно.                                                             |
| Причина    | Включение жестов, если оно не требуется.                                                                                                                                                      |
| Решение | Вы включили жесты, если хотите отключить их. Сведения об отключении жестов пером см. в статье [устаревшая поддержка панорамирования с помощью полос прокрутки](legacy-support-for-panning-with-scrollbars.md) . |



 



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Проблема</td>
<td>Не удается различить входные данные мыши и сенсорный ввод Windows.</td>
</tr>
<tr class="even">
<td>Причина</td>
<td>Windows создает сообщения мыши для поддержки устаревшей версии, когда пользователь щелкает на экране.</td>
</tr>
<tr class="odd">
<td>Решение</td>
<td>Вы можете вызвать <a href="/windows/win32/api/winuser/nf-winuser-getmessageextrainfo">жетмессажеекстраинфо</a> для <strong>WM_LBUTTONDOWN</strong> и <strong>WM_LBUTTONUP</strong> сообщений, чтобы определить источник. В следующем коде показано, как это можно сделать. <span data-codelanguage="ManagedCPlusPlus"></span>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>C++</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><pre><code>#define MOUSEEVENTF_FROMTOUCH 0xFF515700

if ((GetMessageExtraInfo() & MOUSEEVENTF_FROMTOUCH) == MOUSEEVENTF_FROMTOUCH) { 
    // Click was generated by wisptis / Windows Touch
}else{ 
    // Click was generated by the mouse.
}
</code></pre></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>



 



| Категория | Описание |
|----------|------------------------------------------------------------------------------------|
| Проблема    | Разделы справки запускать приложения Microsoft Пикселсенсе в Windows 7?                       |
| Причина    | Windows Touch и Microsoft Пикселсенсе несовместимы.                           |
| Решение | Необходимо ориентироваться на платформу Windows 7 или платформу Microsoft Пикселсенсе. |



 

## <a name="troubleshooting-manipulations-and-inertia"></a>Устранение неполадок манипуляций и инерции



| Категория | Описание |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | Мое приложение заморозить без причины. Я получаю нарушения прав доступа при инициализации интерфейсов объектов.                                                                                                                                          |
| Причина    | Отсутствие вызова **CoInitialize** при использовании интерфейсов [**IManipulationProcessor**](/windows/desktop/api/manipulations/nn-manipulations-imanipulationprocessor) или [**IInertiaProcessor**](/windows/desktop/api/manipulations/nn-manipulations-iinertiaprocessor) .                                                                                 |
| Решение | Это может быть вызвано созданием объектов модели COM Windows Touch без вызова CoInitialize. Это происходит иногда при преобразовании проектов из использования жестов в использование манипуляций или интерфейсов инерции. |



 



| Категория | Описание |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | При переводе объект неверно вращается. Вращение с одним пальцем работает неправильно.                                                                                                                                                                                                                                                                           |
| Причина    | Неправильное задание сводных значений для объекта.                                                                                                                                                                                                                                                                                                                                                 |
| Решение | Вы не настраиваете точки вращения для манипуляции правильно. Задайте свойства [**пивотпоинткс**](/windows/desktop/api/manipulations/nf-manipulations-imanipulationprocessor-get_pivotpointx) и [**пивотпоинти**](/windows/desktop/api/manipulations/nf-manipulations-imanipulationprocessor-get_pivotpointy) в центре объекта или точки, вокруг которых нужно выполнить поворот, и задайте для свойства [**пивотрадиус**](/windows/desktop/api/manipulations/nf-manipulations-imanipulationprocessor-get_pivotradius) значение Радиус объекта. |



 

## <a name="troubleshooting-windows-touch-input"></a>Устранение неполадок сенсорного ввода Windows



| Категория | Описание |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | После того как я обработал сообщение [**WM \_ Touch**](wm-touchdown.md) , я прекращаю получать отзывы о границе.                                                                                                                                                                                                                                        |
| Причина    | Использование сообщения [**WM \_ Touch**](wm-touchdown.md) без его обработки.                                                                                                                                                                                                                                                           |
| Решение | Возможно, вы используете Windows Touch, не пересылая его в **дефвиндовпрок**, что приведет к непредвиденному поведению. Чтобы получить дополнительные сведения о правильной обработке сообщений [**WM \_ Touch**](wm-touchdown.md) , проверьте [Начало работы с помощью сенсорных сообщений Windows](getting-started-with-multi-touch-messages.md) . |



 



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Проблема</td>
<td>Я рассматриваю Windows. h, но по-прежнему говорит, что <a href="wm-touchdown.md"><strong>WM_TOUCH</strong></a> не определена.</td>
</tr>
<tr class="even">
<td>Причина</td>
<td>Неправильная версия Windows в Targetver. h.</td>
</tr>
<tr class="odd">
<td>Решение</td>
<td>В проекте не задана правильная версия Windows. Следующий код иллюстрирует правильную установку версий Windows для Windows 7. <span data-codelanguage="ManagedCPlusPlus"></span>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>C++</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><pre><code>#ifndef WINVER                  // Specify that the minimum required platform is Windows 7.
#define WINVER 0x0601           
#endif</code></pre></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>



 



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Проблема</td>
<td>Недопустимые координаты x-координат и координаты y сенсорного ввода. Они имеют либо большие значения, чем ожидания, либо отрицательные значения.</td>
</tr>
<tr class="even">
<td>Причина</td>
<td>Может потребоваться преобразовать сенсорные точки в пиксели или преобразовать экранные координаты.</td>
</tr>
<tr class="odd">
<td>Решение</td>
<td>Убедитесь, что вызывается <a href="/windows/desktop/api/winuser/nf-winuser-touch_coord_to_pixel"><strong>TOUCH_COORD_TO_PIXEL</strong></a> и <a href="/windows/desktop/api/winuser/nf-winuser-screentoclient"><strong>скринтоклиент</strong></a>. В следующем примере кода показано, как это сделать: <span data-codelanguage="ManagedCPlusPlus"></span>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>C++</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><pre><code>      POINT ptInput;
      if (GetTouchInputInfo((HTOUCHINPUT)lParam, cInputs, pInputs, sizeof(TOUCHINPUT))){
        for (int i=0; i < static_cast<INT>(cInputs); i++){
          TOUCHINPUT ti = pInputs[i];                       
          if (ti.dwID != 0){                
            // Do something with your touch input handle.
            ptInput.x = TOUCH_COORD_TO_PIXEL(ti.x);
            ptInput.y = TOUCH_COORD_TO_PIXEL(ti.y);
            ScreenToClient(hWnd, &ptInput);
            points[ti.dwID][0] = ptInput.x;
            points[ti.dwID][1] = ptInput.y;
          }
        }
      }</code></pre></td>
</tr>
</tbody>
</table>

<div class="alert">
<blockquote>
[!Note]<br />
Чтобы использовать функцию <a href="/windows/desktop/api/winuser/nf-winuser-screentoclient"><strong>скринтоклиент</strong></a> , в приложении должна быть поддержка высокого разрешения. Дополнительные сведения о поддержке высокого DPI см. в разделе о <a href=" /windows/win32/hidpi/high-dpi-desktop-application-development-on-windows">высоком уровне dpi</a> в MSDN.
</blockquote>
</div>
<div>
 
</div></td>
</tr>
</tbody>
</table>



 



| Категория | Описание |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | Я не вижу сообщений [**WM \_ Touch**](wm-touchdown.md) , но я знаю, что касание Windows работает, так как я вижу сообщения [**\_ жестов WM**](wm-gesture.md) .                                                             |
| Причина    | Отсутствует вызов [**регистертаучвиндов**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow).                                                                                                                                                          |
| Решение | [**WM \_ Сообщения жестов сенсорного ввода**](wm-touchdown.md) и [**WM \_**](wm-gesture.md) являются взаимоисключающими. Если не вызвать [**регистертаучвиндов**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow), будут получены только сообщения **\_ жестов WM** . |



 



| Категория | Описание |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | Я получаю небольшие задержки со времени, когда я касался пальца до получения входных данных в приложении.                                                                                                                                                                                                                                         |
| Причина    | Отклонение Palm вызывает задержки во входных данных.                                                                                                                                                                                                                                                                                                            |
| Решение | Если **ТВФ \_ вантпалм** установлен в вызовах [**регистертаучвиндов**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow), то отклонение Palm включено. Это вызывает небольшую задержку (100 мс), пока программное обеспечение проверит, поступает ли вход с помощью пальца, пера или карманного компьютера пользователя. Отключите отклонение Palm, вызвав **регистертаучвиндов** с установленным флагом **ТВФ \_ вантпалм** . |



 

## <a name="troubleshooting-windows-touch-gestures"></a>Устранение неполадок сенсорных жестов Windows



| Категория | Описание |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | После обработки сообщения [**\_ жеста WM**](wm-gesture.md) я прекращаю получать отзывы о границе. Или жест, который работал ранее, сейчас не работает.                                                                                                                                                                                                                         |
| Причина    | Использование сообщения [**\_ жеста WM**](wm-gesture.md) без его обработки.                                                                                                                                                                                                                                                                                                    |
| Решение | Возможно, вы используете Windows Touch, не пересылая его в [дефвиндовпрок](/windows/win32/api/winuser/nf-winuser-defwindowproca), что приведет к непредвиденному поведению. Дополнительные сведения о правильной обработке сообщений [**\_ жестов WM**](wm-gesture.md) см. в [Начало работы с помощью жестов Windows](getting-started-with-multi-touch-gestures.md) . |



 



| Категория | Описание |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | Я не вижу сообщения [**\_ жестов WM**](wm-gesture.md) , но я знаю, что касание Windows работает, так как я вижу сообщения [**WM \_ Touch**](wm-touchdown.md) .                                                      |
| Причина    | Вызов [**регистертаучвиндов**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow).                                                                                                                                                             |
| Решение | [**WM \_ Сообщения жестов сенсорного ввода**](wm-touchdown.md) и [**WM \_**](wm-gesture.md) являются взаимоисключающими. При вызове [**регистертаучвиндов**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow)вы не получите сообщения **\_ жестов WM** . |



 



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Проблема</td>
<td>Я вижу не все жесты, которые мне хотелось видеть. Например, я вижу жесты с идентификатором <strong>GID_PAN</strong> но не <strong>GID_ROTATE</strong>.</td>
</tr>
<tr class="even">
<td>Причина</td>
<td>Некоторые жесты, такие как жест поворота, по умолчанию отключены.</td>
</tr>
<tr class="odd">
<td>Решение</td>
<td>Необходимо вызвать <a href="/windows/desktop/api/winuser/nf-winuser-setgestureconfig"><strong>сетжестуреконфиг</strong></a> при получении сообщения <a href="wm-gesturenotify.md"><strong>WM_GESTURENOTIFY</strong></a> , как описано в справочнике по <strong>WM_GESTURENOTIFY</strong> , или необходимо добавить обработчик для сообщения <strong>WM_GESTURENOTIFY</strong> . В следующем коде показано, как можно реализовать обработчик, чтобы обеспечить поддержку вращения. <span data-codelanguage="ManagedCPlusPlus"></span>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>C++</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><pre><code>// The message map.
BEGIN_MESSAGE_MAP()
    ON_WM_CREATE()
     ... ... ...
    ON_MESSAGE(WM_GESTURENOTIFY, OnWindowsGestureNotify)
END_MESSAGE_MAP()  

LRESULT CTestWndApp::OnWindowsGestureNotify(
    UINT    uMsg,
    WPARAM  wParam,
    LPARAM  lParam,
    BOOL&   bHandled
    ){
    GESTURECONFIG gc;
    gc.dwID    = GID_ROTATE; // The gesture identifier.
    gc.dwWant  = GC_ROTATE;  // The gesture command you are enabling for GID_ROTATE.
    gc.dwBlock = 0;          // Don&#39;t block anything.
    UINT uiGcs = 1;          // The number of gestures being set.

  BOOL bResult = SetGestureConfig(g_hMainWnd, 0, uiGcs, &gc, sizeof(GESTURECONFIG));
    if(!bResult) {
        // Something went wrong, report the error using your preferred logging.
    }

  return 0;
}  </code></pre></td>
</tr>
</tbody>
</table>

Дополнительные примеры типичных конфигураций жестов см. в разделе <strong>сетжестуреконфиг</strong>.</td>
</tr>
</tbody>
</table>



 



| Категория | Описание |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | Пользовательские полосы прокрутки в приложении не прокручивается при выполнении жеста панорамирования.                                                                                                                                                                                                                                                                                                         |
| Причина    | Отсутствуют обработчики для правильных \_ \* сообщений прокрутки WM.                                                                                                                                                                                                                                                                                                                                            |
| Решение | Вы не обрабатываете все \_ \* сообщения прокрутки WM в настраиваемых полосах прокрутки. Рекомендуется работать с сообщением [**\_ жеста WM**](wm-gesture.md) вместо того, чтобы хранить пользовательские функции прокрутки с помощью устаревшей поддержки. Необходимо поддерживать сообщения, как описано в разделе [поддержка панорамирования с помощью полос прокрутки](legacy-support-for-panning-with-scrollbars.md). |



 



| Категория | Описание |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Проблема    | Я получаю задержки для жестов.                                                                                                                                                                                                                               |
| Причина    | Жесты могут вызывать задержки для жестов.                                                                                                                                                                                                                      |
| Решение | Жесты могут вызвать задержки в течение времени, затрачиваемого приложением на получение сообщений [**\_ жестов WM**](wm-gesture.md) . Сведения об отключении жестов см. в статье [устаревшая поддержка панорамирования с помощью полос прокрутки](legacy-support-for-panning-with-scrollbars.md) . |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Руководство по программированию](programming-guide.md)
</dt> </dl>

 

 