---
description: Основы DMO
ms.assetid: eaf453d2-69f8-432a-8a58-1ed70778f182
title: Основы DMO (Microsoft Media Foundation)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44b1aca2fcd7e70cf78e2e95135aee73c454b910
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104262791"
---
# <a name="dmo-basics-microsoft-media-foundation"></a><span data-ttu-id="1bb4f-103">Основы DMO (Microsoft Media Foundation)</span><span class="sxs-lookup"><span data-stu-id="1bb4f-103">DMO Basics (Microsoft Media Foundation)</span></span>

<span data-ttu-id="1bb4f-104">Этот раздел содержит краткий обзор дмос, связанных с кодеками Windows Media.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-104">This topic provides a brief overview of DMOs as they relate to Windows Media Codecs.</span></span> <span data-ttu-id="1bb4f-105">Дополнительные сведения о дмос см. в разделе [DirectX Media Objects](../directshow/directx-media-objects.md).</span><span class="sxs-lookup"><span data-stu-id="1bb4f-105">For more information about DMOs, see [DirectX Media Objects](../directshow/directx-media-objects.md).</span></span>

<span data-ttu-id="1bb4f-106">DMO — это COM-объект, который преобразует данные.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-106">A DMO is a COM object that transforms data.</span></span> <span data-ttu-id="1bb4f-107">В него передаются данные и возвращаются преобразованные данные.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-107">You pass data to it, and it returns the transformed data.</span></span> <span data-ttu-id="1bb4f-108">В случае с кодировщиком кодеков DMO вы задаете несжатые данные мультимедиа, и DMO предоставляет сжатые данные мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-108">In the case of a codec encoder DMO, you input uncompressed media data and the DMO delivers compressed media data.</span></span> <span data-ttu-id="1bb4f-109">Основное преимущество использования дмос заключается в том, что все они реализуют один и тот же базовый интерфейс, [**имедиаобжект**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject), который упрощает работу с ними, поскольку можно использовать один и тот же объект независимо от типа выполняемого преобразования.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-109">The primary advantage of using DMOs is that they all implement the same base interface, [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject), which simplifies working with them because you can use the same object, regardless of the type of transformation being performed.</span></span>

<span data-ttu-id="1bb4f-110">Поскольку существуют переменные, участвующие в любом преобразовании данных, преобразование аудио и видео должно учитывать широкий спектр возможных конфигураций носителей.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-110">Because there are variables involved in any sort of data transformation, audio and video transformation must take into account the wide range of possible media configurations.</span></span> <span data-ttu-id="1bb4f-111">Видеокодеки Windows Media Audio и Video также поддерживают ряд специальных функций, которые необходимо настроить с помощью DMO.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-111">The Windows Media Audio and Video codecs also support a number of special features that you must be able to configure by using the DMO.</span></span>

<span data-ttu-id="1bb4f-112">Как правило, сведения о переменных, необходимые кодеку дмос для сжатия и распаковки цифровых носителей, передаются одним из трех способов:</span><span class="sxs-lookup"><span data-stu-id="1bb4f-112">In general, the variable information that is needed by the codec DMOs to compress and decompress digital media is conveyed in one of three ways:</span></span>

-   <span data-ttu-id="1bb4f-113">Задайте тип входных данных для DMO, чтобы передать характеристики несжатого носителя, передаваемого кодировщику DMO, и характеристики сжатого носителя, передаваемого декодеру DMO.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-113">Set the input type on the DMO to convey the characteristics of the uncompressed media that you pass to an encoder DMO, and the characteristics of the compressed media that you pass to a decoder DMO.</span></span>
-   <span data-ttu-id="1bb4f-114">Задайте тип выходных данных для DMO, чтобы передать характеристики сжатого носителя, который доставляется кодировщиком DMO, и характеристики несжатого носителя, которые доставляются декодером DMO.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-114">Set the output type on the DMO to convey the characteristics of the compressed media that are delivered by an encoder DMO, and the characteristics of the uncompressed media that are delivered by a decoder DMO.</span></span>
-   <span data-ttu-id="1bb4f-115">С помощью методов интерфейса **ипропертибаг** настройте другие параметры, которые поддерживают различные функции кодека дмос как свойства.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-115">Using the methods of the **IPropertyBag** interface, configure other settings that support the various features of the codec DMOs as properties.</span></span> <span data-ttu-id="1bb4f-116">**Ипропертибаг** — это стандартный COM-интерфейс, поддерживаемый всеми кодеками дмос.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-116">**IPropertyBag** is a standard COM interface that is supported by all of the codec DMOs.</span></span>

<span data-ttu-id="1bb4f-117">Кроме того, некоторые функции кодека управляются с помощью других интерфейсов, характерных для кодека дмос.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-117">Additionally, some codec features are managed by using other interfaces that are specific to the codec DMOs.</span></span> <span data-ttu-id="1bb4f-118">Эти интерфейсы перечислены для каждого кодека в разделе [объекты кодека](codecobjects.md).</span><span class="sxs-lookup"><span data-stu-id="1bb4f-118">These interfaces are listed for each codec in the section [Codec Objects](codecobjects.md).</span></span>

<span data-ttu-id="1bb4f-119">Типы входных и выходных данных относятся только к входным и выходным потокам.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-119">Input and output types are specific to input and output streams.</span></span> <span data-ttu-id="1bb4f-120">Каждый поток представляет отдельное представление содержимого.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-120">Each stream represents a discrete representation of the content.</span></span> <span data-ttu-id="1bb4f-121">Например, у DMO кодировщика видео Windows Media есть один входной поток и два выходных потока.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-121">For example, the Windows Media Video encoder DMO has a single input stream, and two output streams.</span></span> <span data-ttu-id="1bb4f-122">Входной поток принимает несжатые видео образцы.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-122">The input stream accepts uncompressed video samples.</span></span> <span data-ttu-id="1bb4f-123">Первый из двух выходных потоков предоставляет сжатые образцы. другой предоставляет несжатые образцы.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-123">The first of the two output streams delivers compressed samples; the other provides uncompressed samples.</span></span> <span data-ttu-id="1bb4f-124">Отдельные выборки в одном потоке вывода представляют то же содержимое, что и соответствующие образцы в другом потоке, но каждый поток доставляет эти примеры в другом формате.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-124">The individual samples in one output stream represent the same content as the corresponding samples in the other stream, but each stream delivers those samples in a different format.</span></span>

<span data-ttu-id="1bb4f-125">Каждый поток (входящий или исходящий) поддерживает один или несколько типов носителей.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-125">Each stream (input or output) supports one or more types of media.</span></span> <span data-ttu-id="1bb4f-126">Тип мультимедиа (или формат) описывается структурой [**\_ \_ типа мультимедиа DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) .</span><span class="sxs-lookup"><span data-stu-id="1bb4f-126">A media type, or format, is described by a [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure.</span></span> <span data-ttu-id="1bb4f-127">Можно выполнить запрос к DMO для типов, поддерживаемых выходным потоком, вызвав [**имедиаобжект:: жетаутпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getoutputtype).</span><span class="sxs-lookup"><span data-stu-id="1bb4f-127">You can query the DMO for the types that are supported by an output stream by calling [**IMediaObject::GetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getoutputtype).</span></span> <span data-ttu-id="1bb4f-128">Этот метод возвращает допустимую (хотя в некоторых случаях частично неполное) тип вывода для этого потока.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-128">This method returns a valid (though in some cases partially incomplete) output type for that stream.</span></span> <span data-ttu-id="1bb4f-129">Вы можете перечислить Поддерживаемые типы носителей для выходного потока, сделав повторные вызовы к **жетаутпуттипе**, увеличивая параметр типа при каждом вызове.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-129">You can enumerate the supported media types for an output stream by making repeated calls to **GetOutputType**, incrementing the type parameter with each call.</span></span> <span data-ttu-id="1bb4f-130">Если передаваемый индекс типа выходит за пределы допустимого диапазона, метод возвращает **DMO, \_ а \_ не \_ больше \_ элементов**.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-130">When the type index that you pass is out of bounds, the method returns **DMO\_E\_NO\_MORE\_ITEMS**.</span></span> <span data-ttu-id="1bb4f-131">Форматы входных данных можно перечислить аналогичным образом с помощью метода [**имедиаобжект:: жетинпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getinputtype) .</span><span class="sxs-lookup"><span data-stu-id="1bb4f-131">Input formats can be enumerated in the same way by using the [**IMediaObject::GetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getinputtype) method.</span></span>

<span data-ttu-id="1bb4f-132">Типы, перечисленные DMO, — это только "предпочтительные" типы, однако могут поддерживаться другие типы.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-132">The types that are enumerated by the DMO are only the "preferred" types, however, other types may be supported.</span></span> <span data-ttu-id="1bb4f-133">Тип выходных данных можно проверить путем вызова [**имедиаобжект:: сетаутпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="1bb4f-133">You can validate an output type by calling [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span></span> <span data-ttu-id="1bb4f-134">Для проверки входного типа используйте [**имедиаобжект:: сетинпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) .</span><span class="sxs-lookup"><span data-stu-id="1bb4f-134">Use [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) to validate an input type.</span></span> <span data-ttu-id="1bb4f-135">Оба метода возвращают **\_ тип DMO \_ E \_ не \_ принимается** , если переданная структура [**\_ \_ типа мультимедиа DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) является недопустимой.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-135">Both methods will return **DMO\_E\_TYPE\_NOT\_ACCEPTED** if the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure you passed is invalid.</span></span> <span data-ttu-id="1bb4f-136">Некоторые дмос перед перечислением входных типов должны задать тип вывода.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-136">Some DMOs require you to set an output type before enumerating any input types.</span></span> <span data-ttu-id="1bb4f-137">Звуковые и видеокодеки Windows Media дмос все имеют входные и выходные данные, которые имеют зависимость от проверки.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-137">The Windows Media Audio and Video codec DMOs all have inputs and outputs that have interdependent validation.</span></span> <span data-ttu-id="1bb4f-138">То есть заданный тип выходных данных будет задавать условия проверки для типа входных данных.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-138">That is, the output type you set will set the validation criteria for the input type.</span></span> <span data-ttu-id="1bb4f-139">Существуют также некоторые свойства, которые при установке изменяют допустимые типы входных и выходных данных.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-139">There are also some properties that, when set, alter the valid input and output types.</span></span> <span data-ttu-id="1bb4f-140">По этой причине перед перечислением типов необходимо задать все необходимые свойства в DMO.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-140">For this reason, you should set all of the desired properties on the DMO before enumerating types.</span></span>

<span data-ttu-id="1bb4f-141">Если для DMO заданы типы выходных данных и входных данных, можно начать обработку образцов.</span><span class="sxs-lookup"><span data-stu-id="1bb4f-141">When you have set the output and input types for the DMO, you can begin processing samples.</span></span> <span data-ttu-id="1bb4f-142">Каждый входной образец передается в кодек с помощью вызова [**имедиаобжект::P роцессинпут**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput), а каждый выходной пример доставляется кодеком при вызове [**Имедиаобжект::P роцессаутпут**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput).</span><span class="sxs-lookup"><span data-stu-id="1bb4f-142">Each input sample is passed to the codec using a call to [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput), and each output sample is delivered by the codec when you make a call to [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1bb4f-143">См. также</span><span class="sxs-lookup"><span data-stu-id="1bb4f-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1bb4f-144">Работа с кодеками дмос</span><span class="sxs-lookup"><span data-stu-id="1bb4f-144">Working with Codec DMOs</span></span>](workingwithcodecdmos.md)
</dt> </dl>

 

 
