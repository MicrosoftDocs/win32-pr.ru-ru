---
description: Если вы не знакомы с цифровыми носителями, в этом разделе рассматриваются некоторые понятия, которые необходимо знать перед написанием Media Foundation приложения.
ms.assetid: d76d655e-23f3-407c-97a1-be015b0de37d
title: 'Media Foundation: основные понятия'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0298a20518df91dab4439770e0f1193802969ae8
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "104424110"
---
# <a name="media-foundation-essential-concepts"></a><span data-ttu-id="22bf4-103">Media Foundation: основные понятия</span><span class="sxs-lookup"><span data-stu-id="22bf4-103">Media Foundation: Essential Concepts</span></span>

<span data-ttu-id="22bf4-104">Если вы не знакомы с цифровыми носителями, в этом разделе рассматриваются некоторые понятия, которые необходимо знать перед написанием Media Foundation приложения.</span><span class="sxs-lookup"><span data-stu-id="22bf4-104">If you are new to digital media, this topic introduces some concepts that you will need to understand before writing a Media Foundation application.</span></span>

-   [<span data-ttu-id="22bf4-105">Потоки</span><span class="sxs-lookup"><span data-stu-id="22bf4-105">Streams</span></span>](#streams)
-   [<span data-ttu-id="22bf4-106">Сжатие</span><span class="sxs-lookup"><span data-stu-id="22bf4-106">Compression</span></span>](#compression)
-   [<span data-ttu-id="22bf4-107">Контейнеры мультимедиа</span><span class="sxs-lookup"><span data-stu-id="22bf4-107">Media Containers</span></span>](#media-containers)
-   [<span data-ttu-id="22bf4-108">Форматы</span><span class="sxs-lookup"><span data-stu-id="22bf4-108">Formats</span></span>](#formats)
-   [<span data-ttu-id="22bf4-109">См. также</span><span class="sxs-lookup"><span data-stu-id="22bf4-109">Related topics</span></span>](#related-topics)

## <a name="streams"></a><span data-ttu-id="22bf4-110">Потоки</span><span class="sxs-lookup"><span data-stu-id="22bf4-110">Streams</span></span>

<span data-ttu-id="22bf4-111">*Поток* — это последовательность данных мультимедиа с равномерным типом.</span><span class="sxs-lookup"><span data-stu-id="22bf4-111">A *stream* is a sequence of media data with a uniform type.</span></span> <span data-ttu-id="22bf4-112">Наиболее распространенными типами являются аудио и видео, но поток может содержать почти любые данные, включая текст, команды сценариев и все еще изображения.</span><span class="sxs-lookup"><span data-stu-id="22bf4-112">The most common types are audio and video, but a stream can contain almost any kind of data, including text, script commands, and still images.</span></span> <span data-ttu-id="22bf4-113">Термин *поток* в этой документации не подразумевает доставку по сети.</span><span class="sxs-lookup"><span data-stu-id="22bf4-113">The term *stream* in this documentation does not imply delivery over a network.</span></span> <span data-ttu-id="22bf4-114">Файл мультимедиа, предназначенный для локального воспроизведения, также содержит потоки.</span><span class="sxs-lookup"><span data-stu-id="22bf4-114">A media file intended for local playback also contains streams.</span></span>

<span data-ttu-id="22bf4-115">Как правило, файл мультимедиа содержит либо один аудиопоток, либо только один поток видео и один звуковой поток.</span><span class="sxs-lookup"><span data-stu-id="22bf4-115">Usually, a media file contains either a single audio stream, or exactly one video stream and one audio stream.</span></span> <span data-ttu-id="22bf4-116">Однако файл мультимедиа может содержать несколько потоков одного типа.</span><span class="sxs-lookup"><span data-stu-id="22bf4-116">However, a media file might contain several streams of the same type.</span></span> <span data-ttu-id="22bf4-117">Например, видеофайл может содержать звуковые потоки на нескольких разных языках.</span><span class="sxs-lookup"><span data-stu-id="22bf4-117">For example, a video file might contain audio streams in several different languages.</span></span> <span data-ttu-id="22bf4-118">Во время выполнения приложение выбирает используемый поток.</span><span class="sxs-lookup"><span data-stu-id="22bf4-118">At run time, the application would select which stream to use.</span></span>

## <a name="compression"></a><span data-ttu-id="22bf4-119">Сжатие</span><span class="sxs-lookup"><span data-stu-id="22bf4-119">Compression</span></span>

<span data-ttu-id="22bf4-120">*Сжатие* относится к любому процессу, который уменьшает размер потока данных за счет удаления избыточных данных.</span><span class="sxs-lookup"><span data-stu-id="22bf4-120">*Compression* refers to any process that reduces the size of a data stream by removing redundant information.</span></span> <span data-ttu-id="22bf4-121">Алгоритмы сжатия делятся на две основные категории:</span><span class="sxs-lookup"><span data-stu-id="22bf4-121">Compression algorithms fall into two broad categories:</span></span>

-   <span data-ttu-id="22bf4-122">Сжатие *без потерь* .</span><span class="sxs-lookup"><span data-stu-id="22bf4-122">*Lossless* compression.</span></span> <span data-ttu-id="22bf4-123">При использовании алгоритма без потерь перестроенные данные идентичны исходным.</span><span class="sxs-lookup"><span data-stu-id="22bf4-123">Using a lossless algorithm, the reconstructed data is identical to the original.</span></span>
-   <span data-ttu-id="22bf4-124">Сжатие с *потерей* данных.</span><span class="sxs-lookup"><span data-stu-id="22bf4-124">*Lossy* compression.</span></span> <span data-ttu-id="22bf4-125">При использовании алгоритма потери данных перестроенные данные являются приближением исходного, но не является точным соответствием.</span><span class="sxs-lookup"><span data-stu-id="22bf4-125">Using a lossy algorithm, the reconstructed data is an approximation of the original, but is not an exact match.</span></span>

<span data-ttu-id="22bf4-126">В большинстве других доменов сжатие с потерей данных неприемлемо.</span><span class="sxs-lookup"><span data-stu-id="22bf4-126">In most other domains, lossy compression is not acceptable.</span></span> <span data-ttu-id="22bf4-127">(Представьте, что вы получаете «приближение» к электронной таблице!) Но схемы сжатия с потерей данных хорошо подходят для аудио и видео по нескольким причинам.</span><span class="sxs-lookup"><span data-stu-id="22bf4-127">(Imagine getting back an "approximation" of a spreadsheet!) But lossy compression schemes are well-suited to audio and video, for a couple of reasons.</span></span>

<span data-ttu-id="22bf4-128">Первая причина заключается в том, что необходимо сделать с физикой человеческого восприятия.</span><span class="sxs-lookup"><span data-stu-id="22bf4-128">The first reason has to do with the physics of human perception.</span></span> <span data-ttu-id="22bf4-129">При прослушивании сложного звука, например записи музыки, некоторые сведения, содержащиеся в этом звуке, не являются ощутимыми.</span><span class="sxs-lookup"><span data-stu-id="22bf4-129">When we listen to a complex sound, like a music recording, some of the information contained in that sound is not perceptible to the ear.</span></span> <span data-ttu-id="22bf4-130">С помощью теории обработки сигнала можно анализировать и разделять частоты, которые не могут быть воспринимаемы.</span><span class="sxs-lookup"><span data-stu-id="22bf4-130">With the help of signal processing theory, it is possible to analyze and separate the frequencies that cannot be perceived.</span></span> <span data-ttu-id="22bf4-131">Эти частоты можно удалить без искусственного.</span><span class="sxs-lookup"><span data-stu-id="22bf4-131">These frequencies can be removed with no perceptual effect.</span></span> <span data-ttu-id="22bf4-132">Несмотря на то, что воссозданное аудио не соответствует исходному в точности, оно будет *звучать* так же, как и прослушиватель.</span><span class="sxs-lookup"><span data-stu-id="22bf4-132">Although the reconstructed audio will not match the original exactly, it will *sound* the same to the listener.</span></span> <span data-ttu-id="22bf4-133">Аналогичные принципы применимы к видео.</span><span class="sxs-lookup"><span data-stu-id="22bf4-133">Similar principles apply to video.</span></span>

<span data-ttu-id="22bf4-134">Во вторых, качество звука или изображения может быть приемлемым, в зависимости от предполагаемой цели.</span><span class="sxs-lookup"><span data-stu-id="22bf4-134">Second, some degradation in sound or image quality may be acceptable, depending on the intended purpose.</span></span> <span data-ttu-id="22bf4-135">Например, в телефонии звук часто сильно сжимается.</span><span class="sxs-lookup"><span data-stu-id="22bf4-135">In telephony, for example, audio is often highly compressed.</span></span> <span data-ttu-id="22bf4-136">Результат является достаточно хорошим для общения с телефоном, но вы не хотите ожидать Symphony оркестре по телефону.</span><span class="sxs-lookup"><span data-stu-id="22bf4-136">The result is good enough for a phone conversation—but you wouldn't want to listen to a symphony orchestra over a telephone.</span></span>

<span data-ttu-id="22bf4-137">Сжатие также называется *кодированием*, а устройство, закодированное, называется *кодировщиком*.</span><span class="sxs-lookup"><span data-stu-id="22bf4-137">Compression is also called *encoding*, and a device that encodes is called an *encoder*.</span></span> <span data-ttu-id="22bf4-138">Обратный процесс *декодируется*, и устройство является естественным названием *декодера*.</span><span class="sxs-lookup"><span data-stu-id="22bf4-138">The reverse process is *decoding*, and the device is a naturally called a *decoder*.</span></span> <span data-ttu-id="22bf4-139">Общим термином для кодировщиков и декодеров является *кодек*.</span><span class="sxs-lookup"><span data-stu-id="22bf4-139">The general term for both encoders and decoders is *codec*.</span></span> <span data-ttu-id="22bf4-140">Кодеки могут быть реализованы в аппаратном или программном обеспечении.</span><span class="sxs-lookup"><span data-stu-id="22bf4-140">Codecs can be implemented in hardware or software.</span></span>

<span data-ttu-id="22bf4-141">Технология сжатия быстро изменилась с момента появления цифрового мультимедиа, и в настоящее время используется большое количество схем сжатия.</span><span class="sxs-lookup"><span data-stu-id="22bf4-141">Compression technology has changed rapidly since the advent of digital media, and a large number of compression schemes are in use today.</span></span> <span data-ttu-id="22bf4-142">Это одна из основных задач для программирования цифрового носителя.</span><span class="sxs-lookup"><span data-stu-id="22bf4-142">This fact is one of the main challenges for digital media programming.</span></span>

## <a name="media-containers"></a><span data-ttu-id="22bf4-143">Контейнеры мультимедиа</span><span class="sxs-lookup"><span data-stu-id="22bf4-143">Media Containers</span></span>

<span data-ttu-id="22bf4-144">В редких случаях хранение необработанного аудио-или видеопотока в виде файла компьютера или отправка его напрямую по сети.</span><span class="sxs-lookup"><span data-stu-id="22bf4-144">It is rare to store a raw audio or video stream as a computer file, or to send one directly over the network.</span></span> <span data-ttu-id="22bf4-145">В одном случае было бы невозможно декодировать такой поток, не зная заранее, какой кодек использовать.</span><span class="sxs-lookup"><span data-stu-id="22bf4-145">For one thing, it would be impossible to decode such a stream, without knowing in advance which codec to use.</span></span> <span data-ttu-id="22bf4-146">Таким образом, файлы мультимедиа обычно содержат по крайней мере некоторые из следующих элементов:</span><span class="sxs-lookup"><span data-stu-id="22bf4-146">Therefore, media files usually contain at least some of the following elements:</span></span>

-   <span data-ttu-id="22bf4-147">Заголовки файлов, описывающие количество потоков, формат каждого потока и т. д.</span><span class="sxs-lookup"><span data-stu-id="22bf4-147">File headers that describe the number of streams, the format of each stream, and so on.</span></span>
-   <span data-ttu-id="22bf4-148">Индекс, который обеспечивает произвольный доступ к содержимому.</span><span class="sxs-lookup"><span data-stu-id="22bf4-148">An index that enables random access to the content.</span></span>
-   <span data-ttu-id="22bf4-149">Метаданные, описывающие содержимое (например, исполнитель или заголовок).</span><span class="sxs-lookup"><span data-stu-id="22bf4-149">Metadata that describes the content (for example, the artist or title).</span></span>
-   <span data-ttu-id="22bf4-150">Заголовки пакетов, чтобы включить передачу по сети или произвольный доступ.</span><span class="sxs-lookup"><span data-stu-id="22bf4-150">Packet headers, to enable network transmission or random access.</span></span>

<span data-ttu-id="22bf4-151">В этой документации термин *контейнер* используется для описания всего пакета потоков, заголовков, индексов, метаданных и т. д.</span><span class="sxs-lookup"><span data-stu-id="22bf4-151">This documentation uses the term *container* to describe the entire package of streams, headers, indexes, metadata, and so forth.</span></span> <span data-ttu-id="22bf4-152">Причиной использования термина *контейнер* , а не *файла* является то, что некоторые форматы контейнеров предназначены для вещания в реальном времени.</span><span class="sxs-lookup"><span data-stu-id="22bf4-152">The reason for using the term *container* rather than *file* is that some container formats are designed for live broadcast.</span></span> <span data-ttu-id="22bf4-153">Приложение может создать контейнер в режиме реального времени, никогда не сохраняя его в файле.</span><span class="sxs-lookup"><span data-stu-id="22bf4-153">An application could generate the container in real time, never storing it to a file.</span></span>

<span data-ttu-id="22bf4-154">Ранний пример контейнера мультимедиа — это формат AVI-файла.</span><span class="sxs-lookup"><span data-stu-id="22bf4-154">An early example of a media container is the AVI file format.</span></span> <span data-ttu-id="22bf4-155">К другим примерам относятся MP4 и расширенный системный формат (ASF).</span><span class="sxs-lookup"><span data-stu-id="22bf4-155">Other examples include MP4 and Advanced Systems Format (ASF).</span></span> <span data-ttu-id="22bf4-156">Контейнеры можно идентифицировать по расширению имени файла (например, MP4) или по типу MIME.</span><span class="sxs-lookup"><span data-stu-id="22bf4-156">Containers can be identified by file name extension (for example, .mp4) or by MIME type.</span></span>

<span data-ttu-id="22bf4-157">На следующей диаграмме показана типичная структура для контейнера мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="22bf4-157">The following diagram shows a typical structure for a media container.</span></span> <span data-ttu-id="22bf4-158">Схема не представляет никакой конкретный формат. сведения о каждом формате могут сильно различаться.</span><span class="sxs-lookup"><span data-stu-id="22bf4-158">The diagram does not represent any specific format; the details of each format vary widely.</span></span>

![Схема, показывающая типичный контейнер мультимедиа](images/concepts01.png)

<span data-ttu-id="22bf4-160">Обратите внимание, что структура, показанная на диаграмме, является иерархической, а сведения о заголовке появляются в начале контейнера.</span><span class="sxs-lookup"><span data-stu-id="22bf4-160">Notice that the structure shown in the diagram is hierarchical, with header information appearing at the start of the container.</span></span> <span data-ttu-id="22bf4-161">Эта структура обычно имеет много (но не все) форматов контейнеров.</span><span class="sxs-lookup"><span data-stu-id="22bf4-161">This structure is typical of many (but not all) container formats.</span></span> <span data-ttu-id="22bf4-162">Также обратите внимание, что в разделе данных содержатся пакеты аудио и видео с чередованием.</span><span class="sxs-lookup"><span data-stu-id="22bf4-162">Also notice that the data section contains interleaved audio and video packets.</span></span> <span data-ttu-id="22bf4-163">Этот тип использования часто встречается в контейнерах мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="22bf4-163">This type of interleaving is common in media containers.</span></span>

<span data-ttu-id="22bf4-164">Термин " *мультиплексирование* " относится к процессу паккетизинг потоков аудио и видео и покидает пакеты в контейнер.</span><span class="sxs-lookup"><span data-stu-id="22bf4-164">The term *multiplexing* refers to the process of packetizing the audio and video streams and interleaving the packets into the container.</span></span> <span data-ttu-id="22bf4-165">Обратный процесс, при котором выполняется сборка потоков из пакетных данных, называется *демультиплексированием*.</span><span class="sxs-lookup"><span data-stu-id="22bf4-165">The reverse process, reassembling the streams from the packetized data, is called *demultiplexing*.</span></span>

## <a name="formats"></a><span data-ttu-id="22bf4-166">Форматы</span><span class="sxs-lookup"><span data-stu-id="22bf4-166">Formats</span></span>

<span data-ttu-id="22bf4-167">В цифровом носителе термин *Формат* неоднозначна.</span><span class="sxs-lookup"><span data-stu-id="22bf4-167">In digital media, the term *format* is ambiguous.</span></span> <span data-ttu-id="22bf4-168">Формат может ссылаться на тип *кодировки*, например H. 264 Video или *контейнер*, например MP4.</span><span class="sxs-lookup"><span data-stu-id="22bf4-168">A format can refer to the type of *encoding*, such as H.264 video, or the *container*, such as MP4.</span></span> <span data-ttu-id="22bf4-169">Это различие часто вызывает путаницу для обычных пользователей.</span><span class="sxs-lookup"><span data-stu-id="22bf4-169">This distinction is often confusing for ordinary users.</span></span> <span data-ttu-id="22bf4-170">Имена, предоставленные форматам мультимедиа, не всегда помогают.</span><span class="sxs-lookup"><span data-stu-id="22bf4-170">The names given to media formats do not always help.</span></span> <span data-ttu-id="22bf4-171">Например, *MP3* ссылается как на формат кодирования (звуковой слой MPEG-1 3), так и на формат файла.</span><span class="sxs-lookup"><span data-stu-id="22bf4-171">For example, *MP3* refers both to an encoding format (MPEG-1 Audio Layer 3) and a file format.</span></span>

<span data-ttu-id="22bf4-172">Различие очень важно, так как чтение файла мультимедиа фактически состоит из двух этапов:</span><span class="sxs-lookup"><span data-stu-id="22bf4-172">The distinction is important, however, because reading a media file actually involves two stages:</span></span>

1.  <span data-ttu-id="22bf4-173">Сначала необходимо выполнить синтаксический анализ контейнера.</span><span class="sxs-lookup"><span data-stu-id="22bf4-173">First, the container must be parsed.</span></span> <span data-ttu-id="22bf4-174">В большинстве случаев число потоков и формат каждого потока не могут быть известны до завершения этого шага.</span><span class="sxs-lookup"><span data-stu-id="22bf4-174">In most cases, the number of streams and the format of each stream cannot be known until this step is complete.</span></span>
2.  <span data-ttu-id="22bf4-175">Затем, если потоки сжимаются, они должны быть декодированы с помощью соответствующих декодеров.</span><span class="sxs-lookup"><span data-stu-id="22bf4-175">Next, if the streams are compressed, they must be decoded using the appropriate decoders.</span></span>

<span data-ttu-id="22bf4-176">Этот факт довольно естественно подходит для проектирования программного обеспечения, где отдельные компоненты используются для анализа контейнеров и декодирования потоков.</span><span class="sxs-lookup"><span data-stu-id="22bf4-176">This fact leads quite naturally to a software design where separate components are used to parse containers and decode streams.</span></span> <span data-ttu-id="22bf4-177">Кроме того, этот подход предоставляется модели подключаемых модулей, чтобы сторонние стороны могли предоставлять собственные средства синтаксического анализа и кодеки.</span><span class="sxs-lookup"><span data-stu-id="22bf4-177">Further, this approach lends itself to a plug-in model, so that third parties can provide their own parsers and codecs.</span></span> <span data-ttu-id="22bf4-178">В Windows объектная модель компонента (COM) предоставляет стандартный способ отделения API от реализации, что является требованием для любой модели подключаемых модулей.</span><span class="sxs-lookup"><span data-stu-id="22bf4-178">On Windows, the Component Object Model (COM) provides a standard way to separate an API from its implementation, which is a requirement for any plug-in model.</span></span> <span data-ttu-id="22bf4-179">По этой причине (в других случаях) Media Foundation использует COM-интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="22bf4-179">For this reason (among others), Media Foundation uses COM interfaces.</span></span>

<span data-ttu-id="22bf4-180">На следующей схеме показаны компоненты, используемые для чтения файла мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="22bf4-180">The following diagram shows the components used to read a media file:</span></span>

![Схема, на которой показаны компоненты для чтения файла мультимедиа](images/concepts02.png)

<span data-ttu-id="22bf4-182">Для записи файла мультимедиа также необходимо выполнить два действия:</span><span class="sxs-lookup"><span data-stu-id="22bf4-182">Writing a media file also requires two steps:</span></span>

1.  <span data-ttu-id="22bf4-183">Кодирование несжатых аудио-и видеоданных.</span><span class="sxs-lookup"><span data-stu-id="22bf4-183">Encoding the uncompressed audio/video data.</span></span>
2.  <span data-ttu-id="22bf4-184">Перевод сжатых данных в определенный формат контейнера.</span><span class="sxs-lookup"><span data-stu-id="22bf4-184">Putting the compressed data into a particular container format.</span></span>

<span data-ttu-id="22bf4-185">На следующей схеме показаны компоненты, используемые для записи файла мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="22bf4-185">The following diagram shows the components used to write a media file:</span></span>

![Схема, на которой показаны компоненты для записи файла мультимедиа.](images/concepts03.png)

## <a name="related-topics"></a><span data-ttu-id="22bf4-187">См. также</span><span class="sxs-lookup"><span data-stu-id="22bf4-187">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="22bf4-188">Media Foundationое программное руководством</span><span class="sxs-lookup"><span data-stu-id="22bf4-188">Media Foundation Programming Guide</span></span>](media-foundation-programming-guide.md)
</dt> </dl>

 

 



