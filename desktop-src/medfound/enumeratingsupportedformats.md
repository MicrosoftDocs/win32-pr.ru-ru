---
description: Настройка кодека дмос
ms.assetid: 431b33f1-ceb0-4f1b-a9f2-72e88b63f973
title: Настройка кодека дмос
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 564c0e6c566d9f583a495238f3ea6f0716d7adde
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104496815"
---
# <a name="configuring-codec-dmos"></a><span data-ttu-id="01d0b-103">Настройка кодека дмос</span><span class="sxs-lookup"><span data-stu-id="01d0b-103">Configuring Codec DMOs</span></span>

<span data-ttu-id="01d0b-104">В этом разделе описывается процесс настройки кодека дмос.</span><span class="sxs-lookup"><span data-stu-id="01d0b-104">This topic describes the process of configuring the codec DMOs.</span></span> <span data-ttu-id="01d0b-105">Каждый кодек имеет определенные процедуры, но сведения, общие для всех, описаны здесь.</span><span class="sxs-lookup"><span data-stu-id="01d0b-105">Each codec has specific procedures, but the information common to all is described here.</span></span>

## <a name="configuring-dmo-inputs-and-outputs"></a><span data-ttu-id="01d0b-106">Настройка входных и выходных данных DMO</span><span class="sxs-lookup"><span data-stu-id="01d0b-106">Configuring DMO Inputs and Outputs</span></span>

<span data-ttu-id="01d0b-107">Каждый DMO поддерживает определенные типы входных и выходных данных.</span><span class="sxs-lookup"><span data-stu-id="01d0b-107">Every DMO supports specific input and output types.</span></span> <span data-ttu-id="01d0b-108">Поддерживаемые типы входных и выходных данных можно получить, вызвав [**имедиаобжект:: жетинпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getinputtype) для входных данных и [**Имедиаобжект:: жетаутпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getoutputtype) для выходов.</span><span class="sxs-lookup"><span data-stu-id="01d0b-108">You can retrieve supported types for inputs and outputs by calling [**IMediaObject::GetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getinputtype) for inputs and [**IMediaObject::GetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getoutputtype) for outputs.</span></span> <span data-ttu-id="01d0b-109">Можно перечислить Поддерживаемые форматы, добавив повторяющиеся вызовы в любой из методов, увеличивая индекс типа с каждым вызовом.</span><span class="sxs-lookup"><span data-stu-id="01d0b-109">You can enumerate the supported formats by making repeated calls to either method, incrementing the type index with each call.</span></span> <span data-ttu-id="01d0b-110">Если индекс превышает тип конечного поддерживаемого типа, вызов возвращает DMO, а \_ \_ не \_ больше \_ элементов.</span><span class="sxs-lookup"><span data-stu-id="01d0b-110">When the index exceeds that of the final supported type, the call returns DMO\_E\_NO\_MORE\_ITEMS.</span></span>

<span data-ttu-id="01d0b-111">Для видеокодеков перечисляются только один тип выходных данных или тип входных данных для данного подтипа носителя.</span><span class="sxs-lookup"><span data-stu-id="01d0b-111">For the video codecs, only one output type or input type is enumerated for a given media subtype.</span></span> <span data-ttu-id="01d0b-112">Для аудиокодеков поддерживается перечисление каждого отдельного поддерживаемого типа.</span><span class="sxs-lookup"><span data-stu-id="01d0b-112">For the audio codecs, each individual supported type is enumerated.</span></span> <span data-ttu-id="01d0b-113">Дополнительные сведения о поддерживаемых типах для отдельных кодеков см. в разделе [Работа с аудио](workingwithaudio.md) и [Работа с видео](workingwithvideo.md).</span><span class="sxs-lookup"><span data-stu-id="01d0b-113">For more information about supported types for individual codecs, see [Working with Audio](workingwithaudio.md) and [Working with Video](workingwithvideo.md).</span></span>

<span data-ttu-id="01d0b-114">После настройки типов мультимедиа для входных и выходных потоков задайте их, вызвав [**имедиаобжект:: сетинпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) и [**Имедиаобжект:: сетаутпуттипе**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype) соответственно.</span><span class="sxs-lookup"><span data-stu-id="01d0b-114">After you configure the media types for the input and output streams, set them by calling [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) and [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype) respectively.</span></span> <span data-ttu-id="01d0b-115">Оба этих метода возвращают **DMO \_ E \_ Type \_ не \_ принимается** , если указанный тип является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="01d0b-115">Both of these methods return **DMO\_E\_TYPE\_NOT\_ACCEPTED** if the specified type is invalid.</span></span>

## <a name="configuring-the-codec-dmos-for-encoding"></a><span data-ttu-id="01d0b-116">Настройка кодека дмос для кодирования</span><span class="sxs-lookup"><span data-stu-id="01d0b-116">Configuring the Codec DMOs for Encoding</span></span>

<span data-ttu-id="01d0b-117">Все видеокодеки Windows Media Audio и Video поддерживают различные функции кодирования.</span><span class="sxs-lookup"><span data-stu-id="01d0b-117">All of the Windows Media Audio and Video codecs support a variety of encoding features.</span></span> <span data-ttu-id="01d0b-118">Эти функции обычно настраиваются путем установки свойств в DMO с помощью методов интерфейса **ипропертибаг** .</span><span class="sxs-lookup"><span data-stu-id="01d0b-118">These features are generally configured by setting properties on the DMO by using the methods of the **IPropertyBag** interface.</span></span> <span data-ttu-id="01d0b-119">Некоторые свойства настраиваются с помощью специализированных интерфейсов кодека.</span><span class="sxs-lookup"><span data-stu-id="01d0b-119">Some properties are configured using specialized codec interfaces.</span></span> <span data-ttu-id="01d0b-120">Эти интерфейсы перечислены для каждого кодека в разделе [объекты кодека](codecobjects.md).</span><span class="sxs-lookup"><span data-stu-id="01d0b-120">These interfaces are listed for each codec in the section [Codec Objects](codecobjects.md).</span></span>

<span data-ttu-id="01d0b-121">Ниже приведен общий порядок операций по настройке кодировки DMO.</span><span class="sxs-lookup"><span data-stu-id="01d0b-121">The general order of operations for configuring an encoding DMO is as follows:</span></span>

1.  <span data-ttu-id="01d0b-122">Настройте необходимые функции кодека с помощью методов **ипропертибаг**.</span><span class="sxs-lookup"><span data-stu-id="01d0b-122">Configure codec features as desired by using the methods of **IPropertyBag**.</span></span>
2.  <span data-ttu-id="01d0b-123">При необходимости используйте интерфейсы кодека DMO для настройки дополнительных функций.</span><span class="sxs-lookup"><span data-stu-id="01d0b-123">Use the codec DMO interfaces to configure additional features, if needed.</span></span>
3.  <span data-ttu-id="01d0b-124">Настройте типы входных и выходных данных.</span><span class="sxs-lookup"><span data-stu-id="01d0b-124">Configure the input and output types.</span></span> <span data-ttu-id="01d0b-125">Порядок, в котором должны настраиваться типы, зависит от отдельных кодеков.</span><span class="sxs-lookup"><span data-stu-id="01d0b-125">The order in which the types should be configured varies for individual codecs.</span></span> <span data-ttu-id="01d0b-126">Дополнительные сведения см. в разделе [Работа с аудио](workingwithaudio.md) и [Работа с видео](workingwithvideo.md).</span><span class="sxs-lookup"><span data-stu-id="01d0b-126">For more information, see [Working with Audio](workingwithaudio.md) and [Working with Video](workingwithvideo.md).</span></span>

## <a name="configuring-the-codec-dmos-for-decoding"></a><span data-ttu-id="01d0b-127">Настройка кодека дмос для декодирования</span><span class="sxs-lookup"><span data-stu-id="01d0b-127">Configuring the Codec DMOs for Decoding</span></span>

<span data-ttu-id="01d0b-128">Декодирование проще, чем кодирование, так как поддерживается меньше возможностей декодера.</span><span class="sxs-lookup"><span data-stu-id="01d0b-128">Decoding is simpler than encoding, as fewer decoder features are supported.</span></span>

<span data-ttu-id="01d0b-129">Ниже приведен общий порядок операций для настройки декодирования DMO.</span><span class="sxs-lookup"><span data-stu-id="01d0b-129">The general order of operations for configuring a decoding DMO is as follows:</span></span>

1.  <span data-ttu-id="01d0b-130">Настройте необходимые функции декодера с помощью методов **ипропертибаг**.</span><span class="sxs-lookup"><span data-stu-id="01d0b-130">Configure decoder features as desired by using the methods of **IPropertyBag**.</span></span>
2.  <span data-ttu-id="01d0b-131">Установите тип входных данных в тип, используемый для выходных данных кодировщика.</span><span class="sxs-lookup"><span data-stu-id="01d0b-131">Set the input type to the type used for the encoder output.</span></span>
3.  <span data-ttu-id="01d0b-132">Настройте тип выходных данных.</span><span class="sxs-lookup"><span data-stu-id="01d0b-132">Configure the output type.</span></span> <span data-ttu-id="01d0b-133">Поддерживаемые типы вывода различаются для различных входных данных.</span><span class="sxs-lookup"><span data-stu-id="01d0b-133">The supported output types are different for different inputs.</span></span>

> [!Note]  
> <span data-ttu-id="01d0b-134">Важно использовать тот же тип носителя для ввода декодера, что использовалось для выходных данных кодировщика.</span><span class="sxs-lookup"><span data-stu-id="01d0b-134">It is important to use the same media type for the decoder input as was used for the encoder output.</span></span> <span data-ttu-id="01d0b-135">Это обусловлено тем, что видеокодеки Windows Media Audio и Video используют форматы мультимедиа с дополнительными данными.</span><span class="sxs-lookup"><span data-stu-id="01d0b-135">This is because the Windows Media Audio and Video codecs use media formats with extra data.</span></span> <span data-ttu-id="01d0b-136">Эти данные добавляются к структуре, на которую указывает элемент **пбформат** структуры [**\_ \_ типа мультимедиа DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) (обычно [**видеоинфохеадер**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) или [**вавеформатекс**](/previous-versions/dd757713(v=vs.85))).</span><span class="sxs-lookup"><span data-stu-id="01d0b-136">This data is appended to the structure pointed to by the **pbFormat** member of the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure (usually [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) or [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))).</span></span> <span data-ttu-id="01d0b-137">Для некоторых типов дополнительные данные являются частью типа выходных данных кодировщика перечисления.</span><span class="sxs-lookup"><span data-stu-id="01d0b-137">For some types the extra data is part of the enumerated encoder output type.</span></span> <span data-ttu-id="01d0b-138">Другие типы потребует добавления этих данных вручную.</span><span class="sxs-lookup"><span data-stu-id="01d0b-138">Other types require you to append this data manually.</span></span> <span data-ttu-id="01d0b-139">Без данных расширенного формата декодировать сжатое содержимое нельзя.</span><span class="sxs-lookup"><span data-stu-id="01d0b-139">Without the extended format data, you cannot decode the compressed content.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="01d0b-140">См. также</span><span class="sxs-lookup"><span data-stu-id="01d0b-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="01d0b-141">Работа с кодеками дмос</span><span class="sxs-lookup"><span data-stu-id="01d0b-141">Working with Codec DMOs</span></span>](workingwithcodecdmos.md)
</dt> </dl>

 

 
