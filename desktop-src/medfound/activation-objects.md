---
description: Объекты активации
ms.assetid: 767d5f1c-2b8d-43b6-916b-035129e93204
title: Объекты активации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa8741cbfa8bc3801a23b4976e60c0a3ad028b0e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104145610"
---
# <a name="activation-objects"></a><span data-ttu-id="549e7-103">Объекты активации</span><span class="sxs-lookup"><span data-stu-id="549e7-103">Activation Objects</span></span>

<span data-ttu-id="549e7-104">*Объект активации* — это вспомогательный объект, который используется для создания другого объекта, что напоминает фабрику классов.</span><span class="sxs-lookup"><span data-stu-id="549e7-104">An *activation object* is a helper object that is used to create another object, somewhat similar to a class factory.</span></span> <span data-ttu-id="549e7-105">Объекты активации предоставляют интерфейс [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) .</span><span class="sxs-lookup"><span data-stu-id="549e7-105">Activation objects expose the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) interface.</span></span>

<span data-ttu-id="549e7-106">Объект активации позволяет отложить создание целевого объекта, так как вы можете удерживать указатель на [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) , не создавая целевой объект.</span><span class="sxs-lookup"><span data-stu-id="549e7-106">An activation object lets you defer the creation of the target object, because you can hold onto an [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointer without creating the target object.</span></span> <span data-ttu-id="549e7-107">Объекты активации также можно сериализовать и, следовательно, использовать для создания целевого объекта в другом процессе.</span><span class="sxs-lookup"><span data-stu-id="549e7-107">Activation objects can also be serialized, and thus used to create the target object in another process.</span></span> <span data-ttu-id="549e7-108">Например, объекты активации используются для маршалирования компонентов конвейера из процесса приложения в процесс защищенного пути к носителю (PMP).</span><span class="sxs-lookup"><span data-stu-id="549e7-108">For example, activation objects are used to marshal pipeline components from the application process to the protected media path (PMP) process.</span></span> <span data-ttu-id="549e7-109">Объекты активации также используются некоторыми функциями перечисления, которые возвращают список **имфактиватеных** указателей.</span><span class="sxs-lookup"><span data-stu-id="549e7-109">Activation objects are also used by certain enumeration functions that return a list of **IMFActivate** pointers.</span></span> <span data-ttu-id="549e7-110">Прежде чем приложение создаст целевой объект, оно может получить сведения об объекте, изучив атрибуты объекта активации.</span><span class="sxs-lookup"><span data-stu-id="549e7-110">Before the application creates the target object, it can get information about the object by examining attributes on the activation object.</span></span>

<span data-ttu-id="549e7-111">Чтобы создать целевой объект из объекта активации, вызовите метод [**имфактивате:: активатеобжект**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) .</span><span class="sxs-lookup"><span data-stu-id="549e7-111">To create the target object from an activation object, call the [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) method.</span></span> <span data-ttu-id="549e7-112">Вызывающий объект должен вызвать [**имфактивате:: шутдовнобжект**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-shutdownobject) , когда он завершится с помощью созданного объекта.</span><span class="sxs-lookup"><span data-stu-id="549e7-112">The caller must call [**IMFActivate::ShutdownObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-shutdownobject) when it is done using the created object.</span></span> <span data-ttu-id="549e7-113">Часто приложение создает объект активации, а сеанс мультимедиа вызывает **активатеобжект**.</span><span class="sxs-lookup"><span data-stu-id="549e7-113">Often the application creates the activation object, and the Media Session calls **ActivateObject**.</span></span> <span data-ttu-id="549e7-114">В этом случае сеанс мультимедиа, а не приложение, должен вызывать **шутдовнобжект**.</span><span class="sxs-lookup"><span data-stu-id="549e7-114">In that case, the Media Session, not the application, must call **ShutdownObject**.</span></span> <span data-ttu-id="549e7-115">В других ситуациях приложение получает указатель [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) из сеанса мультимедиа, и приложение вызывает **активатеобжект** и **шутдовнобжект**.</span><span class="sxs-lookup"><span data-stu-id="549e7-115">In other situations, the application receives an [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointer from the Media Session, and the application calls **ActivateObject** and **ShutdownObject**.</span></span> <span data-ttu-id="549e7-116">(Например, см. раздел [как воспроизвести защищенные файлы мультимедиа](how-to-play-protected-media-files.md).)</span><span class="sxs-lookup"><span data-stu-id="549e7-116">(For example, see [How to Play Protected Media Files](how-to-play-protected-media-files.md).)</span></span>

<span data-ttu-id="549e7-117">Объекты активации могут иметь атрибуты, а интерфейс [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) наследует интерфейс [**имфаттрибутес**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) .</span><span class="sxs-lookup"><span data-stu-id="549e7-117">Activation objects can have attributes, and the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) interface inherits the [**IMFAttributes**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) interface.</span></span> <span data-ttu-id="549e7-118">Некоторые объекты активации используют атрибуты для настройки созданного объекта.</span><span class="sxs-lookup"><span data-stu-id="549e7-118">Some activation objects use attributes to configure the created object.</span></span> <span data-ttu-id="549e7-119">Конкретные атрибуты, поддерживаемые каждым объектом, описаны в справочнике по функции создания объекта активации.</span><span class="sxs-lookup"><span data-stu-id="549e7-119">The specific attributes supported by each object are documented in the reference for that activation object's creation function.</span></span> <span data-ttu-id="549e7-120">Задайте атрибуты с помощью указателя **имфактивате** , полученного от функции.</span><span class="sxs-lookup"><span data-stu-id="549e7-120">Set the attributes using the **IMFActivate** pointer that you receive from the function.</span></span>

<span data-ttu-id="549e7-121">Для защищенного воспроизведения объекты активации маршалируются в процесс PMP.</span><span class="sxs-lookup"><span data-stu-id="549e7-121">For protected playback, activation objects are marshaled to the PMP process.</span></span> <span data-ttu-id="549e7-122">Для поддержки маршалирования объект активации должен предоставлять интерфейс **IPersistStream** .</span><span class="sxs-lookup"><span data-stu-id="549e7-122">To support marshaling, an activation object must expose the **IPersistStream** interface.</span></span> <span data-ttu-id="549e7-123">Кроме того, как объект активации, так и созданный объект должны быть надежными компонентами, если PMP работает в защищенном процессе.</span><span class="sxs-lookup"><span data-stu-id="549e7-123">In addition, both the activation object and the created object must be trusted components if the PMP is running in a protected process.</span></span> <span data-ttu-id="549e7-124">Это не является обязательным, если PMP загружается в незащищенном процессе.</span><span class="sxs-lookup"><span data-stu-id="549e7-124">This is not a requirement when the PMP is loaded in an unprotected process.</span></span>

<span data-ttu-id="549e7-125">Чтобы использовать пользовательский объект конвейера (например, приемник мультимедиа) внутри процесса PMP, необходимо реализовать объект активации для объекта конвейера:</span><span class="sxs-lookup"><span data-stu-id="549e7-125">To use a custom pipeline object (such as a media sink) inside the PMP process, you must implement an activation object for your pipeline object:</span></span>

-   <span data-ttu-id="549e7-126">Объект активации должен предоставлять [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) и **IPersistStream**.</span><span class="sxs-lookup"><span data-stu-id="549e7-126">The activation object must expose [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) and **IPersistStream**.</span></span>
-   <span data-ttu-id="549e7-127">Метод **IPersist::** GetObject объекта активации должен возвращать CLSID объекта активации.</span><span class="sxs-lookup"><span data-stu-id="549e7-127">The activation object's **IPersist::GetClassID** method must return the activation object's CLSID.</span></span>
-   <span data-ttu-id="549e7-128">При необходимости можно реализовать методы **IPersistStream:: Save** и **IPersistStream:: Load** для маршалирования любых данных, необходимых для настройки объекта активации.</span><span class="sxs-lookup"><span data-stu-id="549e7-128">Optionally, you can implement the **IPersistStream::Save** and **IPersistStream::Load** methods to marshal any data that you need to configure your activation object.</span></span>

<span data-ttu-id="549e7-129">Когда сеанс мультимедиа загружает топологию внутри процесса PMP, он вызывает метод **CoCreateInstance** , чтобы создать новый экземпляр объекта активации.</span><span class="sxs-lookup"><span data-stu-id="549e7-129">When the Media Session loads the topology inside the PMP process, it calls **CoCreateInstance** to create a new instance of your activation object.</span></span> <span data-ttu-id="549e7-130">Затем вызывается метод [**имфактивате:: активатеобжект**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) , чтобы создать объект конвейера.</span><span class="sxs-lookup"><span data-stu-id="549e7-130">Then it calls [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) to create the pipeline object.</span></span>

## <a name="related-topics"></a><span data-ttu-id="549e7-131">См. также</span><span class="sxs-lookup"><span data-stu-id="549e7-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="549e7-132">Media Foundation API платформы</span><span class="sxs-lookup"><span data-stu-id="549e7-132">Media Foundation Platform APIs</span></span>](media-foundation-platform-apis.md)
</dt> <dt>

[<span data-ttu-id="549e7-133">**имфактивате**</span><span class="sxs-lookup"><span data-stu-id="549e7-133">**IMFActivate**</span></span>](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate)
</dt> </dl>

 

 



