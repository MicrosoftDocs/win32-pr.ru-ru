---
description: Использование элементов управления отображением видео
ms.assetid: 09501d67-effb-41ce-a7b7-d2415acdf3ac
title: Использование элементов управления отображением видео
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9bbb9c83485faebc873b3e92502122c5497b4bb1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103811519"
---
# <a name="using-the-video-display-controls"></a>Использование элементов управления отображением видео

Интерфейс [**имфвидеодисплайконтрол**](/windows/desktop/api/evr/nn-evr-imfvideodisplaycontrol) управляет отображением видео в окне приложения с помощью расширенного обработчика видео (Евр). Этот интерфейс можно использовать либо в DirectShow, либо в Media Foundation. На внутреннем уровне элементы управления отображением видео предоставляются средством отображения по умолчанию Евр. При написании пользовательского Presenter можно предоставить тот же интерфейс или определить пользовательский интерфейс.

Правильный способ получения указателя на интерфейс [**имфвидеодисплайконтрол**](/windows/desktop/api/evr/nn-evr-imfvideodisplaycontrol) зависит от того, используется ли версия DirectShow Евр или версия Media Foundation. Для Media Foundation Евр это также зависит от того, используется ли Евр напрямую или с помощью сеанса мультимедиа (что является более типичным).

Чтобы получить указатель на интерфейс [**имфвидеодисплайконтрол**](/windows/desktop/api/evr/nn-evr-imfvideodisplaycontrol) , выполните следующие действия.

1.  Получает указатель на интерфейс [**имфжетсервице**](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice) .

    -   Если используется фильтр Евр DirectShow, вызовите **QueryInterface** в фильтре.

    -   Если вы используете приемник мультимедиа Евр напрямую, вызовите **QueryInterface** в приемнике мультимедиа.

    -   Если вы используете сеанс мультимедиа, вызовите **QueryInterface** в сеансе мультимедиа.

2.  Если вы используете сеанс мультимедиа, подождите, пока сеанс мультимедиа отправит событие [месессионтопологистатус](mesessiontopologystatus.md) со значением status, равным MF \_ топостатус \_ Ready. (Пропустите этот шаг в противном случае.)

3.  Вызовите [**имфжетсервице:: Get Service**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) , чтобы получить интерфейс [**имфвидеодисплайконтрол**](/windows/desktop/api/evr/nn-evr-imfvideodisplaycontrol) . Идентификатор службы — это \_ \_ Служба прорисовки видео Mr \_ .

Интерфейс [**имфвидеодисплайконтрол**](/windows/desktop/api/evr/nn-evr-imfvideodisplaycontrol) можно использовать для выполнения следующих задач:

-   Задайте окно обрезки.

-   Задайте исходные и конечные прямоугольники.

-   Обновление окна видео в ответ на сообщения окна.

-   Включает или отключает полноэкранный режим.

## <a name="clipping-window"></a>Окно обрезки

Приложение должно предоставить окно, в котором Евр рисует видео. Чтобы задать окно обрезки, вызовите [**имфвидеодисплайконтрол:: сетвидеовиндов**](/windows/desktop/api/evr/nf-evr-imfvideodisplaycontrol-setvideowindow) с помощью маркера в окне приложения.

Если создать приемник мультимедиа Евр с помощью объекта активации, этот шаг не является обязательным. Объект активации автоматически вызывает [**сетвидеовиндов**](/windows/desktop/api/evr/nf-evr-imfvideodisplaycontrol-setvideowindow), используя описатель окна, указанный в функции [**мфкреатевидеорендерерактивате**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatevideorendereractivate) .

## <a name="source-and-destination-rectangles"></a>Исходный и конечный прямоугольники

Во время воспроизведения выступающий принимает часть составного изображения видео и рисует его в области окна видео. Часть составного изображения является *исходным прямоугольником*, а область окна видео — *прямоугольником назначения*.

Исходный прямоугольник определяется с использованием нормализованных координат, где точка (0,0, 0,0) соответствует левому верхнему углу видео, а (1,0, 1,0) соответствует нижнему правому углу видео. Исходный прямоугольник может быть любой областью внутри этого прямоугольника. Прямоугольник назначения задается в пикселях относительно клиентской области окна. Исходный прямоугольник по умолчанию — это все изображение, а прямоугольник назначения по умолчанию — пустой прямоугольник.

Чтобы задать исходный и конечный прямоугольники, вызовите метод [**имфвидеодисплайконтрол:: сетвидеопоситион**](/windows/desktop/api/evr/nf-evr-imfvideodisplaycontrol-setvideoposition).

Если создать приемник мультимедиа Евр с помощью объекта активации, этот шаг не является обязательным. Объект активации автоматически задает прямоугольник назначения, равный всей клиентской области окна. Однако следует вызвать [**сетвидеопоситион**](/windows/desktop/api/evr/nf-evr-imfvideodisplaycontrol-setvideoposition) , если необходимо изменить исходный прямоугольник или задать другой конечный прямоугольник.

## <a name="window-messages"></a>Сообщения окна

Во время воспроизведения приложение должно отвечать на определенные окна сообщений следующим образом:

-   WM \_ Paint: вызов [**имфвидеодисплайконтрол:: репаинтвидео**](/windows/desktop/api/evr/nf-evr-imfvideodisplaycontrol-repaintvideo) для перерисовки видео. Кроме того, Избегайте прорисовки прямоугольника назначения во время воспроизведения видео, так как это может вызвать мерцание.

-   \_Размер WM: может потребоваться вызвать [**сетвидеопоситион**](/windows/desktop/api/evr/nf-evr-imfvideodisplaycontrol-setvideoposition) для изменения размера прямоугольника назначения.

В отличие от фильтра "Микширование видео" (VMR) в DirectShow не нужно уведомлять Евр о получении \_ сообщения ДИСПЛАЙЧАНЖЕ WM.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Улучшенный модуль подготовки видео](enhanced-video-renderer.md)
</dt> </dl>

 

 



