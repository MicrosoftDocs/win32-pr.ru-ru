---
description: Использование элементов управления "микшер видео"
ms.assetid: 475996c6-a205-4133-8882-f55beaf9f8fd
title: Использование элементов управления "микшер видео"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0a8a062c6f984e0eac0128bd67c72bf691c95af6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104080567"
---
# <a name="using-the-video-mixer-controls"></a><span data-ttu-id="65149-103">Использование элементов управления "микшер видео"</span><span class="sxs-lookup"><span data-stu-id="65149-103">Using the Video Mixer Controls</span></span>

<span data-ttu-id="65149-104">Микшер Евр предоставляет несколько интерфейсов, которые приложение может использовать для управления процессом обработки видео микшера.</span><span class="sxs-lookup"><span data-stu-id="65149-104">The EVR mixer provides several interfaces that an application can use to control how the mixer processes video.</span></span> <span data-ttu-id="65149-105">Эти интерфейсы можно использовать либо в DirectShow, либо в Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="65149-105">These interfaces can be used in either DirectShow or Media Foundation.</span></span>



| <span data-ttu-id="65149-106">Интерфейс</span><span class="sxs-lookup"><span data-stu-id="65149-106">Interface</span></span>                                                      | <span data-ttu-id="65149-107">Описание</span><span class="sxs-lookup"><span data-stu-id="65149-107">Description</span></span>                                                                                                                                                                                                                                 |
|----------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="65149-108">Интерфейс [**имфвидеомиксербитмап**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap)</span><span class="sxs-lookup"><span data-stu-id="65149-108">[**IMFVideoMixerBitmap**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap) interface</span></span>   | <span data-ttu-id="65149-109">Альфа — смешение статического растрового изображения на видео.</span><span class="sxs-lookup"><span data-stu-id="65149-109">Alpha-blends a static bitmap image onto the video.</span></span>                                                                                                                                                                                          |
| <span data-ttu-id="65149-110">Интерфейс [**имфвидеомиксерконтрол**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol)</span><span class="sxs-lookup"><span data-stu-id="65149-110">[**IMFVideoMixerControl**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol) interface</span></span> | <span data-ttu-id="65149-111">Управляет тем, как Евр смешивает видео подпотоки.</span><span class="sxs-lookup"><span data-stu-id="65149-111">Controls how the EVR mixes video substreams.</span></span>                                                                                                                                                                                                |
| <span data-ttu-id="65149-112">Интерфейс [**имфвидеопроцессор**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor)</span><span class="sxs-lookup"><span data-stu-id="65149-112">[**IMFVideoProcessor**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor) interface</span></span>       | <span data-ttu-id="65149-113">Управляет настройкой цвета, фильтрами изображений и другими возможностями обработки видео.</span><span class="sxs-lookup"><span data-stu-id="65149-113">Controls color adjustment, image filters, and other video processing capabilities.</span></span> <span data-ttu-id="65149-114">Этот интерфейс предоставляет доступ к функциям, реализованным графическим драйвером, поэтому конкретные возможности будут зависеть от драйвера графического пользователя.</span><span class="sxs-lookup"><span data-stu-id="65149-114">This interface provides access to functionality implemented by the graphics driver, so the exact capabilities will depend on the user's graphics driver.</span></span> |



 

<span data-ttu-id="65149-115">Правильный способ получения указателей на эти интерфейсы зависит от того, используется ли версия DirectShow Евр или версия Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="65149-115">The correct way to get pointers to these interfaces depends on whether you are using the DirectShow version of the EVR or the Media Foundation version.</span></span> <span data-ttu-id="65149-116">Для Media Foundation Евр это также зависит от того, используется ли Евр напрямую или с помощью [сеанса мультимедиа](media-session.md).</span><span class="sxs-lookup"><span data-stu-id="65149-116">For the Media Foundation EVR, it also depends on whether you are using the EVR directly or using it through the [Media Session](media-session.md).</span></span> <span data-ttu-id="65149-117">(Обычно приложение будет использовать Евр через сеанс мультимедиа, а не напрямую).</span><span class="sxs-lookup"><span data-stu-id="65149-117">(Typically an application will use the EVR through the Media Session, not directly).</span></span>

<span data-ttu-id="65149-118">Чтобы получить указатель на любой из этих интерфейсов, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="65149-118">To get a pointer to any of these interfaces, do the following:</span></span>

1.  <span data-ttu-id="65149-119">Получите указатель на интерфейс [**имфжетсервице**](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice) в Евр.</span><span class="sxs-lookup"><span data-stu-id="65149-119">Get a pointer to the [**IMFGetService**](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice) interface on the EVR.</span></span>

    -   <span data-ttu-id="65149-120">Если используется фильтр Евр DirectShow, вызовите **QueryInterface** в фильтре.</span><span class="sxs-lookup"><span data-stu-id="65149-120">If you are using the DirectShow EVR filter, call **QueryInterface** on the filter.</span></span>

    -   <span data-ttu-id="65149-121">Если вы используете приемник мультимедиа Евр напрямую, вызовите **QueryInterface** в приемнике мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="65149-121">If you are using the EVR media sink directly, call **QueryInterface** on the media sink.</span></span>

    -   <span data-ttu-id="65149-122">Если вы используете сеанс мультимедиа, вызовите **QueryInterface** в сеансе мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="65149-122">If you are using the Media Session, call **QueryInterface** on the Media Session.</span></span>

2.  <span data-ttu-id="65149-123">Если вы используете сеанс мультимедиа, подождите, пока сеанс мультимедиа отправит событие [месессионтопологистатус](mesessiontopologystatus.md) со значением status, равным MF \_ топостатус \_ Ready.</span><span class="sxs-lookup"><span data-stu-id="65149-123">If you are using the Media Session, wait for the Media Session to send the [MESessionTopologyStatus](mesessiontopologystatus.md) event with a status value of MF\_TOPOSTATUS\_READY.</span></span> <span data-ttu-id="65149-124">(Пропустите этот шаг, если сеанс мультимедиа не используется.)</span><span class="sxs-lookup"><span data-stu-id="65149-124">(Skip this step if you are not using the Media Session.)</span></span>

3.  <span data-ttu-id="65149-125">Вызовите [**имфжетсервице:: Get Service**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) , чтобы получить интерфейс микшера.</span><span class="sxs-lookup"><span data-stu-id="65149-125">Call [**IMFGetService::GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) to get the mixer interface.</span></span> <span data-ttu-id="65149-126">Используйте службу "идентификатор службы" MR \_ Video \_ микшера \_ .</span><span class="sxs-lookup"><span data-stu-id="65149-126">Use the service identifier MR\_VIDEO\_MIXER\_SERVICE.</span></span>

## <a name="alpha-blending-a-bitmap-onto-the-video"></a><span data-ttu-id="65149-127">Альфа-смешение растрового изображения на видео</span><span class="sxs-lookup"><span data-stu-id="65149-127">Alpha Blending a Bitmap onto the Video</span></span>

<span data-ttu-id="65149-128">Вы можете использовать интерфейс [**имфвидеомиксербитмап**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap) для альфа-смешения статического растрового изображения на видео во время воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="65149-128">You can use the [**IMFVideoMixerBitmap**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap) interface to alpha blend a static bitmap onto the video during playback.</span></span> <span data-ttu-id="65149-129">Точечный рисунок можно сохранить в области Direct3D, указанном как указатель **IDirect3DSurface9** , или использовать точечный рисунок GDI.</span><span class="sxs-lookup"><span data-stu-id="65149-129">You can store the bitmap in a Direct3D surface, specified as an **IDirect3DSurface9** pointer, or use a GDI bitmap.</span></span>

<span data-ttu-id="65149-130">Если для точечного рисунка используется поверхность Direct3D, поверхность может содержать альфа-данные для каждого пикселя, которые будут использоваться, когда микшер альфа-смешение изображения.</span><span class="sxs-lookup"><span data-stu-id="65149-130">If you use a Direct3D surface for the bitmap, the surface can contain per-pixel alpha data, which will be used when the mixer alpha-blends the image.</span></span> <span data-ttu-id="65149-131">Кроме того, можно определить ключ цвета, т. е. один цвет, который будет прозрачным везде, где он отображается в точечном рисунке.</span><span class="sxs-lookup"><span data-stu-id="65149-131">Alternatively, you can define a color key—that is, a single color that will be transparent wherever it appears in the bitmap.</span></span> <span data-ttu-id="65149-132">Кроме того, можно указать альфа-значение, которое будет применено ко всему изображению.</span><span class="sxs-lookup"><span data-stu-id="65149-132">Also, you can specify an alpha value that will be applied to the entire image.</span></span> <span data-ttu-id="65149-133">Можно также задать исходный прямоугольник для обрезки растрового изображения и прямоугольник назначения для размещения растрового изображения в кадре видео.</span><span class="sxs-lookup"><span data-stu-id="65149-133">You can also set a source rectangle to crop the bitmap, and a destination rectangle to position the bitmap within the video frame.</span></span>

<span data-ttu-id="65149-134">Чтобы задать точечный рисунок, вызовите метод [**имфвидеомиксербитмап:: сеталфабитмап**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-setalphabitmap).</span><span class="sxs-lookup"><span data-stu-id="65149-134">To set the bitmap, call [**IMFVideoMixerBitmap::SetAlphaBitmap**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-setalphabitmap).</span></span> <span data-ttu-id="65149-135">Этот метод принимает указатель на структуру [**мфвидеоалфабитмап**](/windows/desktop/api/evr9/ns-evr9-mfvideoalphabitmap) , указывающую точечный рисунок и параметры альфа-смешения.</span><span class="sxs-lookup"><span data-stu-id="65149-135">This method takes a pointer to an [**MFVideoAlphaBitmap**](/windows/desktop/api/evr9/ns-evr9-mfvideoalphabitmap) structure that specifies the bitmap and the alpha-blending parameters.</span></span> <span data-ttu-id="65149-136">Пример кода см. в разделе справки по методу **сеталфабитмап** .</span><span class="sxs-lookup"><span data-stu-id="65149-136">For example code, see the reference topic for the **SetAlphaBitmap** method.</span></span>

<span data-ttu-id="65149-137">После установки точечного рисунка можно обновить параметры смешения, включая исходный и целевой реканглес, вызвав [**имфвидеомиксербитмап:: упдатеалфабитмаппараметерс**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-updatealphabitmapparameters).</span><span class="sxs-lookup"><span data-stu-id="65149-137">After you set the bitmap, you can update the blending parameters, including the source and destination recangles, by calling [**IMFVideoMixerBitmap::UpdateAlphaBitmapParameters**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-updatealphabitmapparameters).</span></span> <span data-ttu-id="65149-138">Обновление вступает в силу на следующем кадре видео.</span><span class="sxs-lookup"><span data-stu-id="65149-138">The update takes effect on the next video frame.</span></span> <span data-ttu-id="65149-139">Чтобы обновление было выполнено, должно быть продолжено воспроизведение видео.</span><span class="sxs-lookup"><span data-stu-id="65149-139">The video must be playing for the update to occur.</span></span> <span data-ttu-id="65149-140">Этот метод можно использовать для выполнения простых анимаций на точечном рисунке.</span><span class="sxs-lookup"><span data-stu-id="65149-140">You can use this method to perform simple animations on the bitmap.</span></span> <span data-ttu-id="65149-141">(Если вам нужны более сложные эффекты, попробуйте написать пользовательский микшер Евр.)</span><span class="sxs-lookup"><span data-stu-id="65149-141">(If you need more sophisticated effects, consider writing a custom EVR mixer.)</span></span>

<span data-ttu-id="65149-142">Чтобы очистить точечный рисунок, вызовите метод [**имфвидеомиксербитмап:: клеаралфабитмап**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-clearalphabitmap).</span><span class="sxs-lookup"><span data-stu-id="65149-142">To clear the bitmap, call [**IMFVideoMixerBitmap::ClearAlphaBitmap**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-clearalphabitmap).</span></span>

## <a name="controlling-substreams"></a><span data-ttu-id="65149-143">Управление подпотоками</span><span class="sxs-lookup"><span data-stu-id="65149-143">Controlling Substreams</span></span>

<span data-ttu-id="65149-144">Евр может смешивать один или несколько подпотоков видео на основном видеопотоке.</span><span class="sxs-lookup"><span data-stu-id="65149-144">The EVR can mix one or more video substreams onto the primary video stream.</span></span> <span data-ttu-id="65149-145">Для управления смешением подпотока используйте интерфейс [**имфвидеомиксерконтрол**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol) .</span><span class="sxs-lookup"><span data-stu-id="65149-145">To control substream mixing, use the [**IMFVideoMixerControl**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol) interface.</span></span>

-   <span data-ttu-id="65149-146">Вызовите метод [**имфвидеомиксерконтрол:: сетстреамаутпутрект**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamoutputrect) , чтобы задать расположение вложенного потока в составном видеокадре.</span><span class="sxs-lookup"><span data-stu-id="65149-146">Call [**IMFVideoMixerControl::SetStreamOutputRect**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamoutputrect) to set the position of a substream within the composited video frame.</span></span>

-   <span data-ttu-id="65149-147">Вызовите метод [**имфвидеомиксерконтрол:: сетстреамзордер**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamzorder) , чтобы задать z-порядок для подпотоков.</span><span class="sxs-lookup"><span data-stu-id="65149-147">Call [**IMFVideoMixerControl::SetStreamZOrder**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamzorder) to set the z-order for the substreams.</span></span> <span data-ttu-id="65149-148">Евр рисует видеопотоки в порядке их значений z-порядка, начиная с нуля.</span><span class="sxs-lookup"><span data-stu-id="65149-148">The EVR draws the video streams in the order of their z-order values, starting with zero.</span></span> <span data-ttu-id="65149-149">Основной видеопоток всегда находится сначала в z-порядке.</span><span class="sxs-lookup"><span data-stu-id="65149-149">The primary video stream is always first in the z-order.</span></span>

## <a name="video-processor-settings"></a><span data-ttu-id="65149-150">Параметры обработчика видео</span><span class="sxs-lookup"><span data-stu-id="65149-150">Video Processor Settings</span></span>

<span data-ttu-id="65149-151">Микшер Евр использует ускорение видео DirectX (ДКСВА) для выполнения обработки видео во входных потоках.</span><span class="sxs-lookup"><span data-stu-id="65149-151">The EVR mixer uses DirectX Video Acceleration (DXVA) to perform video processing on the input streams.</span></span> <span data-ttu-id="65149-152">Точные возможности обработки зависят от драйвера графики.</span><span class="sxs-lookup"><span data-stu-id="65149-152">The exact processing capabilities depend on the graphics driver.</span></span> <span data-ttu-id="65149-153">Возможности обработки видео описаны с помощью структуры [**DXVA2 \_ видеопроцессоркапс**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) .</span><span class="sxs-lookup"><span data-stu-id="65149-153">Video processing capabilities are described by using the [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure.</span></span> <span data-ttu-id="65149-154">Определенный набор возможностей называется *режимом обработки видео*, каждый из которых идентифицируется по идентификатору GUID.</span><span class="sxs-lookup"><span data-stu-id="65149-154">A particular set of capabilities is called a *video processing mode*, each mode being identified by a GUID.</span></span> <span data-ttu-id="65149-155">Список стандартных идентификаторов GUID см. в разделе [**идиректксвидеопроцессорсервице:: жетвидеопроцессордевицегуидс**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideoprocessorservice-getvideoprocessordeviceguids).</span><span class="sxs-lookup"><span data-stu-id="65149-155">For a list of predefined GUIDs, see [**IDirectXVideoProcessorService::GetVideoProcessorDeviceGuids**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideoprocessorservice-getvideoprocessordeviceguids).</span></span> <span data-ttu-id="65149-156">Драйвер может определять дополнительные идентификаторы GUID, относящиеся к поставщику, которые представляют различные сочетания возможностей.</span><span class="sxs-lookup"><span data-stu-id="65149-156">The driver might define additional vendor-specific GUIDs, representing different combinations of capabilities.</span></span>

<span data-ttu-id="65149-157">Чтобы найти поддерживаемые режимы и возможности каждого режима, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="65149-157">To find the supported modes and the capabilities of each mode, do the following:</span></span>

1.  <span data-ttu-id="65149-158">Вызовите [**имфжетсервице::-Service**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) , чтобы получить указатель на интерфейс [**имфвидеопроцессор**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor) микшера.</span><span class="sxs-lookup"><span data-stu-id="65149-158">Call [**IMFGetService::GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) to get a pointer to the mixer's [**IMFVideoProcessor**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor) interface.</span></span>

2.  <span data-ttu-id="65149-159">Вызовите [**имфвидеопроцессор:: жетаваилаблевидеопроцессормодес**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getavailablevideoprocessormodes).</span><span class="sxs-lookup"><span data-stu-id="65149-159">Call [**IMFVideoProcessor::GetAvailableVideoProcessorModes**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getavailablevideoprocessormodes).</span></span> <span data-ttu-id="65149-160">Этот метод возвращает массив идентификаторов GUID, которые идентифицируют доступные режимы видеопроцессора.</span><span class="sxs-lookup"><span data-stu-id="65149-160">This method returns an array of GUIDs, which identify the available video processor modes.</span></span> <span data-ttu-id="65149-161">Список возвращается в порядке убывания качества, режим с наивысшим качеством, отображаемый первым в списке.</span><span class="sxs-lookup"><span data-stu-id="65149-161">The list is returned in descending quality order, the mode with the highest quality appearing first in the list.</span></span> <span data-ttu-id="65149-162">Список может изменяться в зависимости от формата видео.</span><span class="sxs-lookup"><span data-stu-id="65149-162">The list can change depending on the format of the video.</span></span>

3.  <span data-ttu-id="65149-163">Для каждого идентификатора GUID в списке вызовите [**имфвидеопроцессор:: жетвидеопроцессоркапс**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) , чтобы найти возможности соответствующего режима видеопроцессора.</span><span class="sxs-lookup"><span data-stu-id="65149-163">For each GUID in the list, call [**IMFVideoProcessor::GetVideoProcessorCaps**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) to find the capabilities of the corresponding video processor mode.</span></span> <span data-ttu-id="65149-164">Метод заполняет структуру [**DXVA2 \_ видеопроцессоркапс**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) с помощью описания возможностей.</span><span class="sxs-lookup"><span data-stu-id="65149-164">The method fills a [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure with a description of the capabilities.</span></span>

4.  <span data-ttu-id="65149-165">Чтобы выбрать режим, вызовите метод [**имфвидеопроцессор:: сетвидеопроцессормоде**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setvideoprocessormode).</span><span class="sxs-lookup"><span data-stu-id="65149-165">To select a mode, call [**IMFVideoProcessor::SetVideoProcessorMode**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setvideoprocessormode).</span></span> <span data-ttu-id="65149-166">В противном случае Евр автоматически выбирает режим при запуске потоковой передачи.</span><span class="sxs-lookup"><span data-stu-id="65149-166">Otherwise, the EVR automatically selects a mode when streaming begins.</span></span> <span data-ttu-id="65149-167">В этом случае можно вызвать метод [**имфвидеопроцессор:: жетвидеопроцессормоде**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessormode) , чтобы найти выбранный режим.</span><span class="sxs-lookup"><span data-stu-id="65149-167">In that case, you can call [**IMFVideoProcessor::GetVideoProcessorMode**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessormode) to find which mode was selected.</span></span>

<span data-ttu-id="65149-168">Большая часть полей в структуре [**DXVA2 \_ видеопроцессоркапс**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) описывает поведение драйвера низкого уровня и не представляет интереса в обычном приложении.</span><span class="sxs-lookup"><span data-stu-id="65149-168">Most of the fields in the [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure describe low-level driver behavior and are not of interest in a typical application.</span></span> <span data-ttu-id="65149-169">Наиболее интересны следующие поля:</span><span class="sxs-lookup"><span data-stu-id="65149-169">The following fields are most likely to be of interest:</span></span>

-   <span data-ttu-id="65149-170">**Девицекапс**.</span><span class="sxs-lookup"><span data-stu-id="65149-170">**DeviceCaps**.</span></span> <span data-ttu-id="65149-171">Это поле указывает, выполняется ли обработка видео в аппаратном или программном обеспечении, а также является ли драйвер графики устаревшим драйвером ДКСВА 1,0.</span><span class="sxs-lookup"><span data-stu-id="65149-171">This field indicates whether video processing is performed in hardware or software, and whether the graphics driver is an older DXVA 1.0 driver.</span></span>

-   <span data-ttu-id="65149-172">**Деинтерлацетечнологи**.</span><span class="sxs-lookup"><span data-stu-id="65149-172">**DeinterlaceTechnology**.</span></span> <span data-ttu-id="65149-173">В этом поле приводятся некоторые сведения о том, какой уровень качества разряда можно рассчитывать, если исходное видео переводится в режим чередования.</span><span class="sxs-lookup"><span data-stu-id="65149-173">This field provides some indication of what level of deinterlacing quality you can expect if the source video is interlaced.</span></span>

-   <span data-ttu-id="65149-174">**Прокампконтролкапс**.</span><span class="sxs-lookup"><span data-stu-id="65149-174">**ProcAmpControlCaps**.</span></span> <span data-ttu-id="65149-175">В этом поле указываются доступные элементы управления коррекцией цвета.</span><span class="sxs-lookup"><span data-stu-id="65149-175">This field specifies which color adjustment controls are available.</span></span> <span data-ttu-id="65149-176">Список возможных цветовых корректировок см. в разделе [Параметры параметра Camp](procamp-settings.md).</span><span class="sxs-lookup"><span data-stu-id="65149-176">For a list of possible color adjustments, see [ProcAmp Settings](procamp-settings.md).</span></span> <span data-ttu-id="65149-177">Если драйвер не может выполнить настройку цвета, это поле будет равно нулю.</span><span class="sxs-lookup"><span data-stu-id="65149-177">If the driver cannot perform color adjustment, this field is zero.</span></span>

-   <span data-ttu-id="65149-178">**Видеопроцессороператионс**.</span><span class="sxs-lookup"><span data-stu-id="65149-178">**VideoProcessorOperations**.</span></span> <span data-ttu-id="65149-179">В этом поле содержатся флаги, описывающие различные возможности обработки видео.</span><span class="sxs-lookup"><span data-stu-id="65149-179">This field contains flags that describe miscellaneous video processing capabilities.</span></span> <span data-ttu-id="65149-180">Два флага с определенной важностью — \_ флаг DXVA2 видеопроцесс \_ подпотоков и \_ флаг DXVA2 видеопроцесс \_ подпотоков.</span><span class="sxs-lookup"><span data-stu-id="65149-180">Two flags of particular importance are the DXVA2\_VideoProcess\_SubStreams flag and the DXVA2\_VideoProcess\_SubStreams flag.</span></span> <span data-ttu-id="65149-181">По крайней мере один из этих флагов должен присутствовать, если Евр будет смешивать подпотоки на видеопотоке ссылок.</span><span class="sxs-lookup"><span data-stu-id="65149-181">At least one of these flags must be present for the EVR to mix substreams onto the reference video stream.</span></span> <span data-ttu-id="65149-182">Если ни один из флагов не указан, ЕВР ограничивается одним видеопотоком.</span><span class="sxs-lookup"><span data-stu-id="65149-182">If neither flag is present, the EVR is limited to one video stream.</span></span>

-   <span data-ttu-id="65149-183">**Ноисефилтертечнологи**.</span><span class="sxs-lookup"><span data-stu-id="65149-183">**NoiseFilterTechnology**.</span></span> <span data-ttu-id="65149-184">Это поле указывает, какие фильтры шума поддерживаются графическим драйвером.</span><span class="sxs-lookup"><span data-stu-id="65149-184">This field indicates which noise filters are supported by the graphics driver.</span></span> <span data-ttu-id="65149-185">Если драйвер не поддерживает фильтрацию шума, значение DXVA2 \_ ноисефилтертеч не \_ поддерживается.</span><span class="sxs-lookup"><span data-stu-id="65149-185">If the driver does not support noise filtering, the value is DXVA2\_NoiseFilterTech\_Unsupported.</span></span>

-   <span data-ttu-id="65149-186">**Детаилфилтертечнологи**.</span><span class="sxs-lookup"><span data-stu-id="65149-186">**DetailFilterTechnology**.</span></span> <span data-ttu-id="65149-187">Это поле показывает, какие фильтры детализации поддерживаются графическим драйвером.</span><span class="sxs-lookup"><span data-stu-id="65149-187">This field indicates which detail filters are supported by the graphics driver.</span></span> <span data-ttu-id="65149-188">Если драйвер не поддерживает фильтрацию шума, значение DXVA2 \_ детаилфилтертеч не \_ поддерживается.</span><span class="sxs-lookup"><span data-stu-id="65149-188">If the driver does not support noise filtering, the value is DXVA2\_DetailFilterTech\_Unsupported.</span></span>

## <a name="color-adjustment-and-image-filtering"></a><span data-ttu-id="65149-189">Настройка цвета и фильтрация изображений</span><span class="sxs-lookup"><span data-stu-id="65149-189">Color Adjustment and Image Filtering</span></span>

<span data-ttu-id="65149-190">Графический драйвер может поддерживать настройку цвета (также называемую *усилением процесса* или *просто* проделать) и фильтрацию изображений.</span><span class="sxs-lookup"><span data-stu-id="65149-190">The graphics driver might support color adjustment (also called *process amplification* or simply *ProcAmp*) and image filtering.</span></span> <span data-ttu-id="65149-191">При выполнении с помощью GPU можно выполнять настройку цветов и фильтрацию изображений в режиме реального времени без дополнительной нагрузки на ЦП.</span><span class="sxs-lookup"><span data-stu-id="65149-191">When performed by the GPU, color adjustment and image filtering can be done in real time with no CPU overhead.</span></span>

<span data-ttu-id="65149-192">Чтобы использовать эти функции, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="65149-192">To use these features, perform the following steps:</span></span>

1.  <span data-ttu-id="65149-193">Выберите режим обработки видео, как описано в предыдущем разделе.</span><span class="sxs-lookup"><span data-stu-id="65149-193">Select a video processing mode as described in the previous section.</span></span>

2.  <span data-ttu-id="65149-194">Вызовите метод [**имфвидеопроцессор:: жетвидеопроцессоркапс**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) , чтобы найти возможности обработки видео, как описано в предыдущем разделе.</span><span class="sxs-lookup"><span data-stu-id="65149-194">Call [**IMFVideoProcessor::GetVideoProcessorCaps**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) to find the video processing capabilities as described in the previous section.</span></span> <span data-ttu-id="65149-195">Метод заполняет структуру [**DXVA2 \_ видеопроцессоркапс**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) , которая описывает возможности, включая, поддерживает ли драйвер настройку цветов и фильтр изображений.</span><span class="sxs-lookup"><span data-stu-id="65149-195">The method fills in a [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure which describes the capabilities, including whether the driver supports color adjustment and image filter.</span></span>

3.  <span data-ttu-id="65149-196">Для каждой настройки цвета, поддерживаемой драйвером, вызовите [**имфвидеопроцессор:: жетпрокампранже**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocamprange) , чтобы найти возможный диапазон значений для этого параметра.</span><span class="sxs-lookup"><span data-stu-id="65149-196">For each color adjustment that is supported by driver, call [**IMFVideoProcessor::GetProcAmpRange**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocamprange) to find the possible range of value for that setting.</span></span> <span data-ttu-id="65149-197">Этот метод также возвращает значение по умолчанию для параметра.</span><span class="sxs-lookup"><span data-stu-id="65149-197">This method also returns the default value for the setting.</span></span> <span data-ttu-id="65149-198">Вызовите метод [**имфвидеопроцессор:: жетпрокампвалуес**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocampvalues) , чтобы найти текущее значение параметров.</span><span class="sxs-lookup"><span data-stu-id="65149-198">Call [**IMFVideoProcessor::GetProcAmpValues**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocampvalues) to find the current value of the settings.</span></span> <span data-ttu-id="65149-199">Значения не имеют указанных единиц.</span><span class="sxs-lookup"><span data-stu-id="65149-199">The values do not have specified units.</span></span> <span data-ttu-id="65149-200">Для определения диапазона значений используется драйвер.</span><span class="sxs-lookup"><span data-stu-id="65149-200">It is up to the driver to define the range of values.</span></span>

4.  <span data-ttu-id="65149-201">Вызовите метод [**имфвидеопроцессор:: сетфилтерингвалуе**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue) , чтобы задать значение коррекции цвета.</span><span class="sxs-lookup"><span data-stu-id="65149-201">Call [**IMFVideoProcessor::SetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue) to set a color adjustment value.</span></span>

5.  <span data-ttu-id="65149-202">Если драйвер поддерживает фильтрацию изображений, то каждый тип фильтра (шум и сведения) поддерживает три параметра: уровень, радиус и пороговое значение — в чрома и яркости.</span><span class="sxs-lookup"><span data-stu-id="65149-202">If the driver supports image filtering, then each filter type (noise and detail) supports three settings—level, radius, and threshold—in both chroma and luma.</span></span> <span data-ttu-id="65149-203">(См. раздел [Параметры фильтра изображений дксва](dxva-image-filter-settings.md).) Для каждого параметра вызовите [**имфвидеопроцессор:: жетфилтерингранже**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringrange) , чтобы получить диапазон возможных значений, и вызовите [**Имфвидеопроцессор:: жетфилтерингвалуе**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringvalue) , чтобы получить текущее значение.</span><span class="sxs-lookup"><span data-stu-id="65149-203">(See [DXVA Image Filter Settings](dxva-image-filter-settings.md).) For each setting, call [**IMFVideoProcessor::GetFilteringRange**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringrange) to get the range of possible values and call [**IMFVideoProcessor::GetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringvalue) to get the current value.</span></span>

6.  <span data-ttu-id="65149-204">Чтобы изменить параметр фильтра изображений, вызовите [**имфвидеопроцессор:: сетфилтерингвалуе**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue).</span><span class="sxs-lookup"><span data-stu-id="65149-204">To change an image filter setting, call [**IMFVideoProcessor::SetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue).</span></span>

## <a name="related-topics"></a><span data-ttu-id="65149-205">См. также</span><span class="sxs-lookup"><span data-stu-id="65149-205">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="65149-206">Улучшенный модуль подготовки видео</span><span class="sxs-lookup"><span data-stu-id="65149-206">Enhanced Video Renderer</span></span>](enhanced-video-renderer.md)
</dt> </dl>

 

 



