---
description: Инициализация объекта Контентинфо нового ASF-файла
ms.assetid: a4f6c90e-1b38-4c70-8bc5-e2e16af3d87a
title: Инициализация объекта Контентинфо нового ASF-файла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74826942700f4be8028075fcd9466414834eb8e2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104343332"
---
# <a name="initializing-the-contentinfo-object-of-a-new-asf-file"></a><span data-ttu-id="add4b-103">Инициализация объекта Контентинфо нового ASF-файла</span><span class="sxs-lookup"><span data-stu-id="add4b-103">Initializing the ContentInfo Object of a New ASF File</span></span>

<span data-ttu-id="add4b-104">После создания пустого объекта Контентинфо путем вызова функции [**мфкреатеасфконтентинфо**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) приложение должно вызвать [**Имфасфконтентинфо:: сетпрофиле**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-setprofile) , чтобы предоставить профиль кодирования.</span><span class="sxs-lookup"><span data-stu-id="add4b-104">After creating an empty ContentInfo object by calling the [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) function, the application must call [**IMFASFContentInfo::SetProfile**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-setprofile) to provide the encoding profile.</span></span> <span data-ttu-id="add4b-105">Сведения о создании профиля см. в разделе [Создание профиля ASF](creating-an-asf-profile.md).</span><span class="sxs-lookup"><span data-stu-id="add4b-105">For information about creating a profile, see [Creating an ASF Profile](creating-an-asf-profile.md).</span></span>

<span data-ttu-id="add4b-106">Прежде чем можно будет считать сведения из профиля, метод **сетпрофиле** должен проверить указанный объект профиля, проверив идентификаторы потоков или типы носителей.</span><span class="sxs-lookup"><span data-stu-id="add4b-106">Before information can be read from the profile, the **SetProfile** method must validate the specified profile object by checking the stream identifiers or media types.</span></span> <span data-ttu-id="add4b-107">Если профиль проходит проверку, создаются различные объекты заголовка, такие как объект свойств файла, объект свойств потоковой передачи, объект свойств потока и объект взаимного исключения.</span><span class="sxs-lookup"><span data-stu-id="add4b-107">If the profile passes the validation, various header objects are generated, such as the File Properties Object, the Stream Bitrate Properties Object, the Stream Properties Object, and the Mutual Exclusion Object.</span></span>

<span data-ttu-id="add4b-108">**Сетпрофиле** выполняет вычисление и задает Рекомендуемые значения для некоторых свойств, например предварительную отгрузку.</span><span class="sxs-lookup"><span data-stu-id="add4b-108">**SetProfile** computes and sets recommended values for certain properties, such as the preroll value.</span></span> <span data-ttu-id="add4b-109">Если это значение еще не задано, рекомендуемая величина предварительной версии в миллисекундах зависит от максимального окна буфера в сегменте утечки, указанного для потоков в профиле.</span><span class="sxs-lookup"><span data-stu-id="add4b-109">If this is not already set, the recommended preroll value in milliseconds depends on the maximum buffer window of the leaky bucket specified for the streams in the profile.</span></span> <span data-ttu-id="add4b-110">Аналогичным образом также устанавливаются минимальный и максимальный размеры пакетов данных.</span><span class="sxs-lookup"><span data-stu-id="add4b-110">Similarly, the minimum and maximum data packet sizes are also set.</span></span> <span data-ttu-id="add4b-111">Рекомендуемые значения могут переопределять размеры пакетов, заданные в профиле с помощью атрибутов.</span><span class="sxs-lookup"><span data-stu-id="add4b-111">The recommended values might override the packet sizes that are set on the profile through attributes.</span></span>

<span data-ttu-id="add4b-112">Поскольку файл находится в процессе создания, он классифицируется как тип вещания, который отмечается полем Flags объекта Properties (свойства файла).</span><span class="sxs-lookup"><span data-stu-id="add4b-112">Because the file is in the process of being created, the file is categorized as a broadcast type, which is denoted by the Flags field of the File Properties Object.</span></span> <span data-ttu-id="add4b-113">Для некоторых неизвестных значений, таких как количество пакетов данных, длительность воспроизведения и длительность отправки, устанавливается нулевое значение.</span><span class="sxs-lookup"><span data-stu-id="add4b-113">Certain unknown values such as the number of data packets, play duration, and send duration are set to zero.</span></span> <span data-ttu-id="add4b-114">Эти значения представлены атрибутами **MF \_ PD \_ ASF \_ xxx** и должны быть обновлены приложением после завершения создания файла.</span><span class="sxs-lookup"><span data-stu-id="add4b-114">These values are represented by **MF\_PD\_ASF\_xxx** attributes and must be updated by the application after file creation is complete.</span></span>

<span data-ttu-id="add4b-115">Указанный объект профиля заменяет существующий профиль, связанный с объектом Контентинфо, удаляет объекты заголовков, на которые имеются ссылки, и сбрасывает глобальные свойства файла, такие как предварительная проба и размер пакета данных.</span><span class="sxs-lookup"><span data-stu-id="add4b-115">The specified profile object replaces any existing profile associated with the ContentInfo object, removes the referenced header objects, and resets global file properties such as preroll and data packet size.</span></span>

<span data-ttu-id="add4b-116">Метод **сетпрофиле** также создает объект данных, представляющий объект данных ASF.</span><span class="sxs-lookup"><span data-stu-id="add4b-116">The **SetProfile** method also creates the data object that represents the ASF Data Object.</span></span> <span data-ttu-id="add4b-117">При повторном использовании объекта Контентинфо, который содержит сведения о каких-либо пакетах данных, происходит сбой **сетпрофиле** и возвращается \_ сообщение MF E, \_ уже \_ инициализированное с указанием того, что она уже связана с существующим объектом данных ASF.</span><span class="sxs-lookup"><span data-stu-id="add4b-117">If you reuse a ContentInfo object that includes information about any data packets, **SetProfile** fails and returns the MF\_E\_ALREADY\_INITIALIZED error indicating that it is already associated with an existing ASF Data Object.</span></span> <span data-ttu-id="add4b-118">По умолчанию для нового объекта Контентинфо число пакетов данных устанавливается равным нулю, а размер объекта данных устанавливается равным 50 байт.</span><span class="sxs-lookup"><span data-stu-id="add4b-118">By default, for a new ContentInfo object, the data packet count is set to zero and the data object size is set to 50 bytes.</span></span> <span data-ttu-id="add4b-119">При использовании мультиплексора для создания пакетов данных мультиплексор обновляет объект Контентинфо для отражения новых значений, таких как число пакетов данных.</span><span class="sxs-lookup"><span data-stu-id="add4b-119">If you use the multiplexer to generate data packets, the multiplexer updates the ContentInfo object to reflect new values such as the data packet count.</span></span> <span data-ttu-id="add4b-120">Дополнительные сведения о создании пакетов данных см. в разделе [Создание новых пакетов данных ASF](generating-new-asf-data-packets.md).</span><span class="sxs-lookup"><span data-stu-id="add4b-120">For more information about data packet generation, see [Generating New ASF Data Packets](generating-new-asf-data-packets.md).</span></span>

<span data-ttu-id="add4b-121">После добавления всех объектов заголовка в окончательный объект заголовка ASF можно получить общий размер заголовка, вызвав [**имфасфконтентинфо:: жесеадерсизе**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getheadersize).</span><span class="sxs-lookup"><span data-stu-id="add4b-121">After all the Header Objects are added to the final ASF Header Object, the total header size can be retrieved by calling [**IMFASFContentInfo::GetHeaderSize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getheadersize).</span></span> <span data-ttu-id="add4b-122">Этот размер включает исходный размер объекта данных.</span><span class="sxs-lookup"><span data-stu-id="add4b-122">This size includes the initial data object size.</span></span>

## <a name="related-topics"></a><span data-ttu-id="add4b-123">См. также</span><span class="sxs-lookup"><span data-stu-id="add4b-123">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="add4b-124">Задание свойств в объекте Контентинфо</span><span class="sxs-lookup"><span data-stu-id="add4b-124">Setting Properties in the ContentInfo Object</span></span>](setting-properties-in-the-contentinfo-object.md)
</dt> <dt>

[<span data-ttu-id="add4b-125">Запись объекта заголовка ASF для нового файла</span><span class="sxs-lookup"><span data-stu-id="add4b-125">Writing an ASF Header Object for a New File</span></span>](writing-an-asf-header-object-for-a-new-file.md)
</dt> </dl>

 

 



