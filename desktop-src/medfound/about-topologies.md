---
description: О топологиях
ms.assetid: 4f69b099-0ca7-4ea6-8412-0f1ea02e1600
title: О топологиях
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35008d839e8054554370039dd13297ae7a1f0b0a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104553573"
---
# <a name="about-topologies"></a><span data-ttu-id="29bdf-103">О топологиях</span><span class="sxs-lookup"><span data-stu-id="29bdf-103">About Topologies</span></span>

<span data-ttu-id="29bdf-104">Топология — это объект, представляющий поток данных в конвейере.</span><span class="sxs-lookup"><span data-stu-id="29bdf-104">A topology is an object that represents how data flows in the pipeline.</span></span> <span data-ttu-id="29bdf-105">Приложение создает топологию для описания пути, который каждый поток получает от источника носителя к приемнику мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="29bdf-105">An application creates a topology to describe the path that each stream takes from the media source to a media sink.</span></span> <span data-ttu-id="29bdf-106">Приложение передает топологию сеансу мультимедиа, а сеанс мультимедиа использует топологию для управления потоком данных.</span><span class="sxs-lookup"><span data-stu-id="29bdf-106">The application passes the topology to the Media Session, and the Media Session uses the topology to control the data flow.</span></span>

<span data-ttu-id="29bdf-107">Компоненты обработки данных в конвейере (источники мультимедиа, преобразования и приемники носителей) представлены в топологии как *узлы*.</span><span class="sxs-lookup"><span data-stu-id="29bdf-107">The data-processing components in the pipeline (media sources, transforms, and media sinks) are represented in the topology as *nodes*.</span></span> <span data-ttu-id="29bdf-108">Поток данных от одного компонента к другому представлен соединением между узлами.</span><span class="sxs-lookup"><span data-stu-id="29bdf-108">The flow of data from one component to another is represented by a connection between the nodes.</span></span> <span data-ttu-id="29bdf-109">Определены следующие типы узлов:</span><span class="sxs-lookup"><span data-stu-id="29bdf-109">The following node types are defined:</span></span>

-   <span data-ttu-id="29bdf-110">Исходный узел: представляет поток мультимедиа в источнике мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="29bdf-110">Source node: Represents a media stream on a media source.</span></span>
-   <span data-ttu-id="29bdf-111">Узел преобразования: представляет Media Foundation преобразование (MFT).</span><span class="sxs-lookup"><span data-stu-id="29bdf-111">Transform node: Represents a Media Foundation transform (MFT).</span></span>
-   <span data-ttu-id="29bdf-112">Выходной узел: представляет приемник потока в приемнике мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="29bdf-112">Output node: Represents a stream sink on a media sink.</span></span>
-   <span data-ttu-id="29bdf-113">Узел tee: представляет вилку в потоке.</span><span class="sxs-lookup"><span data-stu-id="29bdf-113">Tee node: Represents a fork in the stream.</span></span> <span data-ttu-id="29bdf-114">Узлы tee являются исключением из правила, которое узел представляет объект конвейера.</span><span class="sxs-lookup"><span data-stu-id="29bdf-114">Tee nodes are an exception to the rule that a node represents a pipeline object.</span></span> <span data-ttu-id="29bdf-115">В отличие от других типов узлов, узел tee просто направляет поток данных.</span><span class="sxs-lookup"><span data-stu-id="29bdf-115">Unlike other node types, the tee node simply directs the flow of data.</span></span>

<span data-ttu-id="29bdf-116">Действующая топология должна содержать по крайней мере один исходный узел, подключенный к выходному узлу, возможно, через один или несколько узлов преобразования.</span><span class="sxs-lookup"><span data-stu-id="29bdf-116">A functioning topology must contain at least one source node connected to an output node, possibly through one or more transform nodes.</span></span> <span data-ttu-id="29bdf-117">Например, на следующей диаграмме показана простая топология с одним потоком.</span><span class="sxs-lookup"><span data-stu-id="29bdf-117">For example, the following diagram shows a simple topology with one stream.</span></span>

![Схема, на которой показана топология с одним потоком.](images/topology01.png)

<span data-ttu-id="29bdf-119">Для воспроизведения файла узел преобразования может представлять декодер, а выходной узел — модуль подготовки звука или видео.</span><span class="sxs-lookup"><span data-stu-id="29bdf-119">For file playback, the transform node might represent a decoder and the output node would represent the audio or video renderer.</span></span> <span data-ttu-id="29bdf-120">Для кодировки файлов узел преобразования будет представлять кодировщик, а выходной узел будет представлять приемник архива, например приемник файлов ASF.</span><span class="sxs-lookup"><span data-stu-id="29bdf-120">For file encoding, the transform node would represent an encoder and the output node would represent an archive sink, such as the ASF file sink.</span></span>

<span data-ttu-id="29bdf-121">Если подключены два узла, узел, создающий данные, называется *вышестоящим* узлом, а узел, который получает данные, называется *подчиненным* узлом.</span><span class="sxs-lookup"><span data-stu-id="29bdf-121">If two nodes are connected, the node that produces data is called the *upstream* node, and the node that receives data is called the *downstream* node.</span></span> <span data-ttu-id="29bdf-122">Например, на предыдущей схеме исходный узел является вышестоящим из узла преобразования.</span><span class="sxs-lookup"><span data-stu-id="29bdf-122">For example, in the previous diagram, the source node is upstream from the transform node.</span></span>

<span data-ttu-id="29bdf-123">В паре Соединенных узлов точка подключения на вышестоящем узле называется *выходом*.</span><span class="sxs-lookup"><span data-stu-id="29bdf-123">In a pair of connected nodes, the connection point on the upstream node is called an *output*.</span></span> <span data-ttu-id="29bdf-124">Точка соединения на подчиненном узле называется *входными данными*.</span><span class="sxs-lookup"><span data-stu-id="29bdf-124">The connection point on the downstream node is called an *input*.</span></span> <span data-ttu-id="29bdf-125">На следующей диаграмме показана пара узлов с точками соединения, а также поток данных между ними.</span><span class="sxs-lookup"><span data-stu-id="29bdf-125">The following diagram shows a pair of nodes with their connection points, and the flow of data between them.</span></span> <span data-ttu-id="29bdf-126">Точки соединения не представлены в топологии как отдельные объекты.</span><span class="sxs-lookup"><span data-stu-id="29bdf-126">The connection points are not represented as separate objects in the topology.</span></span> <span data-ttu-id="29bdf-127">Они указываются по значению индекса для объекта node.</span><span class="sxs-lookup"><span data-stu-id="29bdf-127">They are specified by index value on the node object.</span></span>

![Диаграмма, на которой показаны два подключенных узла.](images/topology04.png)

<span data-ttu-id="29bdf-129">Исходный узел не может иметь входных данных.</span><span class="sxs-lookup"><span data-stu-id="29bdf-129">A source node cannot have any inputs.</span></span> <span data-ttu-id="29bdf-130">Таким образом, не могут быть передаваться узлы из исходного узла.</span><span class="sxs-lookup"><span data-stu-id="29bdf-130">Therefore, there cannot be any nodes upstream from a source node.</span></span> <span data-ttu-id="29bdf-131">Аналогичным образом выходной узел не может иметь выходные данные, и ни один из узлов не может быть подчинен выходного узла.</span><span class="sxs-lookup"><span data-stu-id="29bdf-131">Similarly, an output node cannot have outputs, and there cannot be any nodes downstream from an output node.</span></span> <span data-ttu-id="29bdf-132">Цепочка узлов из исходного узла в выходной узел называется *ветвью* топологии.</span><span class="sxs-lookup"><span data-stu-id="29bdf-132">A chain of nodes from a source node to an output node is called a *branch* of the topology.</span></span> <span data-ttu-id="29bdf-133">На первой схеме в этом разделе показана топология с одной ветвью.</span><span class="sxs-lookup"><span data-stu-id="29bdf-133">The first diagram in this topic shows a topology with a single branch.</span></span> <span data-ttu-id="29bdf-134">Обычно существует одна ветвь на поток.</span><span class="sxs-lookup"><span data-stu-id="29bdf-134">Generally there is one branch per stream.</span></span> <span data-ttu-id="29bdf-135">Например, для воспроизведения файла с одним звуковым потоком и одним видеопотоком требуется топология с двумя ветвями.</span><span class="sxs-lookup"><span data-stu-id="29bdf-135">To play a file with one audio stream and one video stream, for example, requires a topology with two branches.</span></span>

## <a name="partial-topologies"></a><span data-ttu-id="29bdf-136">Частичные топологии</span><span class="sxs-lookup"><span data-stu-id="29bdf-136">Partial Topologies</span></span>

<span data-ttu-id="29bdf-137">Полная или *полная* топология содержит узел для каждого необходимого объекта конвейера.</span><span class="sxs-lookup"><span data-stu-id="29bdf-137">A complete or *full* topology contains a node for every pipeline object that is needed.</span></span> <span data-ttu-id="29bdf-138">Однако приложению не всегда нужно создавать полную топологию.</span><span class="sxs-lookup"><span data-stu-id="29bdf-138">However, the application does not always need to create a full topology.</span></span> <span data-ttu-id="29bdf-139">Вместо этого создается *частичная* топология, в которой пропущен один или несколько узлов преобразования.</span><span class="sxs-lookup"><span data-stu-id="29bdf-139">Instead, it creates a *partial* topology that omits one or more transform nodes.</span></span>

<span data-ttu-id="29bdf-140">Сеанс мультимедиа завершает топологию с помощью объекта, называемого *загрузчиком топологии*.</span><span class="sxs-lookup"><span data-stu-id="29bdf-140">The Media Session completes the topology by using an object called the *topology loader*.</span></span> <span data-ttu-id="29bdf-141">Загрузчик топологии преобразует частичные топологии в полные топологии путем вставки необходимых преобразований.</span><span class="sxs-lookup"><span data-stu-id="29bdf-141">The topology loader converts partial topologies into full topologies by inserting the needed transforms.</span></span> <span data-ttu-id="29bdf-142">Процесс преобразования называется *разрешением* топологии.</span><span class="sxs-lookup"><span data-stu-id="29bdf-142">The process of conversion is called *resolving* the topology.</span></span>

<span data-ttu-id="29bdf-143">Например, для воспроизведения закодированного звукового потока в топологии должен быть декодер между исходным и выходным узлами.</span><span class="sxs-lookup"><span data-stu-id="29bdf-143">For example, to play an encoded audio stream, the topology must have a decoder between the source and output nodes.</span></span> <span data-ttu-id="29bdf-144">Приложение создает частичную топологию, которая подключает исходный узел непосредственно к выходному узлу без декодера.</span><span class="sxs-lookup"><span data-stu-id="29bdf-144">The application creates a partial topology that connects the source node directly to the output node, without the decoder.</span></span> <span data-ttu-id="29bdf-145">Загрузчик топологии проверяет форматы потоков, находит правильный декодер и вставляет узел преобразования в топологию.</span><span class="sxs-lookup"><span data-stu-id="29bdf-145">The topology loader examines the stream formats, finds the right decoder, and inserts a transform node into the topology.</span></span>

<span data-ttu-id="29bdf-146">На следующей диаграмме показана частичная топология, созданная приложением.</span><span class="sxs-lookup"><span data-stu-id="29bdf-146">The following diagram shows the partial topology created by the application.</span></span>

![Диаграмма, которая показывает частичный узел с исходным узлом и выходным узлом.](images/topology02.png)

<span data-ttu-id="29bdf-148">На следующей схеме показана полная топология после того, как загрузчик топологии разрешит ее.</span><span class="sxs-lookup"><span data-stu-id="29bdf-148">The next diagram shows the full topology after the topology loader resolves it.</span></span> <span data-ttu-id="29bdf-149">В этом примере загрузчик топологии вставил узел преобразования для декодера.</span><span class="sxs-lookup"><span data-stu-id="29bdf-149">In this example, the topology loader has inserted a transform node for the decoder.</span></span>

![Схема, на которой показана полная топология.](images/topology03.png)

<span data-ttu-id="29bdf-151">В текущей версии Media Foundation загрузчик топологии поддерживает топологии для воспроизведения.</span><span class="sxs-lookup"><span data-stu-id="29bdf-151">In the current version of Media Foundation, the topology loader supports topologies for playback.</span></span> <span data-ttu-id="29bdf-152">Для кодирования файлов и других сценариев приложение должно создать полную топологию.</span><span class="sxs-lookup"><span data-stu-id="29bdf-152">For file encoding and other scenarios, the application must construct a full topology.</span></span>

<span data-ttu-id="29bdf-153">Приложения также могут создать загрузчик топологии и использовать его напрямую.</span><span class="sxs-lookup"><span data-stu-id="29bdf-153">Applications can also create the topology loader and use it directly.</span></span> <span data-ttu-id="29bdf-154">Например, можно использовать загрузчик топологии для разрешения частичной топологии, а затем изменить полную топологию перед передачей в сеанс мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="29bdf-154">For example, you can use the topology loader to resolve a partial topology and then modify the full topology before giving it to the Media Session.</span></span> <span data-ttu-id="29bdf-155">Чтобы создать загрузчик топологии, вызовите [**мфкреатетополоадер**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatetopoloader).</span><span class="sxs-lookup"><span data-stu-id="29bdf-155">To create the topology loader, call [**MFCreateTopoLoader**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatetopoloader).</span></span>

## <a name="related-topics"></a><span data-ttu-id="29bdf-156">См. также</span><span class="sxs-lookup"><span data-stu-id="29bdf-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="29bdf-157">Топологии</span><span class="sxs-lookup"><span data-stu-id="29bdf-157">Topologies</span></span>](topologies.md)
</dt> </dl>

 

 



