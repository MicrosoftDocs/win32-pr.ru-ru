---
description: Компоненты сетевого источника
ms.assetid: a4e20ecb-c145-4823-ae59-f6fc88593d86
title: Компоненты сетевого источника
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8e937a97cf743740d9cebf84ad477c52cdee5083
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104571041"
---
# <a name="network-source-features"></a><span data-ttu-id="9e9f3-103">Компоненты сетевого источника</span><span class="sxs-lookup"><span data-stu-id="9e9f3-103">Network Source Features</span></span>

<span data-ttu-id="9e9f3-104">Сетевой источник предоставляет базовую реализацию для потоковой передачи файлов мультимедиа и предоставляет интерфейс [**имфмедиасаурце**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-104">The network source provides the base implementation for streaming media files and exposes the [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) interface.</span></span> <span data-ttu-id="9e9f3-105">Конкретная реализация сетевого источника зависит от протокола, используемого для открытия источника, такого как RTSP или HTTP.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-105">The specific network source implementation depends on the protocol used to open the source such as RTSP or HTTP.</span></span> <span data-ttu-id="9e9f3-106">Сетевые источники, зависящие от протокола, расширяют базовую функциональность сети.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-106">The protocol-specific network sources extend the basic network functionality.</span></span> <span data-ttu-id="9e9f3-107">Сведения о поддерживаемых схемах и протоколах см. в разделе [Поддерживаемые протоколы](supported-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="9e9f3-107">For information about the supported schemes and protocols, see [Supported Protocols](supported-protocols.md).</span></span>

<span data-ttu-id="9e9f3-108">Источник сети:</span><span class="sxs-lookup"><span data-stu-id="9e9f3-108">The network source:</span></span>

-   <span data-ttu-id="9e9f3-109">Реализует такие функции, как кэширование, обнаружение прокси-сервера и автоматическое повторное подключение.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-109">Implements features such as caching, proxy detection, and auto-reconnection.</span></span>
-   <span data-ttu-id="9e9f3-110">Преобразует независимые от протокола вызовы из сопоставителя источников в вызовы, относящиеся к протоколу.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-110">Converts protocol-independent calls from the source resolver to protocol-specific calls.</span></span>
-   <span data-ttu-id="9e9f3-111">Взаимодействует с уровнем сокета и операционной системой.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-111">Interacts with the socket layer and the operating system.</span></span> <span data-ttu-id="9e9f3-112">Анализирует описание SDP и использует его в качестве данных конфигурации, а также считывает потоковые данные с базового уровня сокетов.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-112">Parses the SDP description and uses it as configuration data, and reads stream data from the underlying sockets layer.</span></span> <span data-ttu-id="9e9f3-113">При получении сетевой источник отвечает за Переупорядочение и запрос повторной передачи пакетов.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-113">When receiving, the network source is responsible for reordering and requesting retransmissions of packets.</span></span>

## <a name="network-source-creation"></a><span data-ttu-id="9e9f3-114">Создание источника сети</span><span class="sxs-lookup"><span data-stu-id="9e9f3-114">Network Source Creation</span></span>

<span data-ttu-id="9e9f3-115">Создание источника мультимедиа для источника из сети не отличается от источника носителя для локального файла.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-115">Creating a media source for a source from the network is not different from a media source for a local file.</span></span> <span data-ttu-id="9e9f3-116">Приложение передает URL-адрес источника в методы [сопоставителя источника](source-resolver.md) , такие как [**Имфсаурцересолвер:: креатеобжектфромурл**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) или [**имфсаурцересолвер:: БЕГИНКРЕАТЕОБЖЕКТФРОМУРЛ**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) , и задает \_ флаг MF Resolve \_ MEDIASOURCE.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-116">The application passes the URL for the source to [Source Resolver](source-resolver.md) methods such as [**IMFSourceResolver::CreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) or [**IMFSourceResolver::BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) and specifies the MF\_RESOLUTION\_MEDIASOURCE flag.</span></span> <span data-ttu-id="9e9f3-117">Дополнительные сведения об использовании этого флага см. [в разделе Использование сопоставителя источников](using-the-source-resolver.md).</span><span class="sxs-lookup"><span data-stu-id="9e9f3-117">For more information about using this flag, see [Using the Source Resolver](using-the-source-resolver.md).</span></span>

<span data-ttu-id="9e9f3-118">В зависимости от схемы, предоставляемой приложением, сопоставитель источников загружает соответствующий объект обработчика схемы, который предоставляет интерфейс [**имфсчемехандлер**](/windows/desktop/api/mfidl/nn-mfidl-imfschemehandler) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-118">Depending on the scheme provided by the application, the source resolver loads the appropriate the scheme handler object, which exposes the [**IMFSchemeHandler**](/windows/desktop/api/mfidl/nn-mfidl-imfschemehandler) interface.</span></span> <span data-ttu-id="9e9f3-119">Приложение также может напрямую использовать обработчик схемы для создания сетевого источника путем вызова [**имфсчемехандлер:: бегинкреатеобжект**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject).</span><span class="sxs-lookup"><span data-stu-id="9e9f3-119">The application can also use the scheme handler directly to create the network source by calling [**IMFSchemeHandler::BeginCreateObject**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject).</span></span>

<span data-ttu-id="9e9f3-120">Дополнительные сведения см. в разделе [обработчики схем и обработчики Byte-Stream](scheme-handlers-and-byte-stream-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="9e9f3-120">For more information, see [Scheme Handlers and Byte-Stream Handlers](scheme-handlers-and-byte-stream-handlers.md).</span></span>

<span data-ttu-id="9e9f3-121">Media Foundation не поддерживает байтовые потоки для сетевых источников.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-121">Media Foundation does not support byte streams for network sources.</span></span> <span data-ttu-id="9e9f3-122">Объект байтового потока поддерживается только в сценарии загруженного содержимого.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-122">The byte stream object is only supported in the downloaded content scenario.</span></span> <span data-ttu-id="9e9f3-123">Все данные передаются как можно быстрее, чтобы их можно было сохранить в виде файла на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-123">All the data is transmitted as quickly as possible so that it can be saved as a file on the local machine.</span></span> <span data-ttu-id="9e9f3-124">веб-серверы предоставляют Скачанные данные.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-124">web servers provide downloaded data.</span></span> <span data-ttu-id="9e9f3-125">После начала загрузки обмен данными между клиентом и сервером отсутствует.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-125">There is no communication from the client to the server after the download begins.</span></span> <span data-ttu-id="9e9f3-126">В этом случае используется протокол HTTP download.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-126">In this case the HTTP download protocol is used.</span></span>

<span data-ttu-id="9e9f3-127">Если приложение запрашивает у сопоставителя источника создание объекта байтового потока для схем "http:", "MMS:" или "RTSP:", вызов завершается с \_ \_ ошибкой неподдерживаемой схемы MF E \_ .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-127">If the application requests the source resolver to create a byte stream object for "http:", "mms:", or "rtsp:" schemes, then the call fails with the MF\_E\_UNSUPPORTED\_SCHEME error.</span></span>

> [!Note]  
> <span data-ttu-id="9e9f3-128">В Windows 7 сетевой источник поддерживает файлы станции Windows Media (. NSC).</span><span class="sxs-lookup"><span data-stu-id="9e9f3-128">In Windows 7, the network source supports Windows Media Station files (.NSC).</span></span> <span data-ttu-id="9e9f3-129">Эти файлы используются для многоадресной потоковой передачи содержимого мультимедиа по сети.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-129">These files are used in multicast streaming of media content over a network.</span></span> <span data-ttu-id="9e9f3-130">Создание сетевого источника для указанного. NSC файл, приложение должно использовать сопоставитель источника.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-130">To create the network source for a specified .NSC file, the application must use the source resolver.</span></span>

 

<span data-ttu-id="9e9f3-131">Если приложение использует обработчик схемы, то асинхронный вызов игнорирует параметр *dwFlags* и возвращает указатель на источник сети при завершении.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-131">If the application is using the scheme handler, then the asynchronous call ignores the *dwFlags* parameter and returns a pointer to the network source on completion.</span></span>

<span data-ttu-id="9e9f3-132">На следующем рисунке показан поток данных для потоковой передачи мультимедиа с использованием сетевого источника.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-132">The following illustration shows the data flow for media streaming using the network source.</span></span>

![Блок-схема, показывающая пути от приложения к серверу потоковой передачи с циклом между источником сети и сеансом мультимедиа](images/3f9186ea-53ed-4a31-a097-92f39fa08624.gif)

## <a name="network-source-configuration"></a><span data-ttu-id="9e9f3-134">Конфигурация источника сети</span><span class="sxs-lookup"><span data-stu-id="9e9f3-134">Network Source Configuration</span></span>

<span data-ttu-id="9e9f3-135">В этом разделе описываются функции, поддерживаемые сетевым источником и связанными параметрами конфигурации.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-135">This topic describes the features supported by the network source and the associated configuration options.</span></span> <span data-ttu-id="9e9f3-136">Приложение может настроить сетевой источник при создании объекта источника сети.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-136">An application can configure the network source when creating the network source object.</span></span> <span data-ttu-id="9e9f3-137">Эти параметры хранятся в объекте **ипропертисторе** , который приложение должно передать в параметр *ппропс* методов сопоставителя источника или [**имфсчемехандлер:: бегинкреатеобжект**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject).</span><span class="sxs-lookup"><span data-stu-id="9e9f3-137">These options are stored in an **IPropertyStore** object, which the application must pass in the *pProps* parameter of the source resolver methods or [**IMFSchemeHandler::BeginCreateObject**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject).</span></span>

### <a name="auto-reconnect"></a><span data-ttu-id="9e9f3-138">Автоматическое повторное подключение</span><span class="sxs-lookup"><span data-stu-id="9e9f3-138">Auto-Reconnect</span></span>

<span data-ttu-id="9e9f3-139">Функция автоматического повторного подключения сетевого источника позволяет клиенту автоматически подключаться к серверу мультимедиа при сбое TCP-соединения с сервером или если клиент не получает пакеты.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-139">The auto-reconnect feature of the network source enables a client to reconnect to the media server automatically when the TCP connection to the server fails or the client fails to receive packets.</span></span> <span data-ttu-id="9e9f3-140">При сбое подключения источник сети пытается повторно подключиться к серверу мультимедиа с использованием той же конфигурации, которая использовалась в предыдущем соединении.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-140">When connection fails, the network source attempts to reconnect to the media server using the same configuration that was used in the previous connection.</span></span> <span data-ttu-id="9e9f3-141">Процесс повторного подключения является асинхронным.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-141">The reconnection process is asynchronous.</span></span> <span data-ttu-id="9e9f3-142">Сетевой источник создает событие [мереконнектстарт](mereconnectstart.md) , когда оно начинает повторное подключение, и событие [мереконнектенд](mereconnectend.md) при успешном или неудачном завершении подключения.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-142">The network source raises the [MEReconnectStart](mereconnectstart.md) event when it begins reconnection and the [MEReconnectEnd](mereconnectend.md) event when the reconnection succeeds or fails.</span></span>

<span data-ttu-id="9e9f3-143">Если количество повторных попыток подключения превышает максимальное значение, указанное в свойстве [**мфнетсаурце \_ аутореконнектлимит**](mfnetsource-autoreconnectlimit-property.md) , операция повторного подключения отменяется.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-143">If the number of reconnection attempts exceeds the maximum value specified by the [**MFNETSOURCE\_AUTORECONNECTLIMIT**](mfnetsource-autoreconnectlimit-property.md) property, the reconnection operation is canceled.</span></span> <span data-ttu-id="9e9f3-144">Число попыток повторного подключения хранится в свойстве [**мфнетсаурце \_ аутореконнектпрогресс**](mfnetsource-autoreconnectprogress-property.md) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-144">The number of reconnection attempts is stored in the [**MFNETSOURCE\_AUTORECONNECTPROGRESS**](mfnetsource-autoreconnectprogress-property.md) property.</span></span>

<span data-ttu-id="9e9f3-145">Автоматическое повторное подключение обеспечивает плавное воспроизведение содержимого мультимедиа даже при сбое TCP-подключения к серверу мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-145">Auto-reconnect enables smooth playback of media content even when the TCP connection to the media server fails.</span></span> <span data-ttu-id="9e9f3-146">Для плавного воспроизведения клиент должен иметь достаточно данных (по крайней мере 1 – 2 минуты) в кэше для продолжения воспроизведения до повторного подключения.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-146">For a smooth playback experience, the client must have sufficient data, at least 1 to 2 minutes, in its cache to continue playback until reconnection.</span></span> <span data-ttu-id="9e9f3-147">В свойстве [**мфнетсаурце \_ максбуффертимемс**](mfnetsource-maxbuffertimems-property.md) можно задать максимальный объем данных, которые могут быть помещены в буфер сетевого источника.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-147">The maximum amount of data that the network source can buffer can be set in the [**MFNETSOURCE\_MAXBUFFERTIMEMS**](mfnetsource-maxbuffertimems-property.md) property.</span></span>

### <a name="fast-streaming"></a><span data-ttu-id="9e9f3-148">Быстрая потоковая передача</span><span class="sxs-lookup"><span data-stu-id="9e9f3-148">Fast Streaming</span></span>

<span data-ttu-id="9e9f3-149">Клиент источника сети запрашивает сервер для потоковой передачи данных в начале содержимого с более высокой скоростью, чем указано в скорости потока содержимого.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-149">The network source client requests the server to stream some of the data at the beginning of the content at a faster rate than that specified by the bit rate of the content.</span></span> <span data-ttu-id="9e9f3-150">Если на сервере включен *Быстрый запуск* , сервер отправляет поток ускорения по скорости потока, чтобы клиент мог буферизовать достаточное количество данных быстрее, чем в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-150">If *Fast Startup* is enabled on the server, the server sends an accelerated bit-rate stream so that the client can buffer a sufficient amount of data faster than in real time.</span></span> <span data-ttu-id="9e9f3-151">Это повышает удобство работы пользователей за счет минимизации задержек начальной буферизации, которые могут быть вызваны различными факторами, такими как низкая скорость клиентского компьютера, сеть и доступная пропускная способность.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-151">This improves user experience by minimizing initial buffering delays, which can be caused by various factors such as low speed of the client computer or the network, and available bandwidth.</span></span>

<span data-ttu-id="9e9f3-152">Чтобы указать объем данных для ускоренной потоковой передачи, которые клиент может запрашивать, задайте свойство [**мфнетсаурце \_ акцелератедстреамингдуратион**](mfnetsource-acceleratedstreamingduration-property.md) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-152">To specify the amount of fast-streaming data that the client can request, set the [**MFNETSOURCE\_ACCELERATEDSTREAMINGDURATION**](mfnetsource-acceleratedstreamingduration-property.md) property.</span></span> <span data-ttu-id="9e9f3-153">Если сетевой источник использует UDP в качестве транспортного протокола, укажите максимальный объем данных для быстрой потоковой передачи, задав вместо этого свойство [**мфнетсаурце \_ максудпакцелератедстреамингдуратион**](mfnetsource-maxudpacceleratedstreamingduration-property.md) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-153">If the network source is using UDP as the transport protocol, specify the maximum amount of fast-streaming data by setting the [**MFNETSOURCE\_MAXUDPACCELERATEDSTREAMINGDURATION**](mfnetsource-maxudpacceleratedstreamingduration-property.md) property instead.</span></span>

<span data-ttu-id="9e9f3-154">Ускоренная потоковая передача на клиенте также возможна с помощью функции *быстрого кэширования* — потоковая передача содержимого по запросу выполняется быстрее, чем в режиме реального времени, и кэширование данных в локальном кэше клиента.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-154">Fast streaming on the client is also possible through the *Fast Cache* feature—streaming on-demand content faster than real time and caching data on the client's local cache.</span></span> <span data-ttu-id="9e9f3-155">Чтобы использовать этот тип быстрой потоковой передачи, на сетевом источнике должен быть включен быстрый кэш, который должен поддерживаться сервером.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-155">To use this type of fast streaming, Fast Cache must be enabled on the network source, and the server must support it.</span></span> <span data-ttu-id="9e9f3-156">Когда клиент запрашивает содержимое с сервера, сетевой источник сначала проверяет, уже находится ли содержимое в кэше клиента.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-156">When the client requests content from the server, the network source first checks to see whether the content is already in the client's cache.</span></span> <span data-ttu-id="9e9f3-157">Если содержимое находится в локальном кэше клиента и срок его действия не истек, он готовится к просмотру.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-157">If the content is in the client's local cache and has not expired, it is rendered.</span></span> <span data-ttu-id="9e9f3-158">Если содержимое не находится в локальном кэше или уже истек, содержимое передается в поток и кэшируется, а сетевой источник воспроизводит его из локального кэша.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-158">If the content is not in the local cache or has already expired, the content is streamed and cached, and the network source plays it from the local cache.</span></span> <span data-ttu-id="9e9f3-159">В последующих запросах для списков воспроизведения только отсутствующие записи кэшируются, а затем воспроизводятся.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-159">In subsequent requests, for playlists, only missing entries are cached and then played.</span></span> <span data-ttu-id="9e9f3-160">Если запись списка воспроизведения уже находится в локальном кэше клиента, она воспроизводится и не кэшируется снова.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-160">If a playlist entry is already in the client's local cache, it is played from there and not cached again.</span></span>

<span data-ttu-id="9e9f3-161">По умолчанию быстрый кэш включен на клиентском сетевом источнике.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-161">By default, Fast Cache is enabled on the network source client.</span></span> <span data-ttu-id="9e9f3-162">Однако следующие факторы также определяют, используется ли эта функция:</span><span class="sxs-lookup"><span data-stu-id="9e9f3-162">However, the following factors also determine whether the feature is used:</span></span>

-   <span data-ttu-id="9e9f3-163">Клиент должен иметь лишнюю пропускную способность для скачивания и кэширования содержимого быстрее, чем обычная скорость.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-163">The client must have extra bandwidth available to download and cache the content faster than the normal speed.</span></span>
-   <span data-ttu-id="9e9f3-164">На клиенте должно быть достаточно места на диске.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-164">The client must have sufficient disk space.</span></span> <span data-ttu-id="9e9f3-165">Если на клиенте имеется менее 100 МБ свободного дискового пространства после кэширования запрошенного содержимого по запросу, он не кэшируется, но передается в потоковом режиме и подготавливается к просмотру одновременно.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-165">If the client has less than 100 MB of free disk space after caching the requested on-demand content, it is not cached, but is streamed and rendered simultaneously.</span></span>

<span data-ttu-id="9e9f3-166">Функция быстрого кэширования управляется свойством [**мфнетсаурце \_ качинаблед**](mfnetsource-cacheenabled-property.md) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-166">The Fast Cache feature is controlled by the [**MFNETSOURCE\_CACHEENABLED**](mfnetsource-cacheenabled-property.md) property.</span></span>

### <a name="buffer-management"></a><span data-ttu-id="9e9f3-167">Управление буферами</span><span class="sxs-lookup"><span data-stu-id="9e9f3-167">Buffer Management</span></span>

<span data-ttu-id="9e9f3-168">Сетевой источник обеспечивает эффективное управление буферами, которое отслеживает состояние буфера на клиенте.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-168">The network source provides efficient buffer management that monitors the buffer state on the client.</span></span> <span data-ttu-id="9e9f3-169">По умолчанию источник сети помещает в буфер данные за 5 секунд при запуске.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-169">By default, the network source buffers 5 seconds of data at startup.</span></span> <span data-ttu-id="9e9f3-170">Это значение можно настроить, задав свойство [**мфнетсаурце \_ буфферингтиме**](mfnetsource-bufferingtime-property.md) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-170">This value can be configured by setting the [**MFNETSOURCE\_BUFFERINGTIME**](mfnetsource-bufferingtime-property.md) property.</span></span> <span data-ttu-id="9e9f3-171">Исходя из значения этого свойства, источник сети вычислит размер буфера, достаточный для обеспечения плавного и непрерывного воспроизведения мультимедийного содержимого.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-171">Based on this property value, the network source computes the buffer size that is sufficient to ensure smooth and uninterrupted playback of the media content.</span></span> <span data-ttu-id="9e9f3-172">Если это свойство имеет значение 0, управление буфером отключено.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-172">If this property is set to 0, buffer management is disabled.</span></span> <span data-ttu-id="9e9f3-173">Когда объем содержимого в буфере мал, источник сети начинает буферизацию и вызывает событие [мебуфферингстартед](mebufferingstarted.md) , чтобы указать, что буферизация началась.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-173">When the amount of content in the buffer is low, the network source starts buffering and raises the [MEBufferingStarted](mebufferingstarted.md) event to indicate that buffering has begun.</span></span> <span data-ttu-id="9e9f3-174">После получения этого события конвейер прекращает подготовку к просмотру.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-174">Upon receiving this event, the pipeline stops rendering.</span></span> <span data-ttu-id="9e9f3-175">Когда буферизация завершена, источник сети создает событие [мебуфферингстоппед](mebufferingstopped.md) , и клиент может снова начать подготовку к просмотру.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-175">When buffering is complete, the network source raises the [MEBufferingStopped](mebufferingstopped.md) event, and the client can start rendering again.</span></span>

<span data-ttu-id="9e9f3-176">Клиент начинает подготовку к просмотру содержимого после того, как он накапливает объем данных, указываемый размером буфера первого образца.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-176">The client starts rendering the content after it has accumulated the amount of data indicated by the buffer size of the first sample.</span></span> <span data-ttu-id="9e9f3-177">Если это значение меньше, чем размер вычисляемого буфера, воспроизведение начинается немедленно.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-177">If this value is lower than the calculated buffer size, then the playback starts immediately.</span></span> <span data-ttu-id="9e9f3-178">Такое поведение очень похоже на функцию быстрого запуска.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-178">This behavior is very similar to the Fast Startup feature.</span></span>

<span data-ttu-id="9e9f3-179">Свойство [**мфнетсаурце \_ максбуффертимемс**](mfnetsource-maxbuffertimems-property.md) хранит максимальный объем данных, которые могут быть помещены в буфер.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-179">The [**MFNETSOURCE\_MAXBUFFERTIMEMS**](mfnetsource-maxbuffertimems-property.md) property stores the maximum amount of data that can be buffered.</span></span>

### <a name="bandwidth-selection"></a><span data-ttu-id="9e9f3-180">Выбор пропускной способности</span><span class="sxs-lookup"><span data-stu-id="9e9f3-180">Bandwidth Selection</span></span>

<span data-ttu-id="9e9f3-181">Когда клиент подключается к серверу мультимедиа, в рамках настройки подключения сетевой источник выполняет *статистическое измерение пар "пакет-член* " для оценки пропускной способности исходной связи между клиентом и сервером.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-181">When a client connects to the media server, as part of the connection setup, the network source performs *static packet-pair* measurement to estimate the initial link bandwidth between client and server.</span></span> <span data-ttu-id="9e9f3-182">В зависимости от результата этого измерения Клиент может выбрать потоки аудио и видео, которые помещаются в пределах предполагаемой пропускной способности.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-182">Based on the result of this measurement, the client can select audio and video streams that fit within the estimated bandwidth.</span></span> <span data-ttu-id="9e9f3-183">Это обеспечивает плавное воспроизведение содержимого потоковой передачи мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-183">This ensures smooth playback of the streaming media content.</span></span>

<span data-ttu-id="9e9f3-184">На этапе быстрого запуска выполняется *динамическое измерение пары пакетов* .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-184">During the Fast Startup stage, *dynamic packet-pair* measurement is performed.</span></span> <span data-ttu-id="9e9f3-185">В этом процессе клиент получает большие объемы данных, которые могут быть несколькими пакетами или выборками.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-185">In this process, the client receives large amounts of data, which can be multiple packets or samples.</span></span>

<span data-ttu-id="9e9f3-186">Результат измерения с динамическим связыванием пакетов более точен, чем оценка пропускной способности канала, возвращенная статическим измерением пары пакетов, поскольку процесс статического связывания пакетов отправляет один пакет фиксированного размера, что может привести к неточным результатам для сетей с высокой пропускной способностью.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-186">The result of dynamic packet-pair measurement is more accurate than the link bandwidth estimate returned by static packet-pair measurement because the static packet-pair process sends a single packet of fixed size, which may not yield accurate results for high bandwidth networks.</span></span>

<span data-ttu-id="9e9f3-187">Приложение может получить предполагаемую пропускную способность с помощью свойства [**мфнетсаурце \_ ппбандвидс**](mfnetsource-ppbandwidth-property.md) .</span><span class="sxs-lookup"><span data-stu-id="9e9f3-187">The application can get the estimated bandwidth by using the [**MFNETSOURCE\_PPBANDWIDTH**](mfnetsource-ppbandwidth-property.md) property.</span></span>

<span data-ttu-id="9e9f3-188">Условия сети могут динамически изменяться, что вызывает сбои при воспроизведении сетевого источника.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-188">Network conditions may change dynamically, causing glitches in playback of the network source.</span></span> <span data-ttu-id="9e9f3-189">Источник сети может изменить исходный выбор клиента в зависимости от скорости приема и состояния буфера.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-189">The network source can change the client's initial stream selection based on the receiving rate and the buffer state.</span></span> <span data-ttu-id="9e9f3-190">Например, клиент может переключиться на более низкую скорость во время перегрузки сети и переключиться на более высокую скорость, когда сетевой трафик увеличился и клиент накапливает достаточное количество буферизованного содержимого.</span><span class="sxs-lookup"><span data-stu-id="9e9f3-190">For example, the client might switch to a lower bit rate during network congestion and switch back to a higher bit rate when network traffic has improved and the client has accumulated a sufficient amount of buffered content.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9e9f3-191">См. также</span><span class="sxs-lookup"><span data-stu-id="9e9f3-191">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9e9f3-192">Сетевые подключения в Media Foundation</span><span class="sxs-lookup"><span data-stu-id="9e9f3-192">Networking in Media Foundation</span></span>](networking-in-media-foundation.md)
</dt> </dl>

 

 



